<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>TheArcher</title>
		<link rel="icon" type="image/x-icon" href="/img/favicon.png">
		<style>
			/* General style settings of the page */	
			body { 
				margin: 0;
				background: #000;
				font-family: Helvetica, sans-serif; 
			}
			/* Style of the start menu buttons */
			.btn {
				background: rgba(0,127,128,0.68);
				-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
				box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
				border: 1px solid rgba(128,255,255,0.25);
				color: rgba(255,255,255,1);
				text-shadow: 0 0 10px rgba(0,255,255,0.95);
				font-size: 30px;
				padding: 10px 30px;
				-webkit-user-select: none;
				-moz-user-select: none;
				-ms-user-select: none;
				user-select: none;
				outline: none;
			}
			/* Style of the start menu buttons going over with pointer */	
			.btn:hover {
				-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
				box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
				border: 1px solid rgba(128,255,255,0.75);
			}
		</style>
	</head>
	<body>
        <!-- Remove this when import maps will be widely supported -->
		<script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>


        <!-- Needed to make the import "three" work-->
		<script type="importmap">
			{
				"imports": {
					"three": "./node_modules/three/build/three.module.js"
				}
			}
		</script>


		<!-- Initial loading bar -->
		<div id="gameLoading_bg" style="position:fixed; width : 100%; height : 100%; background-color: rgba(0,0,0,0.7);">
			<div id="gameLoading_fg" style="width: 70%; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); height: auto; text-align: center; cursor: pointer; padding: 2%;">
				<label id="gameLoading_label" style=" font-size: 3em; color:white; border-collapse: collapse;" for="gameLoading_fb_bar">Loading in progress:</label><br>
				<progress  id="gameLoading_fg_bar" style="width: 100%; height: 3em;" max="100" ></progress>
			</div>
		</div>
		
		<!-- Prompt used to show interaction result text -->
		<div id="showText_prompt" style=" width: 70%; position: fixed; top: 50%; left: 50%; transform: translate(-40%, -50%); height: auto; text-align: center; cursor: pointer; padding: 20pt; display:none;">
			<div class="btn" style=" display:block; width: 70%; height: auto; text-align: center; ">
				<div id="close_showText_prompt_btn" style="display:inline-block; margin-left: 96%; color: white; font-weight: bold; cursor: pointer;">
					x
				</div>
				<span style="display:inline-block;width:100%;overflow: auto;">
					<span id="showText_prompt_txt" style=" vertical-align:middle; font-size: 50px;"> </span>
					<div style=" display:inline-block; width:100%; overflow: auto;"><span style="vertical-align: middle;">[Press </span><img style="-webkit-filter: invert(1); filter: invert(1); vertical-align:middle" src="img/e-key.png" width="50px"><span style="vertical-align: middle;"> to close the prompt]</span></div>
				</span>
			</div>
		</div>

		<!-- Prompt used to show "Press E for interaction" when near the interaction object -->
		<div id="interaction_prompt" class="btn" style=" width: 70%; position: fixed; top: 90%; left: 50%; transform: translate(-50%, -50%); height: auto; text-align: center; cursor: pointer; padding: 20pt; display:none;">
			<span style="vertical-align: middle;">PRESS </span><img style="-webkit-filter: invert(1); filter: invert(1); vertical-align:middle" src="img/e-key.png" width="50px"><span style="vertical-align: middle;"> TO INTERACT</span>
		</div>

		<!-- Game over prompt -->
		<div id="gameover_prompt" class="btn" style=" width: 70%; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); height: auto; text-align: center; padding: 20pt; display:none;">
			<span style="font-size: 100px; vertical-align: middle;"><b>GAME OVER</b> </span><img style="-webkit-filter: invert(1); filter: invert(1); vertical-align:middle" src="img/game-over.png" width="60px">
			<div style="font-size: 20px; vertical-align: middle;">(Page should refresh automatically, if it doesn't please do it manually)</div>
		</div>


		<!-- Pause Menu -->
		<!-- Pause Menu background -->
		<div id="pause_bg" style = "position:fixed; width : 100%; height : 100%; background-color: rgba(0,0,0,0.7); display:none;" >

			<!-- Main logo of the game -->
			<div style = "width: 100%; position: fixed; top: 19%; left: 50%; transform: translate(-280pt, -50%);">
				<span >
					<img src="img/logo.png" width="800pt" >
				</span>
			</div>

			<!-- Pause foreground to show the effective content -->
			<button id="pause_fg" class="btn" style=" width: 70%; position: fixed; top: 60%; left: 50%; transform: translate(-50%, -50%); height: auto; text-align: center; cursor: pointer; padding: 20pt; display:none;">
				<p style="margin:10pt; font-size: 50px; vertical-align: top;">
					<b>PAUSE</b>
				</p>
				<hr/>
				<p style="font-size:100px;">
					<b>CLICK TO RESUME</b>
				</p>

				<!-- Commands table -->
				<span style="text-align: center;">
				<table style="border: 2px solid white; border-collapse: collapse; margin-left:auto; margin-right:auto; -webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
				box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
				border: 1px solid rgba(128,255,255,0.25);">
					<tr>
						<th style="padding: 15pt;border: 2px solid white; border-collapse: collapse;">
							<span>
								<span style="vertical-align:middle">Move: </span>
								<img style="vertical-align:middle" src="img/wasd.png" width="60pt">
							</span>
						</th>
						<th style="padding-left: 10pt; padding-right: 20pt;;border: 2px solid white; border-collapse: collapse;">
							<span>
								<span style="vertical-align:middle">Jump: </span>
								<img style="vertical-align:middle" src="img/space-bar.png" width="60pt">
							</span>
						</th>
						<th style="padding-left: 10pt; padding-right: 20pt;;border: 2px solid white; border-collapse: collapse;">
							<span>
								<span style="vertical-align:middle">Look: </span>
								<img style="vertical-align:middle" src="img/mouse.png" width="60pt">
							</span>
						</th>
						<th style="padding-left: 10pt; padding-right: 20pt;border: 2px solid white; border-collapse: collapse;">
							<span>
								<span style="vertical-align:middle">Shoot an arrow: </span>
								<img style="vertical-align:middle" src="img/f-key.png" width="60pt">
							</span>
						</th>
						<th style="padding-left: 10pt; padding-right: 20pt;border: 2px solid white; border-collapse: collapse;">
							<span>
								<span style="vertical-align:middle">Run: </span>
								<img style="vertical-align:middle" src="img/shift-key.png" width="60pt">
							</span>
						</th>
				</tr>
				</table>
				</span>
			</button>

			 <!-- Home button -->
			<div style = "width: 100%; position: fixed; top: 94%; left: 10%;  ">
				<button id="home_btn" class="btn" style="width: 20%; height: auto; text-align: center; cursor: pointer;  padding: 20pt; transform: translate(-50%, -50%);">
					<span>
						<img style="-webkit-filter: invert(1); filter: invert(1); vertical-align:middle" src="img/home.png" width="50px">
						<span style="vertical-align:middle; font-size: 50px;"><b>HOME</b></span>
					</span>
				</button>
			</div>
		</div>


		<script type="module">
        import * as THREE from './node_modules/three/build/three.module.js';
        import { OrbitControls } from './node_modules/three/examples/jsm/controls/ModifiedOrbitControls.js';
		import * as CANNON from './node_modules/cannon-es/dist/cannon-es.js';
		import {GLTFLoader} from './node_modules/three/examples/jsm/loaders/GLTFLoader.js';
		import { TWEEN } from './node_modules/three/examples/jsm/libs/tween.module.min.js'
		import { Sky } from './node_modules/three/examples/jsm/objects/Sky.js';

		var gameLoaded = false;
		var gameUnlocked = true;
		var relDir=0;
		var playerState = "Idle";
		var cameraTarget = new THREE.Vector3();
		var mixer, mixer2;
		var archerModel, archerModelParent;
		var arrowModel, targetModel, targetModel1, targetModel2,targetModel3, targetModel4, targetModel5; 
		var robotHoloModel;
		var targetModelParent1, targetModelParent2, targetModelParent3, targetModelParent4, targetModelParent5; 
		var archerStructure = {};
		var canShoot=true;
		var lastExecutedAnimation = "Idle";
		var idle, idleB, runA, runB, runC, runD, jumpA, jumpB, walkA, walkB, walkC, walkD, shootPre, shootA, shootB, shootC, targetMovement1, targetMovement2, targetMovement3, targetMovement4, level2Unlock, level3Unlock1, level3Unlock2, level3Unlock3, level3Unlock4, level3Unlock5, level3Unlock6;
		var backObsPlat1, fwdObsPlat1, backObsPlat2, fwdObsPlat2, backObsPlat3, fwdObsPlat3;
		var arrows =[];
		var target1hit = false, target2hit = false, target3hit=false, target4hit=false, target5hit=false; 
		var prevPlayerPosition;
		var obsPlatTweens = [];
		var obsPlat=[];
		var presPlates=[];
		var holoProjs = [];
		var robots=[];
		var robotsTweens = [];
		var oldx = 0, oldz = 0, oldy = 10;
		var cameraAngle, desQuat;
		var rotatingPlatModel;
		var rotatePlatFloatingTweens =[];
		var skyboxModel, mainPlatModel, groundPlatModelParent, level2PlatformModelParent, level3PlatformModelParent, level5PlatformModelParent, level6PlatformModelParent;
		var pause_bg = document.getElementById("pause_bg");
		var pause_fg = document.getElementById("pause_fg");
		var interactionPrompt = document.getElementById("interaction_prompt");
		var justRepulsedArcher = false;
		var arrowAnimation, archerRightHand;
		var bombs = [];
		var bombModel;
		var justShotCannon1 = false;
		var cannonBody, cannonModel, cannonModelParent, cannonMesh;
		var slModel, slModelParent;
		var holoProjModel;
		var terminalModel;
		var isNearHoloProj = false;
		var nearHoloProj = null;
		var isNearTerminal = false;
		var nearTerminal = null;
		var robotHoloAppearTween, robotHoloDisappearTween;
		var terminals = [];
		var presPlateModel;
		var cubeWeightModel, cubeWeightBody, cubeWeightMesh, cubeWeightModelParent;
		var cubeWeightPhysMat = new CANNON.Material();
		var animationsTry;
		var activatePresPlate0Tween;
		var deactivatePresPlate0Tween;
		var endModel;
		var lastUnlockTime = null;
		var currentObsPlat = 24;
		var canFallPlatform = true;
		var pressed = {"SHIFT" : false, "W" : false, "A" : false, "S" : false, "D" : false, "F" : false};

		//Considering the parameters sent by the menu through the URL
		var getParameterShadows = findGetParameter("shadows");
		if(getParameterShadows == null || !(["1", "2", "3"].includes(getParameterShadows)))
			getParameterShadows=3;
		var getParameterSoundEf = findGetParameter("soundef");
		if(getParameterSoundEf == null || !["0", "1"].includes(getParameterSoundEf))
			getParameterSoundEf=1;
		var getParameterSoundMu = findGetParameter("soundmu");
		if(getParameterSoundMu == null || !["0", "1"].includes(getParameterSoundMu))
			getParameterSoundMu=1;
		var getParameterWireframes = findGetParameter("wireframes");
		if(getParameterWireframes == null || !["1","0"].includes(getParameterWireframes))
			getParameterWireframes=0;
		var getParameterClouds = findGetParameter("clouds");
		if(getParameterClouds == null || !["1","0"].includes(getParameterClouds))
			getParameterClouds=1;

		//Creating the world for CANNON-ES
		const world = new CANNON.World({
			gravity: new CANNON.Vec3(0, -20, 0)
		});

		//Creating the scene for THREEJS
		const scene = new THREE.Scene();

		//Importing the Sky from THREEJS examples and setting the parameters to obtain the desired result
		var sky = new Sky();
		sky.scale.setScalar( 450000 );
		scene.add( sky );
		var sunPosition = new THREE.Vector3();
		sky.material.uniforms[ 'turbidity' ].value =20;
		sky.material.uniforms[ 'mieCoefficient' ].value =0;
		sky.material.uniforms[ 'mieDirectionalG' ].value =1;
		sky.material.uniforms[ 'rayleigh' ].value =0.15;
		sunPosition.setFromSphericalCoords( 1, THREE.MathUtils.degToRad( 90 - 45 ), THREE.MathUtils.degToRad( 90 ) );
		sky.material.uniforms[ 'sunPosition' ].value.copy( sunPosition );

		//Configuring settings and initial position for camera (immediately overwritten to follow the player)
		const camera = new THREE.PerspectiveCamera(
			45,
			window.innerWidth / window.innerHeight,
			0.1,
			1000
		);
		camera.position.set(0,10,-20);
		camera.quaternion.setFromAxisAngle(new CANNON.Vec3(0,1,0), Math.PI);
			
		//Configuring the renderer
		const renderer = new THREE.WebGLRenderer();
		renderer.setSize( window.innerWidth, window.innerHeight );
		renderer.shadowMap.enabled = true;
		document.body.appendChild( renderer.domElement );
		renderer.toneMappingExposure = 0.5;
		
		//Importing a modified version of the Orbit controls modified by me. In this way the player is able to lock the camera and move the camera according to a classical third person game
		var orbit = new OrbitControls(camera,renderer.domElement);

		//SOUND SETUP
		const audioListener = new THREE.AudioListener();
		camera.add( audioListener );
		const audioLoader = new THREE.AudioLoader();
		
		const archerShootAudio = new THREE.PositionalAudio( audioListener );

		audioLoader.load( 'sounds/archerShoot.mp3', function( buffer ) {
			archerShootAudio.setBuffer( buffer );
			archerShootAudio.setRefDistance( 20 );
		});

		const cannonShootAudio = new THREE.PositionalAudio( audioListener );

		audioLoader.load( 'sounds/cannonShoot.mp3', function( buffer ) {
			cannonShootAudio.setBuffer( buffer );
			cannonShootAudio.setRefDistance( 20 );
		});

		const tadaAudio = new THREE.PositionalAudio( audioListener );

		audioLoader.load( 'sounds/tada.mp3', function( buffer ) {
			tadaAudio.setBuffer( buffer );
			tadaAudio.setRefDistance( 20 );
		});

		const playerWalkAudio = new THREE.PositionalAudio( audioListener );

		audioLoader.load( 'sounds/walk.wav', function( buffer ) {
			playerWalkAudio.setBuffer( buffer );
			playerWalkAudio.setRefDistance( 20 );
			playerWalkAudio.setLoop( true );
			playerWalkAudio.playbackRate = 2.1;
			playerWalkAudio.setVolume(0.1);
		});

		const playerRunAudio = new THREE.PositionalAudio( audioListener );

		audioLoader.load( 'sounds/run.wav', function( buffer ) {
			playerRunAudio.setBuffer( buffer );
			playerRunAudio.setRefDistance( 20 );
			playerRunAudio.setLoop( true );
			playerRunAudio.playbackRate = 0.8;
			playerRunAudio.setVolume(0.1);
		});

		const mainThemeAudio = new THREE.Audio( audioListener );

		audioLoader.load( 'sounds/mainTheme.mp3', function( buffer ) {
			mainThemeAudio.setBuffer( buffer );
			mainThemeAudio.setLoop( true );
			mainThemeAudio.setVolume( 0.1 );
			if(getParameterSoundMu == "1"){
				mainThemeAudio.play();
			}
		});

		const theEndAudio = new THREE.Audio( audioListener );

		audioLoader.load( 'sounds/theEnd.mp3', function( buffer ) {
			theEndAudio.setBuffer( buffer );
			theEndAudio.setVolume( 0.1 );
		});


		//These are only buffers not audios (not playable) because these buffers have to be used in multiple audios, e.g. multiple enemies emitting the same sound
		var metalImpactAudioBuffer;

		audioLoader.load( 'sounds/metalImpact.mp3', function( buffer ) {
			metalImpactAudioBuffer = buffer;
		});

		var robotBlipAudioBuffer;

		audioLoader.load( 'sounds/robotBlip.mp3', function( buffer ) {
			robotBlipAudioBuffer = buffer;
		});

		var terminalAudioBuffer;

		audioLoader.load( 'sounds/terminal.mp3', function( buffer ) {
			terminalAudioBuffer = buffer;
		});

		var presPlateAudioBuffer;

		audioLoader.load( 'sounds/pressurePlate.mp3', function( buffer ) {
			presPlateAudioBuffer = buffer;
		});


		//LIGHT SETUP

		//Configuring ambient light, otherwise the shadow of the directional light would be too dark
		const ambLight = new THREE.AmbientLight(0xFFFFFF, 0.8);
		scene.add(ambLight);

		//Configuring the directional light
		const dirLight = new THREE.DirectionalLight(0xFFFFFF, 10);
		dirLight.position.set(40, 40, 0);
		dirLight.target.position.set(-2, 0, 0);
		dirLight.castShadow = true; 
		dirLight.shadow.camera.left = - 400;
		dirLight.shadow.camera.right = 15;
		dirLight.shadow.camera.top = 15;
		dirLight.shadow.camera.bottom = - 40;
		dirLight.shadow.camera.far = 100;
		dirLight.shadow.bias = - 0;
		//The shadow quality must be based on the menu settings (too give the possibility of improving shadow qualities)
		var shadowQuality = parseInt(getParameterShadows);
		dirLight.shadow.mapSize.width = Math.pow(2,4 * shadowQuality + 1);
		dirLight.shadow.mapSize.height = Math.pow(2,4 * shadowQuality + 1);
		scene.add(dirLight);
		scene.add(dirLight.target);

		//Tool useful to show the area of the directional light (activated only if the "wireframes" flag is set on 1)
		const helper = new THREE.CameraHelper( dirLight.shadow.camera );
		if(getParameterWireframes == "1")
			scene.add( helper )
			
		//Creating the THREEJS mesh of the archer (called cube because it's wireframed as a cube)
		const cubeGeometry = new THREE.BoxGeometry( 1.4, 3.0, 2.0 );
		const cubeMaterial = new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} );
		const cubeMesh = new THREE.Mesh( cubeGeometry, cubeMaterial );
		cubeMesh.add( archerShootAudio );
		cubeMesh.add( tadaAudio );
		cubeMesh.add( playerWalkAudio );
		cubeMesh.add( playerRunAudio );
		if(getParameterWireframes == "1")
			scene.add( cubeMesh );
		cubeMesh.castShadow=true;

		//Configuring the GLTFLoader and the loading bar
		const loadingManager = new THREE.LoadingManager();
		const gltfLoader = new GLTFLoader(loadingManager);
		loadingManager.onLoad = () => {gameLoaded = true; createArrowAnimation(); document.querySelector('#gameLoading_fg').style.display = 'none'; document.querySelector('#gameLoading_bg').style.display = 'none'; pause_fg.style.display = ''; pause_bg.style.display = '';};
		loadingManager.onProgress = (url, itemsLoaded, itemsTotal) => {
			document.querySelector('#gameLoading_fg_bar').setAttribute("value",`${itemsLoaded / itemsTotal * 100 | 0}`);
		};

		//Creating the THREEJS mesh of the ground (the first big platform)
		const groundGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const groundMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
		});
		const groundMesh = new THREE.Mesh(groundGeo, groundMat);
		if(getParameterWireframes == "1")
			scene.add(groundMesh);
		groundMesh.receiveShadow=true;
		groundMesh.castshadow=true;
		
		//Creating the CANNON ES body of the ground
		const groundPhysMat = new CANNON.Material();

		const groundBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: groundPhysMat
		});
		world.addBody(groundBody);
		groundBody.quaternion.setFromEuler(0, Math.PI/6, 0);
		

		//LOADING GLTF MODELS
		//All of these models are loaded without considering the animations provided with them. It is forbidden to import animations for the purpose of this project.
		//GENERAL COMMENT: For each model imported it has been created a THREEJS wireframe (mesh) visible only if the option "wireframes" is flagged. It also has been created a body for the CANNON-ES library that has to manage the physics of the objects. In most cases, the components of the hierarchical models have been animated using the library TWEENJS, that provides interpolation functions for keyframe animations.

		//Loading the model of the cube used to activate the pressure plates.
		gltfLoader.load("gltf/cubeWeight/scene.gltf", (gltf) => {
			cubeWeightModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			cubeWeightModel.scale.setScalar( 2 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			cubeWeightBody = new CANNON.Body({
				mass: 1,
				shape: new CANNON.Box(new CANNON.Vec3(1.05, 1.05, 1.05 )),  
				position: new CANNON.Vec3(0, 9, 370),
				linearDamping: 0.1,
				angularDamping: 0.1,
				material: cubeWeightPhysMat
			});
			
			cubeWeightMesh = new THREE.Mesh( new THREE.BoxGeometry( 2.1 , 2.1, 2.1), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ));
			
			cubeWeightModel = cubeWeightModel.clone();
			
			cubeWeightModelParent = new THREE.Object3D();
			cubeWeightModel.getWorldPosition(cubeWeightModelParent.position);
			cubeWeightModel.position.set(0 , -cubeWeightMesh.geometry.parameters.height/2, 0);
			cubeWeightModelParent.add(cubeWeightModel);
			if(getParameterWireframes == "1")
				scene.add( cubeWeightMesh );
			scene.add( cubeWeightModelParent );
			
			world.addBody(cubeWeightBody);

			animationsTry = gltf.animations;
		});

		//Loading the model of the arrows shot by the archer (this model will be cloned for every arrow that the archer will shoot)
		gltfLoader.load("gltf/arrow/scene.gltf", (gltf) => {
			arrowModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			arrowModel.scale.setScalar( 0.02 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );
		});	

		//Loading the model of the robot shown as an hologram
		gltfLoader.load("gltf/robot_holo/scene.gltf", (gltf) => {
			robotHoloModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			robotHoloModel.scale.setScalar( 2 );
			gltf.scene.getObjectByName("ground").visible=false;
			gltf.scene.getObjectByName("group36").visible=false;
			
			var shoulderR = gltf.scene.getObjectByName("Shoulder_R_04") ;
			var head = gltf.scene.getObjectByName("Head_M_033") ;

			var eye = gltf.scene.getObjectByName("Head_M_033") ;
			var mouthOpened = gltf.scene.getObjectByName("mouth_054") ;
			mouthOpened.scale.setScalar(0);
			var mouthClosed = gltf.scene.getObjectByName("mouthClosHappy_057") ;
			mouthClosed.scale.setScalar(1);

			gltf.scene.getObjectByName("eyeClosKawai_052").scale.setScalar(0) ;
			gltf.scene.getObjectByName("eyeLClosKawai_060").scale.setScalar(0) ;
			var eyeOpenedR = gltf.scene.getObjectByName("eye_050") ;
			var eyeOpenedL = gltf.scene.getObjectByName("eyeL_058") ;
			eyeOpenedR.scale.setScalar(0);
			eyeOpenedL.scale.setScalar(0);
			var eyeClosedR = gltf.scene.getObjectByName("eyeClosHappy_053") ;
			var eyeClosedL = gltf.scene.getObjectByName("eyeLClosHappy_061") ;
			eyeClosedR.scale.setScalar(1);
			eyeClosedL.scale.setScalar(1);


			//Here it follows the list of all the different eyes and mouths available

			// mouth_054
			// mouthClos_055 
			// mouthClosKawai_056 
			// mouthClosHappy_057 

			// eye_050 
			// eyeClos_051 
			// eyeClosKawai_052 
			// eyeClosHappy_053 

			// eyeL_058 
			// eyeLClos_059 
			// eyeLClosKawai_060 
			// eyeLClosHappy_061 

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.frustumCulled=false;
					node.material.transparent = true;
					node.material.opacity = 0;
					
			}
			} );

			//Animating with simple animations the robot hologram
			var tween = new TWEEN.Tween({shoulderRRX : shoulderR.rotation.x, headRX : head.rotation.x}).to({shoulderRRX:shoulderR.rotation.x - Math.PI/12, headRX : head.rotation.x+ Math.PI/12},800).onUpdate((object) => {
						shoulderR.rotation.x = object.shoulderRRX;
						head.rotation.x = object.headRX;
					});
			tween.repeat(Infinity);
			tween.yoyo(true);
			tween.delay(200);
			tween.start();
	
			function updateMouth(){
				if(mouthClosed.scale.x == 1){
					mouthClosed.scale.setScalar(0);
					mouthOpened.scale.setScalar(1);
				}
				else{
					mouthClosed.scale.setScalar(1);
					mouthOpened.scale.setScalar(0);
				}

				if(eyeClosedR.scale.x == 1){
					eyeClosedR.scale.setScalar(0);
					eyeClosedL.scale.setScalar(0);
					eyeOpenedR.scale.setScalar(1);
					eyeOpenedL.scale.setScalar(1);
				}
				else{
					eyeClosedR.scale.setScalar(1);
					eyeClosedL.scale.setScalar(1);
					eyeOpenedR.scale.setScalar(0);
					eyeOpenedL.scale.setScalar(0);
				}
				setTimeout(()=>{
					updateMouth();
				},2000);
			};
	
			setTimeout(()=>{
				updateMouth();
			},2000);
		});	

		//Loading the starting line model, used to indicate to the player when the platform will start to fall. For this model no CANNON-ES body has been created, because it is a secondary element, not effectively useful for the game mechanics.
		gltfLoader.load("gltf/starting_line/scene.gltf", (gltf) => {
			slModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			slModel.scale.setScalar( 90 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			var genSlModel = slModel.clone();
			slModelParent = new THREE.Object3D();
			genSlModel.rotation.set(...[0,0,0]);
			genSlModel.position.set(47.5,0.5,-17.5);
			slModelParent.add(genSlModel);
			slModelParent.position.set(0, 6.5, 185);
			scene.add(slModelParent);

			
			var slFloating = new TWEEN.Tween({y:slModelParent.position.y}).to({y:slModelParent.position.y+0.2}, 200).onUpdate((object)=>{if(slModelParent)slModelParent.position.y= object.y;});
			slFloating.repeat(Infinity).yoyo(true);
			slFloating.start();
		});


		//Loading the model used to characterize every big platform in the game. The floating platforms (the smaller ones) use another model
		gltfLoader.load("gltf/main_plat/scene.gltf", (gltf) => {
			mainPlatModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			mainPlatModel.scale.setScalar( 4.5 );

			
			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			var groundPlatModel = mainPlatModel.clone();
			groundPlatModelParent = new THREE.Object3D();
			groundPlatModel.getWorldPosition(groundPlatModelParent.position);
			groundPlatModel.rotation.set(...[0,0,0]);
			groundPlatModelParent.add(groundPlatModel);
			scene.add(groundPlatModelParent);

			var level2PlatformModel= mainPlatModel.clone();
			level2PlatformModelParent = new THREE.Object3D();
			level2PlatformModel.getWorldPosition(level2PlatformModelParent.position);
			level2PlatformModel.rotation.set(...[0,0,0]);
			level2PlatformModelParent.add(level2PlatformModel);
			scene.add(level2PlatformModelParent);

			var level3PlatformModel = mainPlatModel.clone();
			level3PlatformModelParent = new THREE.Object3D();
			level3PlatformModel.getWorldPosition(level3PlatformModelParent.position);
			level3PlatformModel.rotation.set(...[0,0,0]);
			level3PlatformModelParent.add(level3PlatformModel);
			scene.add(level3PlatformModelParent);

			var level5PlatformModel = mainPlatModel.clone();
			level5PlatformModelParent = new THREE.Object3D();
			level5PlatformModel.getWorldPosition(level5PlatformModelParent.position);
			level5PlatformModel.rotation.set(...[0,0,0]);
			level5PlatformModelParent.add(level5PlatformModel);
			scene.add(level5PlatformModelParent);

			var level6PlatformModel = mainPlatModel.clone();
			level6PlatformModelParent = new THREE.Object3D();
			level6PlatformModel.getWorldPosition(level6PlatformModelParent.position);
			level6PlatformModel.rotation.set(...[0,0,0]);
			level6PlatformModelParent.add(level6PlatformModel);
			scene.add(level6PlatformModelParent);
		});

		//Loading the skybox model that will rotate slowly simulating moving windows
		gltfLoader.load("gltf/skybox/scene.gltf", (gltf) => {
			skyboxModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			skyboxModel.scale.setScalar( 3 );
			//Removing the background of the model (it causes issues with directional light)
			var sky= gltf.scene.getObjectByName("hoth_sky");
			sky.visible=false;
			skyboxModel.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=true;
			}
			} );
			if(getParameterClouds == "1"){
				scene.add(skyboxModel);
			}
		});

		//Loading the (small) floating platforms, the most replicated element in the game.
		gltfLoader.load("gltf/floating_platform/scene.gltf", (gltf) => {
			rotatingPlatModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			rotatingPlatModel.scale.setScalar( 0.05 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );


		//(Small) Floating platforms positions
		var positions = [new CANNON.Vec3(-15, -4, 48),
						new CANNON.Vec3(15, -4, 54),
						new CANNON.Vec3(0, -1, 75),
						new CANNON.Vec3(-20, 0, 90),
						new CANNON.Vec3(20, 0, 90),
						new CANNON.Vec3(-20, 0, 95),
						new CANNON.Vec3(20, 0, 95),
						new CANNON.Vec3(-20, 0, 100),
						new CANNON.Vec3(20, 0, 100),
						new CANNON.Vec3(5, 6.5, 140),
						new CANNON.Vec3(10, 6.5, 148),
						new CANNON.Vec3(15, 6.5, 156),
						new CANNON.Vec3(10, 6.5, 164),
						new CANNON.Vec3(5, 6.5, 172),
						new CANNON.Vec3(-5, 6.5, 140),
						new CANNON.Vec3(-10, 6.5, 148),
						new CANNON.Vec3(-15, 6.5, 156),
						new CANNON.Vec3(-10, 6.5, 164),
						new CANNON.Vec3(0, 6.5, 150),
						new CANNON.Vec3(-5, 6.5, 172),
						new CANNON.Vec3(13, 6.5, 185),
						new CANNON.Vec3(-13, 6.5, 185),
						new CANNON.Vec3(0, 6.5, 180),
						new CANNON.Vec3(0, 6.5, 185),
						new CANNON.Vec3(0, 6.5, 190),
						new CANNON.Vec3(0, 6.5, 205),
						new CANNON.Vec3(5, 6.5, 215),
						new CANNON.Vec3(0, 6.5, 225),
						new CANNON.Vec3(-5, 6.5, 235),
						new CANNON.Vec3(-10, 6.5, 245),
						new CANNON.Vec3(-0, 6.5, 250),
						new CANNON.Vec3(-0, 6.5, 265),
						new CANNON.Vec3(15, 6.5, 265),
						new CANNON.Vec3(30, 6.5, 265),
						new CANNON.Vec3(30, 6.5, 250),
						new CANNON.Vec3(45, 6.5, 250),
						new CANNON.Vec3(60, 6.5, 250),
						new CANNON.Vec3(60, 6.5, 265),
						new CANNON.Vec3(60, 6.5, 280),
						new CANNON.Vec3(60, 6.5, 295),
						new CANNON.Vec3(45, 6.5, 295),
						new CANNON.Vec3(30, 6.5, 295),
						new CANNON.Vec3(15, 6.5, 295),
						new CANNON.Vec3(0, 6.5, 295),
						new CANNON.Vec3(25, -5, 320),
						new CANNON.Vec3(40, -5, 320),
						new CANNON.Vec3(55, 6.5, 320),
						new CANNON.Vec3(60, 6.5, 320),
						new CANNON.Vec3(0, -4, 345) //48
					];

		
		//Velocities used only for some floating platforms, it's useful (together with the phase) to define correct moving animations
		var obsPlatVelocities = [15, 15, 10, 0, 0, 0, 0, 0, 0];
		var obsPlatPhases = [true, false, false, true, true, true, true, true, true];
		for(var i=0; i<positions.length; i++){
			var genPlatGeo = new THREE.CylinderGeometry( 2.5, 2.5, 0.5, 8 );
			var genPlatMat = new THREE.MeshPhongMaterial({ 
				color: 0x00ff00,
				side: THREE.DoubleSide,
				wireframe: true
				});
			var genPlatMesh = new THREE.Mesh(genPlatGeo, genPlatMat);
			if(getParameterWireframes == "1")	
				scene.add(genPlatMesh);
			genPlatMesh.receiveShadow=true;
			genPlatMesh.castshadow=true;

			var genPlatModel = rotatingPlatModel.clone();
			var rotatingPlatModelParent = new THREE.Object3D();
			rotatingPlatModel.getWorldPosition(rotatingPlatModelParent.position);
			rotatingPlatModel.rotation.set(...[0,0,0]);
			rotatingPlatModelParent.add(genPlatModel);
			scene.add(rotatingPlatModelParent);

			var genPlatBody = new CANNON.Body({
				shape: new CANNON.Cylinder(2.5,2.5,0.5,8),
				type: CANNON.Body.DYNAMIC,
				material: groundPhysMat,
				position: positions[i],
				mass : 0,
				linearDamping : 0,
				angularDamping : 0
			});
			world.addBody(genPlatBody);
			genPlatBody.quaternion.setFromEuler(0, 0, 0);
			obsPlat.push({"mesh" : genPlatMesh, "body" : genPlatBody, "model": rotatingPlatModelParent, "velocityMax": obsPlatVelocities[i], "phase": obsPlatPhases[i], "animating": false});
		}

		//Managing the TWEENJS animations of the (small) floating platforms
		obsPlat.forEach(element => {
			var helix = element["model"].getObjectByName("Helix");

			var rotateHelixTween = new TWEEN.Tween({theta:0}).to({theta:2*Math.PI}, 1000).onUpdate((object)=>{if(helix)helix.rotation.z= object.theta;});
			rotateHelixTween.repeat(Infinity);
			rotateHelixTween.start();

			element["rotateHelixTween"] = rotateHelixTween;

			var rotatePlatFloating = new TWEEN.Tween({y:element["body"].position.y}).to({y:element["body"].position.y+0.2}, 200).onUpdate((object)=>{if(element["body"])element["body"].position.y= object.y;});
			rotatePlatFloating.repeat(Infinity).yoyo(true);
			rotatePlatFloating.start();

			element["rotatePlatFloating"] = rotatePlatFloating;
			rotatePlatFloatingTweens.push(rotatePlatFloating);
		});
		var helix = genPlatModel.getObjectByName("Helix");

			var rotateHelixTween = new TWEEN.Tween({theta:0}).to({theta:2*Math.PI}, 1000).onUpdate((object)=>{if(helix)helix.rotation.z= object.theta;});
			rotateHelixTween.repeat(Infinity);
			rotateHelixTween.start();
		});

		//Loading the target that the player has to shoot
		gltfLoader.load("gltf/target/scene.gltf", (gltf) => {
			targetModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			targetModel.scale.setScalar( 0.3 );

			
			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			targetModelParent1 = new THREE.Object3D();
			targetModelParent2 = new THREE.Object3D();
			targetModel1 = targetModel.clone();
			targetModel2 = targetModel.clone();
			targetModel1.getWorldPosition(targetModelParent1.position);
			targetModel1.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent1.add(targetModel1);
			scene.add(targetModelParent1);

			targetModel2.getWorldPosition(targetModelParent2.position);
			targetModel2.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent2.add(targetModel2);
			scene.add(targetModelParent2);

			targetModelParent3 = new THREE.Object3D();
			targetModelParent4 = new THREE.Object3D();
			targetModel3 = targetModel.clone();
			targetModel4 = targetModel.clone();
			targetModel3.getWorldPosition(targetModelParent3.position);
			targetModel3.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent3.add(targetModel3);
			scene.add(targetModelParent3);

			targetModel4.getWorldPosition(targetModelParent4.position);
			targetModel4.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent4.add(targetModel4);
			scene.add(targetModelParent4);

			targetModelParent5 = new THREE.Object3D();
			targetModel5 = targetModel.clone();
			targetModel5.getWorldPosition(targetModelParent5.position);
			targetModel5.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent5.add(targetModel5);
			scene.add(targetModelParent5);
		});

		//Loading the base (only the base with a cone of light on top) of the hologram projectors
		gltfLoader.load("gltf/holo_projector/scene.gltf", (gltf) => {
			holoProjModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			holoProjModel.scale.setScalar( 2 );


			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

		//Holo projectors base positions
		var positions = [new CANNON.Vec3(-0, 0.9, 9),
						new CANNON.Vec3(0, 7.4, 125.5),
						new CANNON.Vec3(0, 7.4, 310),
						new CANNON.Vec3(0, 7.4, 360)
					];

		//Texts that has to be shown when interacting with each hologram projector
		var texts = ["Hello champion! You're here to save the planet! I know you're good with the bow, so I provided you one. To start you have to shoot at the targets, in order to go to the next platform. If you encounter any enemy be sure to shoot him before he makes you fall! You'll have to jump onto floating platforms, but these ones are constantly moving up and down, so if you're not careful they could make you fall!",
		"If you arrived here it means you've already killed three of these bad boys, congratulations! From here you can see two obstacles, one immediately after the other. The first one is a cannon that will try to shoot you and make you fall down. If you manage to pass the first bad experience you will start a race against the time. When you'll cross the starting line (clearly visible) the floating platforms under your feet will start to fall. Try to not fall with them, run!",
		"Activate the first terminal (the one reachable) and run to activate the second one. You have limited time, try to be fast!",
		"Near this hologram you should find a pressure plate. If you put some weight on it, it will activate the target that you've to shoot. You can't simply stand up on it, otherwise who would shoot the target? To move the cube simply walk directly to it, crashing it (come on it's not so heavy). Try using the terminal if you loose the metal cube for whatever reason."];
		
		for(var i=0; i<positions.length; i++){
			var holoProjGeo = new THREE.CylinderGeometry( 1, 1, 0.9, 8 );
			var holoProjMat = new THREE.MeshPhongMaterial({ 
				color: 0x00ff00,
				side: THREE.DoubleSide,
				wireframe: true
				});
			var genHoloProjMesh = new THREE.Mesh(holoProjGeo, holoProjMat);
			if(getParameterWireframes == "1")	
			scene.add(genHoloProjMesh);
			genHoloProjMesh.receiveShadow=true;
			genHoloProjMesh.castshadow=true;

			const genRobotBlipAudio= new THREE.PositionalAudio( audioListener );
			genRobotBlipAudio.setBuffer(robotBlipAudioBuffer);
			genRobotBlipAudio.setRefDistance( 20 );
			genHoloProjMesh.add(genRobotBlipAudio);
			
			var genHoloProjModel = holoProjModel.clone();
			var holoProjModelParent = new THREE.Object3D();
			genHoloProjModel.getWorldPosition(holoProjModelParent.position);
			genHoloProjModel.rotation.set(...[0,0,0]);
			genHoloProjModel.position.set(...[0,-genHoloProjMesh.geometry.parameters.height/2,0]);
			holoProjModelParent.add(genHoloProjModel);
			scene.add(holoProjModelParent);
			holoProjModelParent.position.set(positions[i].x, positions[i].y, positions[i].z);
						
			var holoProjBody = new CANNON.Body({
				shape: new CANNON.Cylinder(1,1,0.9,8),
				type: CANNON.Body.STATIC,
				material: groundPhysMat,
				position: positions[i]
			});
			world.addBody(holoProjBody);
			genHoloProjMesh.position.set(positions[i].x, positions[i].y, positions[i].z);
			holoProjBody.quaternion.setFromEuler(0, 0, 0);
			holoProjs.push({"mesh" : genHoloProjMesh, "body" : holoProjBody, "model": holoProjModelParent, "text": texts[i], "robotBlipAudio" : genRobotBlipAudio});
		}
	});

	//Loading the model for the terminal with which the player can interact to trigger events and animations
	gltfLoader.load("gltf/terminal/scene.gltf", (gltf) => {
			terminalModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			terminalModel.scale.setScalar( 2 );


			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

		//Terminals positions
		var positions = [new CANNON.Vec3(-15, 9.5, 320),
						new CANNON.Vec3(60, 9, 320),
						new CANNON.Vec3(-15, 9, 370),
					];
		
		for(var i=0; i<positions.length; i++){
			var terminalGeo = new THREE.CylinderGeometry(1.1,1.1, 5, 8 );
			var terminalMat = new THREE.MeshPhongMaterial({ 
				color: 0x00ff00,
				side: THREE.DoubleSide,
				wireframe: true
				});
			var genTerminalMesh = new THREE.Mesh(terminalGeo, terminalMat);
			if(getParameterWireframes == "1")	
			scene.add(genTerminalMesh);
			genTerminalMesh.receiveShadow=true;
			genTerminalMesh.castshadow=true;

			const genTerminalAudio= new THREE.PositionalAudio( audioListener );
			genTerminalAudio.setBuffer(terminalAudioBuffer);
			genTerminalAudio.setRefDistance( 20 );
			genTerminalMesh.add(genTerminalAudio);
			
			var genTerminalModel = terminalModel.clone();
			var terminalModelParent = new THREE.Object3D();
			genTerminalModel.getWorldPosition(terminalModelParent.position);
			genTerminalModel.rotation.set(...[0,0,0]);
			genTerminalModel.position.set(...[0,-genTerminalMesh.geometry.parameters.height/2,0]);
			terminalModelParent.add(genTerminalModel);
			scene.add(terminalModelParent);
			terminalModelParent.position.set(positions[i].x, positions[i].y, positions[i].z);
						
			var terminalBody = new CANNON.Body({
				shape: new CANNON.Cylinder(1.1,1.1,5,8),
				type: CANNON.Body.STATIC,
				material: groundPhysMat,
				position: positions[i]
			});
			world.addBody(terminalBody);
			genTerminalMesh.position.set(positions[i].x, positions[i].y, positions[i].z);
			terminalBody.quaternion.setFromEuler(0, 0, 0);
			terminals.push({"mesh" : genTerminalMesh, "body" : terminalBody, "model": terminalModelParent, "terminalAudio" : genTerminalAudio, "triggered" : false});
		}
		


		//Here defining the functions to be triggered for each terminal activated
		function triggerTerminal0(){
			terminals[0]["triggered"] = true;
			obsPlat[44]["rotatePlatFloating"].stop();
			obsPlat[45]["rotatePlatFloating"].stop();
			new TWEEN.Tween({y:-4}).to({y:6.5}, 1000).onUpdate((object)=>{obsPlat[44]["body"].position.y = object.y; obsPlat[45]["body"].position.y = object.y;}).start();
			setTimeout(function() {
				new TWEEN.Tween({y:6.5}).to({y:-4}, 1000).onUpdate((object)=>{if(terminals[1]["triggered"] == false){ obsPlat[44]["body"].position.y = object.y; obsPlat[45]["body"].position.y = object.y;}}).onComplete(()=>{if(terminals[1]["triggered"]==false)terminals[0]["triggered"] = false;}).start();
		},8000);
		}

		function triggerTerminal1(){
			terminals[1]["triggered"] = true;
			terminals[0]["triggered"] = true;
			obsPlat[48]["rotatePlatFloating"].stop();
			new TWEEN.Tween({y:obsPlat[44]["body"].position.y, yu: obsPlat[48]["body"].position.y}).to({y:6.5, yu:6.5}, 1000).onUpdate((object)=>{ obsPlat[44]["body"].position.y = object.y; obsPlat[45]["body"].position.y = object.y; obsPlat[48]["body"].position.y = object.yu;}).start();
		}

		function triggerTerminal2(){
			terminals[2]["triggered"] = true;
			setTimeout(()=>{terminals[2]["triggered"] = false;}, 3000);
			cubeWeightBody.position.set(0, 10, 370);
		}

		terminals[0]["trigger"] =triggerTerminal0;
		terminals[1]["trigger"] =triggerTerminal1;
		terminals[2]["trigger"] =triggerTerminal2;


		//The second terminal has to be rotated due to the location in which it has been positioned
		terminals[1]["body"].quaternion.setFromAxisAngle(new CANNON.Vec3(0,1,0), Math.PI);
		terminals[1]["mesh"].rotation.y = Math.PI ;
		terminals[1]["model"].rotation.y = Math.PI ;
	});

	//Loading the pressure plates used to trigger events and scenarios
	gltfLoader.load("gltf/pressure_plate/scene.gltf", (gltf) => {
			presPlateModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			presPlateModel.scale.setScalar( 0.01 );


			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

		//Pressure plates positions
		var positions = [new CANNON.Vec3(10, 7.0, 370)];
		
		for(var i=0; i<positions.length; i++){
			var presPlateGeo = new THREE.BoxGeometry(2,0.15,2 );
			var presPlateMat = new THREE.MeshPhongMaterial({ 
				color: 0x00ff00,
				side: THREE.DoubleSide,
				wireframe: true
				});
			var genPresPlateMesh = new THREE.Mesh(presPlateGeo, presPlateMat);
			if(getParameterWireframes == "1")	
			scene.add(genPresPlateMesh);
			genPresPlateMesh.receiveShadow=true;
			genPresPlateMesh.castshadow=true;

			const genPresPlateAudio= new THREE.PositionalAudio( audioListener );
			genPresPlateAudio.setBuffer(presPlateAudioBuffer);
			genPresPlateAudio.setRefDistance( 20 );
			genPresPlateMesh.add(genPresPlateAudio);
			
			var genPresPlateModel = presPlateModel.clone();
			var presPlateModelParent = new THREE.Object3D();
			genPresPlateModel.getWorldPosition(presPlateModelParent.position);
			genPresPlateModel.rotation.set(...[0,0,0]);
			genPresPlateModel.position.set(...[0,-genPresPlateMesh.geometry.parameters.height/2,0]);
			presPlateModelParent.add(genPresPlateModel);
			scene.add(presPlateModelParent);
			presPlateModelParent.position.set(positions[i].x, positions[i].y, positions[i].z);
						
			var presPlateBody = new CANNON.Body({
				shape: new CANNON.Box(new CANNON.Vec3(1, 0.075, 1)),
				type: CANNON.Body.STATIC,
				material: groundPhysMat,
				position: positions[i]
			});
			world.addBody(presPlateBody);
			genPresPlateMesh.position.set(positions[i].x, positions[i].y, positions[i].z);
			presPlateBody.quaternion.setFromEuler(0, 0, 0);
			presPlates.push({"mesh" : genPresPlateMesh, "body" : presPlateBody, "model": presPlateModelParent, "presPlateAudio" : genPresPlateAudio, "triggered" : false});
		}
		


		//Here define the functions to be triggered for each pressure plate activated
		function activatePresPlate0(){
			presPlates[0]["triggered"] = true;
			if(activatePresPlate0Tween)
				activatePresPlate0Tween.stop();
			activatePresPlate0Tween = new TWEEN.Tween({"y" : targetBody5.position.y}).to({"y": 7}, (targetBody5.position.y - 7)*151).easing(TWEEN.Easing.Exponential.Out).onUpdate((object)=>{
				if(presPlates[0]["triggered"] == true)
					targetBody5.position.y = object.y;
			}).start();
		};

		//Here define the functions to be triggered for each pressure plate deactivated
		function deactivatePresPlate0(){
			presPlates[0]["triggered"] = false;
			if(deactivatePresPlate0Tween)
				deactivatePresPlate0Tween.stop();
			deactivatePresPlate0Tween = new TWEEN.Tween({"y" : targetBody5.position.y}).to({"y": 40}, (40-targetBody5.position.y)*151).easing(TWEEN.Easing.Exponential.Out).onUpdate((object)=>{
				if(presPlates[0]["triggered"] == false)
					targetBody5.position.y = object.y;
			}).start();
		};

		presPlates[0]["activation"] = activatePresPlate0;
		presPlates[0]["deactivation"] = deactivatePresPlate0;
	});

		//Loading the enemies (robots) models
		gltfLoader.load("gltf/robot/scene.gltf", (gltf) => {
			var robotModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			robotModel.scale.setScalar( 1 );
			var bone = gltf.scene.getObjectByName("Bone_74");
			var leftFoot = gltf.scene.getObjectByName("FootL_2");
			var leftLowerLeg = gltf.scene.getObjectByName("LowerLegL_5");
			bone.remove(leftFoot)
			leftLowerLeg.add(leftFoot);
			var rightFoot = gltf.scene.getObjectByName("FootR_71");
			var rightLowerLeg = gltf.scene.getObjectByName("LowerLegR_10");
			bone.remove(rightFoot)
			rightLowerLeg.add(rightFoot);
			leftFoot.position.set(-0.000, 0.008, 0.000);
			leftFoot.rotation.set(...[leftFoot.rotation.x - Math.PI,leftFoot.rotation.y,leftFoot.rotation.z]);
			rightFoot.position.set(0.000, 0.008, 0.000);
			rightFoot.rotation.set(...[rightFoot.rotation.x - Math.PI,rightFoot.rotation.y,rightFoot.rotation.z]);


			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			//Robots spawn positions
			var positions = [new CANNON.Vec3(5, 8.7, 117.5),
						new CANNON.Vec3(-5, 8.7, 117.5),
						new CANNON.Vec3(0, 8.7, 122.5),
						new CANNON.Vec3(0, 8.7, 190),
						new CANNON.Vec3(0, 8.7, 330),
										];


			//Function that checks if an arrow with that id exists and it's able to kill
			function checkArrowKiller(id){
				var ret=false;
				arrows.forEach(element => {
					if(element["killer"] && element["can"].id==id){
						ret = true;
					}
				});
				return ret;
			}
			

			//Function that returns the listener for the collision event of the robots (can't create the listener directly in the loop because foreach doesn't behave well with asynchronous functions, e.g. addEventListener)
			function robotColliderEvent(genRobot){
				return (e) => {
					//When the robot collides with an arrow which is able to kill (it hasn't touched the ground yet), then the robot is repulsed in the opposite direction of impact
					if (genRobot["body"] && ((e.contact.bi.id == genRobot["body"].id && checkArrowKiller(e.contact.bj.id)) || (e.contact.bj.id == genRobot["body"].id && checkArrowKiller(e.contact.bi.id)))) {
						var arrowRepulseVelocity = 40;
						var impactDir = new THREE.Vector3();
						//For simplicity I consider the position of the player to calculate the direction of the impact (should be near the arrow impact direction)
						impactDir.subVectors(genRobot["body"].position, cubeBody.position);
						impactDir.normalize();
						genRobot["body"].velocity.x = arrowRepulseVelocity * impactDir.x;
						genRobot["body"].velocity.z = arrowRepulseVelocity * impactDir.z;
						genRobot["active"] = false;
						if(getParameterSoundEf == "1")
							genRobot["metalImpactAudio"].play();
						setTimeout(function() {
							genRobot["active"]=true;
						},1000);
					}
					//When the robot collides with the archer, so the archer is repulsed in the opposite direction of impact
					else if((justRepulsedArcher == false && genRobot["body"] && cubeBody) && ((e.contact.bi.id == genRobot["body"].id && e.contact.bj.id == cubeBody.id || (e.contact.bj.id == genRobot["body"].id && e.contact.bi.id == cubeBody.id)))){
						justRepulsedArcher = true;
						//Must repulse after some time otherwise too many activations
						setTimeout(function() {
							justRepulsedArcher = false;
						},500);
						var enemyRepulseVelocity = 150;
						var impactDir = new THREE.Vector3();
						impactDir.subVectors( cubeBody.position, genRobot["body"].position);
						impactDir.normalize();
						if(getParameterSoundEf == "1")
							genRobot["metalImpactAudio"].play();
						cubeBody.velocity.x = enemyRepulseVelocity * impactDir.x;
						cubeBody.velocity.z = enemyRepulseVelocity * impactDir.z;
					}
				} 
			}


			//Tween onComplete function to make the next tween (the one in the argument) start
			function getOnCompleteHandler (tween) {
					return function () {tween.start()};
			};

			//Tween update function, can't create it directly in the loop
			function createUpdateFunction(genRobotStructure){
				return (object, elapsedTime) => {
					genRobotStructure["rootJoint"].rotation.x = object["rootJointRx"]; 
					genRobotStructure["rootJoint"].rotation.y = object["rootJointRy"]; 
					genRobotStructure["rootJoint"].rotation.z = object["rootJointRz"];
					genRobotStructure["bone"].rotation.x = object["boneRx"]; 
					genRobotStructure["bone"].rotation.y = object["boneRy"]; 
					genRobotStructure["bone"].rotation.z = object["boneRz"];
					genRobotStructure["footL"].rotation.x = object["footLRx"]; 
					genRobotStructure["footL"].rotation.y = object["footLRy"]; 
					genRobotStructure["footL"].rotation.z = object["footLRz"];
					genRobotStructure["body"].rotation.x = object["bodyRx"]; 
					genRobotStructure["body"].rotation.y = object["bodyRy"]; 
					genRobotStructure["body"].rotation.z = object["bodyRz"];
					genRobotStructure["upperLegL"].rotation.x = object["upperLegLRx"]; 
					genRobotStructure["upperLegL"].rotation.y = object["upperLegLRy"]; 
					genRobotStructure["upperLegL"].rotation.z = object["upperLegLRz"];
					genRobotStructure["lowerLegL"].rotation.x = object["lowerLegLRx"]; 
					genRobotStructure["lowerLegL"].rotation.y = object["lowerLegLRy"]; 
					genRobotStructure["lowerLegL"].rotation.z = object["lowerLegLRz"];
					genRobotStructure["upperLegR"].rotation.x = object["upperLegRRx"]; 
					genRobotStructure["upperLegR"].rotation.y = object["upperLegRRy"]; 
					genRobotStructure["upperLegR"].rotation.z = object["upperLegRRz"];
					genRobotStructure["lowerLegR"].rotation.x = object["lowerLegRRx"]; 
					genRobotStructure["lowerLegR"].rotation.y = object["lowerLegRRy"]; 
					genRobotStructure["lowerLegR"].rotation.z = object["lowerLegRRz"];
					genRobotStructure["hips"].rotation.x = object["hipsRx"]; 
					genRobotStructure["hips"].rotation.y = object["hipsRy"]; 
					genRobotStructure["hips"].rotation.z = object["hipsRz"];
					genRobotStructure["abdomen"].rotation.x = object["abdomenRx"]; 
					genRobotStructure["abdomen"].rotation.y = object["abdomenRy"]; 
					genRobotStructure["abdomen"].rotation.z = object["abdomenRz"];
					genRobotStructure["torso"].rotation.x = object["torsoRx"]; 
					genRobotStructure["torso"].rotation.y = object["torsoRy"]; 
					genRobotStructure["torso"].rotation.z = object["torsoRz"];
					genRobotStructure["neck"].rotation.x = object["neckRx"]; 
					genRobotStructure["neck"].rotation.y = object["neckRy"]; 
					genRobotStructure["neck"].rotation.z = object["neckRz"];
					genRobotStructure["head"].rotation.x = object["headRx"]; 
					genRobotStructure["head"].rotation.y = object["headRy"]; 
					genRobotStructure["head"].rotation.z = object["headRz"];
					genRobotStructure["shoulderR"].rotation.x = object["shoulderRRx"]; 
					genRobotStructure["shoulderR"].rotation.y = object["shoulderRRy"]; 
					genRobotStructure["shoulderR"].rotation.z = object["shoulderRRz"];
					genRobotStructure["upperArmR"].rotation.x = object["upperArmRRx"]; 
					genRobotStructure["upperArmR"].rotation.y = object["upperArmRRy"]; 
					genRobotStructure["upperArmR"].rotation.z = object["upperArmRRz"];
					genRobotStructure["lowerArmR"].rotation.x = object["lowerArmRRx"]; 
					genRobotStructure["lowerArmR"].rotation.y = object["lowerArmRRy"]; 
					genRobotStructure["lowerArmR"].rotation.z = object["lowerArmRRz"];
					genRobotStructure["thumbR"].rotation.x = object["thumbRRx"]; 
					genRobotStructure["thumbR"].rotation.y = object["thumbRRy"]; 
					genRobotStructure["thumbR"].rotation.z = object["thumbRRz"];
					genRobotStructure["thumb2R"].rotation.x = object["thumb2RRx"]; 
					genRobotStructure["thumb2R"].rotation.y = object["thumb2RRy"]; 
					genRobotStructure["thumb2R"].rotation.z = object["thumb2RRz"];
					genRobotStructure["palm2R"].rotation.x = object["palm2RRx"]; 
					genRobotStructure["palm2R"].rotation.y = object["palm2RRy"]; 
					genRobotStructure["palm2R"].rotation.z = object["palm2RRz"];
					genRobotStructure["middle1R"].rotation.x = object["middle1RRx"]; 
					genRobotStructure["middle1R"].rotation.y = object["middle1RRy"]; 
					genRobotStructure["middle1R"].rotation.z = object["middle1RRz"];
					genRobotStructure["middle2R"].rotation.x = object["middle2RRx"]; 
					genRobotStructure["middle2R"].rotation.y = object["middle2RRy"]; 
					genRobotStructure["middle2R"].rotation.z = object["middle2RRz"];
					genRobotStructure["palm1R"].rotation.x = object["palm1RRx"]; 
					genRobotStructure["palm1R"].rotation.y = object["palm1RRy"]; 
					genRobotStructure["palm1R"].rotation.z = object["palm1RRz"];
					genRobotStructure["indexR"].rotation.x = object["indexRRx"]; 
					genRobotStructure["indexR"].rotation.y = object["indexRRy"]; 
					genRobotStructure["indexR"].rotation.z = object["indexRRz"];
					genRobotStructure["index2R"].rotation.x = object["index2RRx"]; 
					genRobotStructure["index2R"].rotation.y = object["index2RRy"]; 
					genRobotStructure["index2R"].rotation.z = object["index2RRz"];
					genRobotStructure["palm3R"].rotation.x = object["palm3RRx"]; 
					genRobotStructure["palm3R"].rotation.y = object["palm3RRy"]; 
					genRobotStructure["palm3R"].rotation.z = object["palm3RRz"];
					genRobotStructure["ring1R"].rotation.x = object["ring1RRx"]; 
					genRobotStructure["ring1R"].rotation.y = object["ring1RRy"]; 
					genRobotStructure["ring1R"].rotation.z = object["ring1RRz"];
					genRobotStructure["ring2R"].rotation.x = object["ring2RRx"]; 
					genRobotStructure["ring2R"].rotation.y = object["ring2RRy"]; 
					genRobotStructure["ring2R"].rotation.z = object["ring2RRz"];
					genRobotStructure["shoulderL"].rotation.x = object["shoulderLRx"]; 
					genRobotStructure["shoulderL"].rotation.y = object["shoulderLRy"]; 
					genRobotStructure["shoulderL"].rotation.z = object["shoulderLRz"];
					genRobotStructure["upperArmL"].rotation.x = object["upperArmLRx"]; 
					genRobotStructure["upperArmL"].rotation.y = object["upperArmLRy"]; 
					genRobotStructure["upperArmL"].rotation.z = object["upperArmLRz"];
					genRobotStructure["lowerArmL"].rotation.x = object["lowerArmLRx"]; 
					genRobotStructure["lowerArmL"].rotation.y = object["lowerArmLRy"]; 
					genRobotStructure["lowerArmL"].rotation.z = object["lowerArmLRz"];
					genRobotStructure["palm2L"].rotation.x = object["palm2LRx"]; 
					genRobotStructure["palm2L"].rotation.y = object["palm2LRy"]; 
					genRobotStructure["palm2L"].rotation.z = object["palm2LRz"];
					genRobotStructure["middle1L"].rotation.x = object["middle1LRx"]; 
					genRobotStructure["middle1L"].rotation.y = object["middle1LRy"]; 
					genRobotStructure["middle1L"].rotation.z = object["middle1LRz"];
					genRobotStructure["middle2L"].rotation.x = object["middle2LRx"]; 
					genRobotStructure["middle2L"].rotation.y = object["middle2LRy"]; 
					genRobotStructure["middle2L"].rotation.z = object["middle2LRz"];
					genRobotStructure["thumbL"].rotation.x = object["thumbLRx"]; 
					genRobotStructure["thumbL"].rotation.y = object["thumbLRy"]; 
					genRobotStructure["thumbL"].rotation.z = object["thumbLRz"];
					genRobotStructure["thumb2L"].rotation.x = object["thumb2LRx"]; 
					genRobotStructure["thumb2L"].rotation.y = object["thumb2LRy"]; 
					genRobotStructure["thumb2L"].rotation.z = object["thumb2LRz"];
					genRobotStructure["palm1L"].rotation.x = object["palm1LRx"]; 
					genRobotStructure["palm1L"].rotation.y = object["palm1LRy"]; 
					genRobotStructure["palm1L"].rotation.z = object["palm1LRz"];
					genRobotStructure["indexL"].rotation.x = object["indexLRx"]; 
					genRobotStructure["indexL"].rotation.y = object["indexLRy"]; 
					genRobotStructure["indexL"].rotation.z = object["indexLRz"];
					genRobotStructure["index2L"].rotation.x = object["index2LRx"]; 
					genRobotStructure["index2L"].rotation.y = object["index2LRy"]; 
					genRobotStructure["index2L"].rotation.z = object["index2LRz"];
					genRobotStructure["palm3L"].rotation.x = object["palm3LRx"]; 
					genRobotStructure["palm3L"].rotation.y = object["palm3LRy"]; 
					genRobotStructure["palm3L"].rotation.z = object["palm3LRz"];
					genRobotStructure["ring1L"].rotation.x = object["ring1LRx"]; 
					genRobotStructure["ring1L"].rotation.y = object["ring1LRy"]; 
					genRobotStructure["ring1L"].rotation.z = object["ring1LRz"];
					genRobotStructure["ring2L"].rotation.x = object["ring2LRx"]; 
					genRobotStructure["ring2L"].rotation.y = object["ring2LRy"]; 
					genRobotStructure["ring2L"].rotation.z = object["ring2LRz"];
					genRobotStructure["poleTargetL"].rotation.x = object["poleTargetLRx"]; 
					genRobotStructure["poleTargetL"].rotation.y = object["poleTargetLRy"]; 
					genRobotStructure["poleTargetL"].rotation.z = object["poleTargetLRz"];
					genRobotStructure["footR"].rotation.x = object["footRRx"]; 
					genRobotStructure["footR"].rotation.y = object["footRRy"]; 
					genRobotStructure["footR"].rotation.z = object["footRRz"];
					genRobotStructure["poleTargetR"].rotation.x = object["poleTargetRRx"]; 
					genRobotStructure["poleTargetR"].rotation.y = object["poleTargetRRy"]; 
					genRobotStructure["poleTargetR"].rotation.z = object["poleTargetRRz"];
				};
			}

			for(var i=0; i<positions.length; i++){
				var genRobotGeo = new THREE.BoxGeometry( 2.5 , 4.4, 2)
				var genRobotMat = new THREE.MeshPhongMaterial({ 
					color: 0x00ff00,
					side: THREE.DoubleSide,
					wireframe: true
					});
				var genRobotMesh = new THREE.Mesh(genRobotGeo, genRobotMat);
				if(getParameterWireframes == "1")
					scene.add(genRobotMesh);
				genRobotMesh.receiveShadow=true;
				genRobotMesh.castshadow=true;

				var robotModelParent = new THREE.Object3D();
				robotModel.getWorldPosition(robotModelParent.position);
				robotModel.position.set(0, -genRobotMesh.geometry.parameters.height/2, genRobotMesh.geometry.parameters.depth/4);
				robotModel.rotation.set(...[0,Math.PI,0]);
				var genRobotModel = robotModel.clone();
				robotModelParent.add(genRobotModel);

				scene.add(robotModelParent);

				var genRobotBody = new CANNON.Body({
					mass: 180,
					shape: new CANNON.Box(new CANNON.Vec3(1.25, 2.2, 1)),
					material: cubePhysMat,
					position: positions[i],
					linearDamping: 0.5,
					angularDamping: 0.5,
					type: CANNON.Body.DYNAMIC 
				});
				world.addBody(genRobotBody);
				genRobotBody.quaternion.setFromEuler(0, 0, 0);

				//Create the structure with all the bones of the body in the model
				var genRobotStructure = populateRobotStructure(genRobotModel);
				var tweens = {};

				//Setting the initial rotations for the tweens
				var initialRotations = {
					"rootJointRx" : genRobotStructure["rootJoint"].rotation.x, 
					"rootJointRy" : genRobotStructure["rootJoint"].rotation.y, 
					"rootJointRz" :genRobotStructure["rootJoint"].rotation.z,
					"boneRx" : genRobotStructure["bone"].rotation.x, 
					"boneRy" : genRobotStructure["bone"].rotation.y, 
					"boneRz" :genRobotStructure["bone"].rotation.z,
					"footLRx" : genRobotStructure["footL"].rotation.x, 
					"footLRy" : genRobotStructure["footL"].rotation.y, 
					"footLRz" :genRobotStructure["footL"].rotation.z,
					"bodyRx" : genRobotStructure["body"].rotation.x, 
					"bodyRy" : genRobotStructure["body"].rotation.y, 
					"bodyRz" :genRobotStructure["body"].rotation.z,
					"upperLegLRx" : genRobotStructure["upperLegL"].rotation.x, 
					"upperLegLRy" : genRobotStructure["upperLegL"].rotation.y, 
					"upperLegLRz" :genRobotStructure["upperLegL"].rotation.z,
					"lowerLegLRx" : genRobotStructure["lowerLegL"].rotation.x, 
					"lowerLegLRy" : genRobotStructure["lowerLegL"].rotation.y, 
					"lowerLegLRz" :genRobotStructure["lowerLegL"].rotation.z,
					"upperLegRRx" : genRobotStructure["upperLegR"].rotation.x, 
					"upperLegRRy" : genRobotStructure["upperLegR"].rotation.y, 
					"upperLegRRz" :genRobotStructure["upperLegR"].rotation.z,
					"lowerLegRRx" : genRobotStructure["lowerLegR"].rotation.x, 
					"lowerLegRRy" : genRobotStructure["lowerLegR"].rotation.y, 
					"lowerLegRRz" :genRobotStructure["lowerLegR"].rotation.z,
					"hipsRx" : genRobotStructure["hips"].rotation.x, 
					"hipsRy" : genRobotStructure["hips"].rotation.y, 
					"hipsRz" :genRobotStructure["hips"].rotation.z,
					"abdomenRx" : genRobotStructure["abdomen"].rotation.x, 
					"abdomenRy" : genRobotStructure["abdomen"].rotation.y, 
					"abdomenRz" :genRobotStructure["abdomen"].rotation.z,
					"torsoRx" : genRobotStructure["torso"].rotation.x, 
					"torsoRy" : genRobotStructure["torso"].rotation.y, 
					"torsoRz" :genRobotStructure["torso"].rotation.z,
					"neckRx" : genRobotStructure["neck"].rotation.x, 
					"neckRy" : genRobotStructure["neck"].rotation.y, 
					"neckRz" :genRobotStructure["neck"].rotation.z,
					"headRx" : genRobotStructure["head"].rotation.x, 
					"headRy" : genRobotStructure["head"].rotation.y, 
					"headRz" :genRobotStructure["head"].rotation.z,
					"shoulderRRx" : genRobotStructure["shoulderR"].rotation.x, 
					"shoulderRRy" : genRobotStructure["shoulderR"].rotation.y, 
					"shoulderRRz" :genRobotStructure["shoulderR"].rotation.z,
					"upperArmRRx" : genRobotStructure["upperArmR"].rotation.x, 
					"upperArmRRy" : genRobotStructure["upperArmR"].rotation.y, 
					"upperArmRRz" :genRobotStructure["upperArmR"].rotation.z,
					"lowerArmRRx" : genRobotStructure["lowerArmR"].rotation.x, 
					"lowerArmRRy" : genRobotStructure["lowerArmR"].rotation.y, 
					"lowerArmRRz" :genRobotStructure["lowerArmR"].rotation.z,
					"thumbRRx" : genRobotStructure["thumbR"].rotation.x, 
					"thumbRRy" : genRobotStructure["thumbR"].rotation.y, 
					"thumbRRz" :genRobotStructure["thumbR"].rotation.z,
					"thumb2RRx" : genRobotStructure["thumb2R"].rotation.x, 
					"thumb2RRy" : genRobotStructure["thumb2R"].rotation.y, 
					"thumb2RRz" :genRobotStructure["thumb2R"].rotation.z,
					"palm2RRx" : genRobotStructure["palm2R"].rotation.x, 
					"palm2RRy" : genRobotStructure["palm2R"].rotation.y, 
					"palm2RRz" :genRobotStructure["palm2R"].rotation.z,
					"middle1RRx" : genRobotStructure["middle1R"].rotation.x, 
					"middle1RRy" : genRobotStructure["middle1R"].rotation.y, 
					"middle1RRz" :genRobotStructure["middle1R"].rotation.z,
					"middle2RRx" : genRobotStructure["middle2R"].rotation.x, 
					"middle2RRy" : genRobotStructure["middle2R"].rotation.y, 
					"middle2RRz" :genRobotStructure["middle2R"].rotation.z,
					"palm1RRx" : genRobotStructure["palm1R"].rotation.x, 
					"palm1RRy" : genRobotStructure["palm1R"].rotation.y, 
					"palm1RRz" :genRobotStructure["palm1R"].rotation.z,
					"indexRRx" : genRobotStructure["indexR"].rotation.x, 
					"indexRRy" : genRobotStructure["indexR"].rotation.y, 
					"indexRRz" :genRobotStructure["indexR"].rotation.z,
					"index2RRx" : genRobotStructure["index2R"].rotation.x, 
					"index2RRy" : genRobotStructure["index2R"].rotation.y, 
					"index2RRz" :genRobotStructure["index2R"].rotation.z,
					"palm3RRx" : genRobotStructure["palm3R"].rotation.x, 
					"palm3RRy" : genRobotStructure["palm3R"].rotation.y, 
					"palm3RRz" :genRobotStructure["palm3R"].rotation.z,
					"ring1RRx" : genRobotStructure["ring1R"].rotation.x, 
					"ring1RRy" : genRobotStructure["ring1R"].rotation.y, 
					"ring1RRz" :genRobotStructure["ring1R"].rotation.z,
					"ring2RRx" : genRobotStructure["ring2R"].rotation.x, 
					"ring2RRy" : genRobotStructure["ring2R"].rotation.y, 
					"ring2RRz" :genRobotStructure["ring2R"].rotation.z,
					"shoulderLRx" : genRobotStructure["shoulderL"].rotation.x, 
					"shoulderLRy" : genRobotStructure["shoulderL"].rotation.y, 
					"shoulderLRz" :genRobotStructure["shoulderL"].rotation.z,
					"upperArmLRx" : genRobotStructure["upperArmL"].rotation.x, 
					"upperArmLRy" : genRobotStructure["upperArmL"].rotation.y, 
					"upperArmLRz" :genRobotStructure["upperArmL"].rotation.z,
					"lowerArmLRx" : genRobotStructure["lowerArmL"].rotation.x, 
					"lowerArmLRy" : genRobotStructure["lowerArmL"].rotation.y, 
					"lowerArmLRz" :genRobotStructure["lowerArmL"].rotation.z,
					"palm2LRx" : genRobotStructure["palm2L"].rotation.x, 
					"palm2LRy" : genRobotStructure["palm2L"].rotation.y, 
					"palm2LRz" :genRobotStructure["palm2L"].rotation.z,
					"middle1LRx" : genRobotStructure["middle1L"].rotation.x, 
					"middle1LRy" : genRobotStructure["middle1L"].rotation.y, 
					"middle1LRz" :genRobotStructure["middle1L"].rotation.z,
					"middle2LRx" : genRobotStructure["middle2L"].rotation.x, 
					"middle2LRy" : genRobotStructure["middle2L"].rotation.y, 
					"middle2LRz" :genRobotStructure["middle2L"].rotation.z,
					"thumbLRx" : genRobotStructure["thumbL"].rotation.x, 
					"thumbLRy" : genRobotStructure["thumbL"].rotation.y, 
					"thumbLRz" :genRobotStructure["thumbL"].rotation.z,
					"thumb2LRx" : genRobotStructure["thumb2L"].rotation.x, 
					"thumb2LRy" : genRobotStructure["thumb2L"].rotation.y, 
					"thumb2LRz" :genRobotStructure["thumb2L"].rotation.z,
					"palm1LRx" : genRobotStructure["palm1L"].rotation.x, 
					"palm1LRy" : genRobotStructure["palm1L"].rotation.y, 
					"palm1LRz" :genRobotStructure["palm1L"].rotation.z,
					"indexLRx" : genRobotStructure["indexL"].rotation.x, 
					"indexLRy" : genRobotStructure["indexL"].rotation.y, 
					"indexLRz" :genRobotStructure["indexL"].rotation.z,
					"index2LRx" : genRobotStructure["index2L"].rotation.x, 
					"index2LRy" : genRobotStructure["index2L"].rotation.y, 
					"index2LRz" :genRobotStructure["index2L"].rotation.z,
					"palm3LRx" : genRobotStructure["palm3L"].rotation.x, 
					"palm3LRy" : genRobotStructure["palm3L"].rotation.y, 
					"palm3LRz" :genRobotStructure["palm3L"].rotation.z,
					"ring1LRx" : genRobotStructure["ring1L"].rotation.x, 
					"ring1LRy" : genRobotStructure["ring1L"].rotation.y, 
					"ring1LRz" :genRobotStructure["ring1L"].rotation.z,
					"ring2LRx" : genRobotStructure["ring2L"].rotation.x, 
					"ring2LRy" : genRobotStructure["ring2L"].rotation.y, 
					"ring2LRz" :genRobotStructure["ring2L"].rotation.z,
					"poleTargetLRx" : genRobotStructure["poleTargetL"].rotation.x, 
					"poleTargetLRy" : genRobotStructure["poleTargetL"].rotation.y, 
					"poleTargetLRz" :genRobotStructure["poleTargetL"].rotation.z,
					"footRRx" : genRobotStructure["footR"].rotation.x, 
					"footRRy" : genRobotStructure["footR"].rotation.y, 
					"footRRz" :genRobotStructure["footR"].rotation.z,
					"poleTargetRRx" : genRobotStructure["poleTargetR"].rotation.x, 
					"poleTargetRRy" : genRobotStructure["poleTargetR"].rotation.y, 
					"poleTargetRRz" :genRobotStructure["poleTargetR"].rotation.z
				};

				var updateFunction = createUpdateFunction(genRobotStructure);

				//Creating the tweens for the animations of the robot's states

				var idleAEnemy = new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090 + Math.PI /12,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090 + Math.PI /12,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799 ,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 500);

				var idleBEnemy = new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166 + 0.02,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799 ,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 1000).repeat(Infinity).yoyo(true);

				idleAEnemy.onUpdate(updateFunction);
				idleAEnemy.onComplete(getOnCompleteHandler(idleBEnemy));
				tweens["idleA"] = idleAEnemy;
				idleBEnemy.onUpdate(updateFunction);
				tweens["idleB"] = idleBEnemy;

				var runAEnemy = new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895 - Math.PI/3,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121 + Math.PI/9,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889 + Math.PI/3,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121 - Math.PI/9,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860 + 0.02,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090 + Math.PI/3,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864 + Math.PI/4,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090 - Math.PI/3,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180 - Math.PI/4,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 250);

				var runBEnemy= new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895 + Math.PI/3,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121 - Math.PI/9,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889 - Math.PI/3,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121 + Math.PI/9,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860 - 0.02,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090 - Math.PI/3,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864 + Math.PI/4,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090 + Math.PI/3,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180 - Math.PI/4,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 250);


				runAEnemy.onComplete(getOnCompleteHandler(runBEnemy));
				runBEnemy.onComplete(getOnCompleteHandler(runAEnemy));


				runAEnemy.onUpdate(updateFunction);
				runBEnemy.onUpdate(updateFunction);

				tweens["runA"] = runAEnemy;
				tweens["runB"] = runBEnemy;
				const genMetalImpactAudio= new THREE.PositionalAudio( audioListener );
				genMetalImpactAudio.setBuffer(metalImpactAudioBuffer);
				genMetalImpactAudio.setRefDistance( 20 );
				genRobotMesh.add(genMetalImpactAudio);
				var genRobot = {"mesh" : genRobotMesh, "body" : genRobotBody, "model": robotModelParent, "state": "IDLE", "tweens": tweens, "active" : true, "metalImpactAudio" : genMetalImpactAudio};
				robots.push(genRobot);

				idleAEnemy.start();

				genRobotBody.addEventListener("collide", robotColliderEvent(genRobot));
			}
		});

		//Positioning the (initially invisible) arrow useful for the shooting animation
		function createArrowAnimation(){
				arrowAnimation = arrowModel.clone();
				arrowAnimation.scale.setScalar( 1 );
				arrowAnimation.position.set(-10, -1, -10);
				arrowAnimation.rotation.set(...[0,0,0]);
			}

		//Loading the iron ball shot by the cannon
		gltfLoader.load("gltf/iron_ball/scene.gltf", (gltf) => {
			bombModel = gltf.scene.getObjectByName("Sketchfab_Scene");

			bombModel.scale.setScalar( 0.11 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
		} );

		});

		//Loading the end balloons for the ending scene (no body and so wireframe needed)
		gltfLoader.load("gltf/end/scene.gltf", (gltf) => {
			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
		} );

		//Initially this model contains all the letters, so it must be copied in some parts to obtain the "the end" sentence into another object3D
		var tLetter = gltf.scene.getObjectByName("BalloonT_20");
		var hLetter = gltf.scene.getObjectByName("BalloonH_8");
		var eLetter = gltf.scene.getObjectByName("BalloonE_5");

		var e2Letter = eLetter.clone();
		var nLetter = gltf.scene.getObjectByName("BalloonN_14");
		var dLetter = gltf.scene.getObjectByName("BalloonD_4");

		endModel = new THREE.Object3D();
		endModel.add(tLetter);
		endModel.add(hLetter);
		endModel.add(eLetter);
		endModel.add(e2Letter);
		endModel.add(nLetter);
		endModel.add(dLetter);

		endModel.scale.setScalar( 10 );
		endModel.position.set(0, -30, 450);
		endModel.rotation.y = Math.PI;

		var distBetweenLetters = 0.3;
		var startingX = -((distBetweenLetters * 6) / 2);
		tLetter.position.set(-0.9, 0, 0); 
		hLetter.position.set(-0.9 + distBetweenLetters * 1, 0, 0);
		eLetter.position.set(-0.9 + distBetweenLetters * 2, 0, 0);
		e2Letter.position.set(-0.9 + distBetweenLetters * 4, 0, 0);
		nLetter.position.set(-0.9 + distBetweenLetters * 5, 0, 0);
		dLetter.position.set(-0.9 + distBetweenLetters * 6, 0, 0);
		});

		//Loading the automated cannon model
		gltfLoader.load("gltf/cannon/scene.gltf", (gltf) => {
			cannonModel = gltf.scene.getObjectByName("Sketchfab_Scene");

			cannonModel.scale.setScalar( 0.11 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
		} );

		var genCannonModel = cannonModel.clone();

		cannonBody = new CANNON.Body({
			shape: new CANNON.Box(new CANNON.Vec3(1.5, 1.5, 1.5)),
			position: new CANNON.Vec3(0, 8.4, 164),
			type: CANNON.Body.STATIC 
		});
		world.addBody(cannonBody);

		cannonMesh = new THREE.Mesh( new THREE.BoxGeometry(3,3,3), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ));
		cannonMesh.add(cannonShootAudio);
		if(getParameterWireframes == "1")
			scene.add(cannonMesh);
		
		cannonModelParent = new THREE.Object3D();
		genCannonModel.position.set(0 , -cannonMesh.geometry.parameters.height/2, -8.8);
		genCannonModel.rotation.set(...[0,Math.PI/2,0]);
		cannonModelParent.add(genCannonModel);
		
		scene.add( cannonModelParent );
		});

		//Loading the archer model (the most complex one and the most animated one, since it's the player's model)
		gltfLoader.load("gltf/archer/scene.gltf", (gltf) => {
			archerModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			archerRightHand = gltf.scene.getObjectByName("RightHand_49");

			archerModel.scale.setScalar( 1.7 );
			//Creating a parent to move the archerModel through its center and rotate it in the correct direction
			archerModelParent = new THREE.Object3D();
			archerModel.getWorldPosition(archerModelParent.position);
			archerModel.position.set(0, -cubeMesh.geometry.parameters.height/2, 0);
			archerModel.rotation.set(...[0,Math.PI,0]);
			archerModelParent.add(archerModel);
			scene.add(archerModelParent);

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			
			
			//Set the components useful for creating animations with TweenJS
			populateArcherStructure();

			//Set the initial state of the player
			changePlayerState("Idle");
			
			
			// SOME TWEEN ANIMATIONS

			//Tween animations moving the targets
			targetMovement1 = new TWEEN.Tween({x:-10}).to({x:-2}, 4000).onUpdate((object)=>{if(targetBody1){
				targetBody1.position.x= object.x;
			}
		});
			targetMovement1.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Bounce.InOut);
			targetMovement1.start();

			targetMovement2 = new TWEEN.Tween({x:10}).to({x:2}, 4000).onUpdate((object)=>{if(targetBody2){
				targetBody2.position.x= object.x;
			}
		});
			targetMovement2.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Bounce.InOut);
			targetMovement2.start();

			targetMovement3 = new TWEEN.Tween({x:-10}).to({x:-2}, 4000).onUpdate((object)=>{if(targetBody3){
				targetBody3.position.x= object.x;
			}
		});
			targetMovement3.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Back.InOut);
			targetMovement3.start();

			targetMovement4 = new TWEEN.Tween({x:10}).to({x:2}, 4000).onUpdate((object)=>{if(targetBody4){
				targetBody4.position.x= object.x;
			}
		});
			targetMovement4.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Back.InOut);
			targetMovement4.start();
			



			//Tween animations that has to be started when unlocking the different levels, the first one (level2Unlock) simply rotate a main platform, the other one (level3Unlock*) set some floating platforms as stairs
			level2Unlock = new TWEEN.Tween({theta:Math.PI/2}).to({theta:0}, 4000).onUpdate((object)=>{		level2PlatformBody.quaternion.setFromEuler(object.theta, Math.PI/6, 0)});
			level2Unlock.easing(TWEEN.Easing.Bounce.Out);

			level3Unlock1 = new TWEEN.Tween({x:-20}).to({x:-2.5}, 4000).onUpdate((object)=>{obsPlat[3]["body"].position.x= object.x;});
			level3Unlock1.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock2 = new TWEEN.Tween({x:20}).to({x:2.5}, 4000).onUpdate((object)=>{obsPlat[4]["body"].position.x= object.x;});
			level3Unlock2.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock3 = new TWEEN.Tween({y:0, x: -20}).to({y:2, x: -2.5}, 4000).onUpdate((object)=>{obsPlat[5]["body"].position.y= object.y;obsPlat[5]["body"].position.x= object.x;});
			level3Unlock3.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock4 = new TWEEN.Tween({y:0, x: 20}).to({y:2, x: 2.5}, 4000).onUpdate((object)=>{obsPlat[6]["body"].position.y= object.y;obsPlat[6]["body"].position.x= object.x;});
			level3Unlock4.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock5 = new TWEEN.Tween({y:0, x: -20}).to({y:4, x: -2.5}, 4000).onUpdate((object)=>{obsPlat[7]["body"].position.y= object.y;obsPlat[7]["body"].position.x= object.x;});
			level3Unlock5.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock6 = new TWEEN.Tween({y:0, x: 20}).to({y:4, x: 2.5}, 4000).onUpdate((object)=>{obsPlat[8]["body"].position.y= object.y;obsPlat[8]["body"].position.x= object.x;});
			level3Unlock6.easing(TWEEN.Easing.Bounce.Out);

			//Starting rotations for archer's tweens
			var startRotations ={"hipsRx" : archerStructure["hips"].rotation.x, "hipsRy" : archerStructure["hips"].rotation.y, "hipsRz" : archerStructure["hips"].rotation.z,
								"spineRx" : archerStructure["spine"].rotation.x, "spineRy" : archerStructure["spine"].rotation.y, "spineRz" : archerStructure["spine"].rotation.z,
								"spine1Rx" : archerStructure["spine1"].rotation.x, "spine1Ry" : archerStructure["spine1"].rotation.y, "spine1Rz" : archerStructure["spine1"].rotation.z,
								"spine2Rx" : archerStructure["spine2"].rotation.x, "spine2Ry" : archerStructure["spine2"].rotation.y, "spine2Rz" : archerStructure["spine2"].rotation.z,
								"neckRx" : archerStructure["neck"].rotation.x, "neckRy" : archerStructure["neck"].rotation.y, "neckRz" : archerStructure["neck"].rotation.z,
								"headRx" : archerStructure["head"].rotation.x, "headRy" : archerStructure["head"].rotation.y, "headRz" : archerStructure["head"].rotation.z,
								"rightEyeRx" : archerStructure["rightEye"].rotation.x, "rightEyeRy" : archerStructure["rightEye"].rotation.y, "rightEyeRz" : archerStructure["rightEye"].rotation.z,
								"leftEyeRx" : archerStructure["leftEye"].rotation.x, "leftEyeRy" : archerStructure["leftEye"].rotation.y, "leftEyeRz" : archerStructure["leftEye"].rotation.z,
								"headTop_EndRx" : archerStructure["headTop_End"].rotation.x, "headTop_EndRy" : archerStructure["headTop_End"].rotation.y, "headTop_EndRz" : archerStructure["headTop_End"].rotation.z,
								"leftShoulderRx" : archerStructure["leftShoulder"].rotation.x, "leftShoulderRy" : archerStructure["leftShoulder"].rotation.y, "leftShoulderRz" : archerStructure["leftShoulder"].rotation.z,
								"leftArmRx" : archerStructure["leftArm"].rotation.x, "leftArmRy" : archerStructure["leftArm"].rotation.y, "leftArmRz" : archerStructure["leftArm"].rotation.z,
								"leftForeArmRx" : archerStructure["leftForeArm"].rotation.x, "leftForeArmRy" : archerStructure["leftForeArm"].rotation.y, "leftForeArmRz" : archerStructure["leftForeArm"].rotation.z,
								"leftHandRx" : archerStructure["leftHand"].rotation.x, "leftHandRy" : archerStructure["leftHand"].rotation.y, "leftHandRz" : archerStructure["leftHand"].rotation.z,
								"leftHandThumb1Rx" : archerStructure["leftHandThumb1"].rotation.x, "leftHandThumb1Ry" : archerStructure["leftHandThumb1"].rotation.y, "leftHandThumb1Rz" : archerStructure["leftHandThumb1"].rotation.z,
								"leftHandThumb2Rx" : archerStructure["leftHandThumb2"].rotation.x, "leftHandThumb2Ry" : archerStructure["leftHandThumb2"].rotation.y, "leftHandThumb2Rz" : archerStructure["leftHandThumb2"].rotation.z,
								"leftHandThumb3Rx" : archerStructure["leftHandThumb3"].rotation.x, "leftHandThumb3Ry" : archerStructure["leftHandThumb3"].rotation.y, "leftHandThumb3Rz" : archerStructure["leftHandThumb3"].rotation.z,
								"leftHandThumb4Rx" : archerStructure["leftHandThumb4"].rotation.x, "leftHandThumb4Ry" : archerStructure["leftHandThumb4"].rotation.y, "leftHandThumb4Rz" : archerStructure["leftHandThumb4"].rotation.z,
								"leftHandIndex1Rx" : archerStructure["leftHandIndex1"].rotation.x, "leftHandIndex1Ry" : archerStructure["leftHandIndex1"].rotation.y, "leftHandIndex1Rz" : archerStructure["leftHandIndex1"].rotation.z,
								"leftHandIndex2Rx" : archerStructure["leftHandIndex2"].rotation.x, "leftHandIndex2Ry" : archerStructure["leftHandIndex2"].rotation.y, "leftHandIndex2Rz" : archerStructure["leftHandIndex2"].rotation.z,
								"leftHandIndex3Rx" : archerStructure["leftHandIndex3"].rotation.x, "leftHandIndex3Ry" : archerStructure["leftHandIndex3"].rotation.y, "leftHandIndex3Rz" : archerStructure["leftHandIndex3"].rotation.z,
								"leftHandIndex4Rx" : archerStructure["leftHandIndex4"].rotation.x, "leftHandIndex4Ry" : archerStructure["leftHandIndex4"].rotation.y, "leftHandIndex4Rz" : archerStructure["leftHandIndex4"].rotation.z,
								"leftHandMiddle1Rx" : archerStructure["leftHandMiddle1"].rotation.x, "leftHandMiddle1Ry" : archerStructure["leftHandMiddle1"].rotation.y, "leftHandMiddle1Rz" : archerStructure["leftHandMiddle1"].rotation.z,
								"leftHandMiddle2Rx" : archerStructure["leftHandMiddle2"].rotation.x, "leftHandMiddle2Ry" : archerStructure["leftHandMiddle2"].rotation.y, "leftHandMiddle2Rz" : archerStructure["leftHandMiddle2"].rotation.z,
								"leftHandMiddle3Rx" : archerStructure["leftHandMiddle3"].rotation.x, "leftHandMiddle3Ry" : archerStructure["leftHandMiddle3"].rotation.y, "leftHandMiddle3Rz" : archerStructure["leftHandMiddle3"].rotation.z,
								"leftHandMiddle4Rx" : archerStructure["leftHandMiddle4"].rotation.x, "leftHandMiddle4Ry" : archerStructure["leftHandMiddle4"].rotation.y, "leftHandMiddle4Rz" : archerStructure["leftHandMiddle4"].rotation.z,
								"leftHandRing1Rx" : archerStructure["leftHandRing1"].rotation.x, "leftHandRing1Ry" : archerStructure["leftHandRing1"].rotation.y, "leftHandRing1Rz" : archerStructure["leftHandRing1"].rotation.z,
								"leftHandRing2Rx" : archerStructure["leftHandRing2"].rotation.x, "leftHandRing2Ry" : archerStructure["leftHandRing2"].rotation.y, "leftHandRing2Rz" : archerStructure["leftHandRing2"].rotation.z,
								"leftHandRing3Rx" : archerStructure["leftHandRing3"].rotation.x, "leftHandRing3Ry" : archerStructure["leftHandRing3"].rotation.y, "leftHandRing3Rz" : archerStructure["leftHandRing3"].rotation.z,
								"leftHandRing4Rx" : archerStructure["leftHandRing4"].rotation.x, "leftHandRing4Ry" : archerStructure["leftHandRing4"].rotation.y, "leftHandRing4Rz" : archerStructure["leftHandRing4"].rotation.z,
								"leftHandPinky1Rx" : archerStructure["leftHandPinky1"].rotation.x, "leftHandPinky1Ry" : archerStructure["leftHandPinky1"].rotation.y, "leftHandPinky1Rz" : archerStructure["leftHandPinky1"].rotation.z,
								"leftHandPinky2Rx" : archerStructure["leftHandPinky2"].rotation.x, "leftHandPinky2Ry" : archerStructure["leftHandPinky2"].rotation.y, "leftHandPinky2Rz" : archerStructure["leftHandPinky2"].rotation.z,
								"leftHandPinky3Rx" : archerStructure["leftHandPinky3"].rotation.x, "leftHandPinky3Ry" : archerStructure["leftHandPinky3"].rotation.y, "leftHandPinky3Rz" : archerStructure["leftHandPinky3"].rotation.z,
								"leftHandPinky4Rx" : archerStructure["leftHandPinky4"].rotation.x, "leftHandPinky4Ry" : archerStructure["leftHandPinky4"].rotation.y, "leftHandPinky4Rz" : archerStructure["leftHandPinky4"].rotation.z,
								"rightShoulderRx" : archerStructure["rightShoulder"].rotation.x, "rightShoulderRy" : archerStructure["rightShoulder"].rotation.y, "rightShoulderRz" : archerStructure["rightShoulder"].rotation.z,
								"rightArmRx" : archerStructure["rightArm"].rotation.x, "rightArmRy" : archerStructure["rightArm"].rotation.y, "rightArmRz" : archerStructure["rightArm"].rotation.z,
								"rightForeArmRx" : archerStructure["rightForeArm"].rotation.x, "rightForeArmRy" : archerStructure["rightForeArm"].rotation.y, "rightForeArmRz" : archerStructure["rightForeArm"].rotation.z,
								"rightHandRx" : archerStructure["rightHand"].rotation.x, "rightHandRy" : archerStructure["rightHand"].rotation.y, "rightHandRz" : archerStructure["rightHand"].rotation.z,
								"rightHandPinky1Rx" : archerStructure["rightHandPinky1"].rotation.x, "rightHandPinky1Ry" : archerStructure["rightHandPinky1"].rotation.y, "rightHandPinky1Rz" : archerStructure["rightHandPinky1"].rotation.z,
								"rightHandPinky2Rx" : archerStructure["rightHandPinky2"].rotation.x, "rightHandPinky2Ry" : archerStructure["rightHandPinky2"].rotation.y, "rightHandPinky2Rz" : archerStructure["rightHandPinky2"].rotation.z,
								"rightHandPinky3Rx" : archerStructure["rightHandPinky3"].rotation.x, "rightHandPinky3Ry" : archerStructure["rightHandPinky3"].rotation.y, "rightHandPinky3Rz" : archerStructure["rightHandPinky3"].rotation.z,
								"rightHandPinky4Rx" : archerStructure["rightHandPinky4"].rotation.x, "rightHandPinky4Ry" : archerStructure["rightHandPinky4"].rotation.y, "rightHandPinky4Rz" : archerStructure["rightHandPinky4"].rotation.z,
								"rightHandRing1Rx" : archerStructure["rightHandRing1"].rotation.x, "rightHandRing1Ry" : archerStructure["rightHandRing1"].rotation.y, "rightHandRing1Rz" : archerStructure["rightHandRing1"].rotation.z,
								"rightHandRing2Rx" : archerStructure["rightHandRing2"].rotation.x, "rightHandRing2Ry" : archerStructure["rightHandRing2"].rotation.y, "rightHandRing2Rz" : archerStructure["rightHandRing2"].rotation.z,
								"rightHandRing3Rx" : archerStructure["rightHandRing3"].rotation.x, "rightHandRing3Ry" : archerStructure["rightHandRing3"].rotation.y, "rightHandRing3Rz" : archerStructure["rightHandRing3"].rotation.z,
								"rightHandRing4Rx" : archerStructure["rightHandRing4"].rotation.x, "rightHandRing4Ry" : archerStructure["rightHandRing4"].rotation.y, "rightHandRing4Rz" : archerStructure["rightHandRing4"].rotation.z,
								"rightHandMiddle1Rx" : archerStructure["rightHandMiddle1"].rotation.x, "rightHandMiddle1Ry" : archerStructure["rightHandMiddle1"].rotation.y, "rightHandMiddle1Rz" : archerStructure["rightHandMiddle1"].rotation.z,
								"rightHandMiddle2Rx" : archerStructure["rightHandMiddle2"].rotation.x, "rightHandMiddle2Ry" : archerStructure["rightHandMiddle2"].rotation.y, "rightHandMiddle2Rz" : archerStructure["rightHandMiddle2"].rotation.z,
								"rightHandMiddle3Rx" : archerStructure["rightHandMiddle3"].rotation.x, "rightHandMiddle3Ry" : archerStructure["rightHandMiddle3"].rotation.y, "rightHandMiddle3Rz" : archerStructure["rightHandMiddle3"].rotation.z,
								"rightHandMiddle4Rx" : archerStructure["rightHandMiddle4"].rotation.x, "rightHandMiddle4Ry" : archerStructure["rightHandMiddle4"].rotation.y, "rightHandMiddle4Rz" : archerStructure["rightHandMiddle4"].rotation.z,
								"rightHandIndex1Rx" : archerStructure["rightHandIndex1"].rotation.x, "rightHandIndex1Ry" : archerStructure["rightHandIndex1"].rotation.y, "rightHandIndex1Rz" : archerStructure["rightHandIndex1"].rotation.z,
								"rightHandIndex2Rx" : archerStructure["rightHandIndex2"].rotation.x, "rightHandIndex2Ry" : archerStructure["rightHandIndex2"].rotation.y, "rightHandIndex2Rz" : archerStructure["rightHandIndex2"].rotation.z,
								"rightHandIndex3Rx" : archerStructure["rightHandIndex3"].rotation.x, "rightHandIndex3Ry" : archerStructure["rightHandIndex3"].rotation.y, "rightHandIndex3Rz" : archerStructure["rightHandIndex3"].rotation.z,
								"rightHandIndex4Rx" : archerStructure["rightHandIndex4"].rotation.x, "rightHandIndex4Ry" : archerStructure["rightHandIndex4"].rotation.y, "rightHandIndex4Rz" : archerStructure["rightHandIndex4"].rotation.z,
								"rightHandThumb1Rx" : archerStructure["rightHandThumb1"].rotation.x, "rightHandThumb1Ry" : archerStructure["rightHandThumb1"].rotation.y, "rightHandThumb1Rz" : archerStructure["rightHandThumb1"].rotation.z,
								"rightHandThumb2Rx" : archerStructure["rightHandThumb2"].rotation.x, "rightHandThumb2Ry" : archerStructure["rightHandThumb2"].rotation.y, "rightHandThumb2Rz" : archerStructure["rightHandThumb2"].rotation.z,
								"rightHandThumb3Rx" : archerStructure["rightHandThumb3"].rotation.x, "rightHandThumb3Ry" : archerStructure["rightHandThumb3"].rotation.y, "rightHandThumb3Rz" : archerStructure["rightHandThumb3"].rotation.z,
								"rightHandThumb4Rx" : archerStructure["rightHandThumb4"].rotation.x, "rightHandThumb4Ry" : archerStructure["rightHandThumb4"].rotation.y, "rightHandThumb4Rz" : archerStructure["rightHandThumb4"].rotation.z,
								"leftUpLegRx" : archerStructure["leftUpLeg"].rotation.x, "leftUpLegRy" : archerStructure["leftUpLeg"].rotation.y, "leftUpLegRz" : archerStructure["leftUpLeg"].rotation.z,
								"leftLegRx" : archerStructure["leftLeg"].rotation.x, "leftLegRy" : archerStructure["leftLeg"].rotation.y, "leftLegRz" : archerStructure["leftLeg"].rotation.z,
								"leftFootRx" : archerStructure["leftFoot"].rotation.x, "leftFootRy" : archerStructure["leftFoot"].rotation.y, "leftFootRz" : archerStructure["leftFoot"].rotation.z,
								"leftToeBaseRx" : archerStructure["leftToeBase"].rotation.x, "leftToeBaseRy" : archerStructure["leftToeBase"].rotation.y, "leftToeBaseRz" : archerStructure["leftToeBase"].rotation.z,
								"leftToe_EndRx" : archerStructure["leftToe_End"].rotation.x, "leftToe_EndRy" : archerStructure["leftToe_End"].rotation.y, "leftToe_EndRz" : archerStructure["leftToe_End"].rotation.z,
								"rightUpLegRx" : archerStructure["rightUpLeg"].rotation.x, "rightUpLegRy" : archerStructure["rightUpLeg"].rotation.y, "rightUpLegRz" : archerStructure["rightUpLeg"].rotation.z,
								"rightLegRx" : archerStructure["rightLeg"].rotation.x, "rightLegRy" : archerStructure["rightLeg"].rotation.y, "rightLegRz" : archerStructure["rightLeg"].rotation.z,
								"rightFootRx" : archerStructure["rightFoot"].rotation.x, "rightFootRy" : archerStructure["rightFoot"].rotation.y, "rightFootRz" : archerStructure["rightFoot"].rotation.z,
								"rightToeBaseRx" : archerStructure["rightToeBase"].rotation.x, "rightToeBaseRy" : archerStructure["rightToeBase"].rotation.y, "rightToeBaseRz" : archerStructure["rightToeBase"].rotation.z,
								"rightToe_EndRx" : archerStructure["rightToe_End"].rotation.x, "rightToe_EndRy" : archerStructure["rightToe_End"].rotation.y, "rightToe_EndRz" : archerStructure["rightToe_End"].rotation.z
								};
			
			//Standard updateFunction for the tweens of the archer
			const updateFunction = function (object, elapsedTime) {
				//If the player is not shooting then you can move the upper part of the body
				if(canShoot){
					archerStructure["neck"].rotation.x = object["neckRx"];  archerStructure["neck"].rotation.y = object["neckRy"];  archerStructure["neck"].rotation.z = object["neckRz"];  
					archerStructure["head"].rotation.x = object["headRx"];  archerStructure["head"].rotation.y = object["headRy"];  archerStructure["head"].rotation.z = object["headRz"];  
					archerStructure["headTop_End"].rotation.x = object["headTop_EndRx"];  archerStructure["headTop_End"].rotation.y = object["headTop_EndRy"];  archerStructure["headTop_End"].rotation.z = object["headTop_EndRz"];  
					archerStructure["leftShoulder"].rotation.x = object["leftShoulderRx"];  archerStructure["leftShoulder"].rotation.y = object["leftShoulderRy"];  archerStructure["leftShoulder"].rotation.z = object["leftShoulderRz"];  
					archerStructure["leftArm"].rotation.x = object["leftArmRx"];  archerStructure["leftArm"].rotation.y = object["leftArmRy"];  archerStructure["leftArm"].rotation.z = object["leftArmRz"];  
					archerStructure["leftForeArm"].rotation.x = object["leftForeArmRx"];  archerStructure["leftForeArm"].rotation.y = object["leftForeArmRy"];  archerStructure["leftForeArm"].rotation.z = object["leftForeArmRz"];  
					archerStructure["leftHand"].rotation.x = object["leftHandRx"];  archerStructure["leftHand"].rotation.y = object["leftHandRy"];  archerStructure["leftHand"].rotation.z = object["leftHandRz"];  
					archerStructure["leftHandThumb1"].rotation.x = object["leftHandThumb1Rx"];  archerStructure["leftHandThumb1"].rotation.y = object["leftHandThumb1Ry"];  archerStructure["leftHandThumb1"].rotation.z = object["leftHandThumb1Rz"];  
					archerStructure["leftHandThumb2"].rotation.x = object["leftHandThumb2Rx"];  archerStructure["leftHandThumb2"].rotation.y = object["leftHandThumb2Ry"];  archerStructure["leftHandThumb2"].rotation.z = object["leftHandThumb2Rz"];  
					archerStructure["leftHandThumb3"].rotation.x = object["leftHandThumb3Rx"];  archerStructure["leftHandThumb3"].rotation.y = object["leftHandThumb3Ry"];  archerStructure["leftHandThumb3"].rotation.z = object["leftHandThumb3Rz"];  
					archerStructure["leftHandThumb4"].rotation.x = object["leftHandThumb4Rx"];  archerStructure["leftHandThumb4"].rotation.y = object["leftHandThumb4Ry"];  archerStructure["leftHandThumb4"].rotation.z = object["leftHandThumb4Rz"];  
					archerStructure["leftHandIndex1"].rotation.x = object["leftHandIndex1Rx"];  archerStructure["leftHandIndex1"].rotation.y = object["leftHandIndex1Ry"];  archerStructure["leftHandIndex1"].rotation.z = object["leftHandIndex1Rz"];  
					archerStructure["leftHandIndex2"].rotation.x = object["leftHandIndex2Rx"];  archerStructure["leftHandIndex2"].rotation.y = object["leftHandIndex2Ry"];  archerStructure["leftHandIndex2"].rotation.z = object["leftHandIndex2Rz"];  
					archerStructure["leftHandIndex3"].rotation.x = object["leftHandIndex3Rx"];  archerStructure["leftHandIndex3"].rotation.y = object["leftHandIndex3Ry"];  archerStructure["leftHandIndex3"].rotation.z = object["leftHandIndex3Rz"];  
					archerStructure["leftHandIndex4"].rotation.x = object["leftHandIndex4Rx"];  archerStructure["leftHandIndex4"].rotation.y = object["leftHandIndex4Ry"];  archerStructure["leftHandIndex4"].rotation.z = object["leftHandIndex4Rz"];  
					archerStructure["leftHandMiddle1"].rotation.x = object["leftHandMiddle1Rx"];  archerStructure["leftHandMiddle1"].rotation.y = object["leftHandMiddle1Ry"];  archerStructure["leftHandMiddle1"].rotation.z = object["leftHandMiddle1Rz"];  
					archerStructure["leftHandMiddle2"].rotation.x = object["leftHandMiddle2Rx"];  archerStructure["leftHandMiddle2"].rotation.y = object["leftHandMiddle2Ry"];  archerStructure["leftHandMiddle2"].rotation.z = object["leftHandMiddle2Rz"];  
					archerStructure["leftHandMiddle3"].rotation.x = object["leftHandMiddle3Rx"];  archerStructure["leftHandMiddle3"].rotation.y = object["leftHandMiddle3Ry"];  archerStructure["leftHandMiddle3"].rotation.z = object["leftHandMiddle3Rz"];  
					archerStructure["leftHandMiddle4"].rotation.x = object["leftHandMiddle4Rx"];  archerStructure["leftHandMiddle4"].rotation.y = object["leftHandMiddle4Ry"];  archerStructure["leftHandMiddle4"].rotation.z = object["leftHandMiddle4Rz"];  
					archerStructure["leftHandRing1"].rotation.x = object["leftHandRing1Rx"];  archerStructure["leftHandRing1"].rotation.y = object["leftHandRing1Ry"];  archerStructure["leftHandRing1"].rotation.z = object["leftHandRing1Rz"];  
					archerStructure["leftHandRing2"].rotation.x = object["leftHandRing2Rx"];  archerStructure["leftHandRing2"].rotation.y = object["leftHandRing2Ry"];  archerStructure["leftHandRing2"].rotation.z = object["leftHandRing2Rz"];  
					archerStructure["leftHandRing3"].rotation.x = object["leftHandRing3Rx"];  archerStructure["leftHandRing3"].rotation.y = object["leftHandRing3Ry"];  archerStructure["leftHandRing3"].rotation.z = object["leftHandRing3Rz"];  
					archerStructure["leftHandRing4"].rotation.x = object["leftHandRing4Rx"];  archerStructure["leftHandRing4"].rotation.y = object["leftHandRing4Ry"];  archerStructure["leftHandRing4"].rotation.z = object["leftHandRing4Rz"];  
					archerStructure["leftHandPinky1"].rotation.x = object["leftHandPinky1Rx"];  archerStructure["leftHandPinky1"].rotation.y = object["leftHandPinky1Ry"];  archerStructure["leftHandPinky1"].rotation.z = object["leftHandPinky1Rz"];  
					archerStructure["leftHandPinky2"].rotation.x = object["leftHandPinky2Rx"];  archerStructure["leftHandPinky2"].rotation.y = object["leftHandPinky2Ry"];  archerStructure["leftHandPinky2"].rotation.z = object["leftHandPinky2Rz"];  
					archerStructure["leftHandPinky3"].rotation.x = object["leftHandPinky3Rx"];  archerStructure["leftHandPinky3"].rotation.y = object["leftHandPinky3Ry"];  archerStructure["leftHandPinky3"].rotation.z = object["leftHandPinky3Rz"];  
					archerStructure["leftHandPinky4"].rotation.x = object["leftHandPinky4Rx"];  archerStructure["leftHandPinky4"].rotation.y = object["leftHandPinky4Ry"];  archerStructure["leftHandPinky4"].rotation.z = object["leftHandPinky4Rz"];  
					archerStructure["rightShoulder"].rotation.x = object["rightShoulderRx"];  archerStructure["rightShoulder"].rotation.y = object["rightShoulderRy"];  archerStructure["rightShoulder"].rotation.z = object["rightShoulderRz"];  
					archerStructure["rightArm"].rotation.x = object["rightArmRx"];  archerStructure["rightArm"].rotation.y = object["rightArmRy"];  archerStructure["rightArm"].rotation.z = object["rightArmRz"];  
					archerStructure["rightForeArm"].rotation.x = object["rightForeArmRx"];  archerStructure["rightForeArm"].rotation.y = object["rightForeArmRy"];  archerStructure["rightForeArm"].rotation.z = object["rightForeArmRz"];  
					archerStructure["rightHand"].rotation.x = object["rightHandRx"];  archerStructure["rightHand"].rotation.y = object["rightHandRy"];  archerStructure["rightHand"].rotation.z = object["rightHandRz"];  
					archerStructure["rightHandPinky1"].rotation.x = object["rightHandPinky1Rx"];  archerStructure["rightHandPinky1"].rotation.y = object["rightHandPinky1Ry"];  archerStructure["rightHandPinky1"].rotation.z = object["rightHandPinky1Rz"];  
					archerStructure["rightHandPinky2"].rotation.x = object["rightHandPinky2Rx"];  archerStructure["rightHandPinky2"].rotation.y = object["rightHandPinky2Ry"];  archerStructure["rightHandPinky2"].rotation.z = object["rightHandPinky2Rz"];  
					archerStructure["rightHandPinky3"].rotation.x = object["rightHandPinky3Rx"];  archerStructure["rightHandPinky3"].rotation.y = object["rightHandPinky3Ry"];  archerStructure["rightHandPinky3"].rotation.z = object["rightHandPinky3Rz"];  
					archerStructure["rightHandPinky4"].rotation.x = object["rightHandPinky4Rx"];  archerStructure["rightHandPinky4"].rotation.y = object["rightHandPinky4Ry"];  archerStructure["rightHandPinky4"].rotation.z = object["rightHandPinky4Rz"];  
					archerStructure["rightHandRing1"].rotation.x = object["rightHandRing1Rx"];  archerStructure["rightHandRing1"].rotation.y = object["rightHandRing1Ry"];  archerStructure["rightHandRing1"].rotation.z = object["rightHandRing1Rz"];  
					archerStructure["rightHandRing2"].rotation.x = object["rightHandRing2Rx"];  archerStructure["rightHandRing2"].rotation.y = object["rightHandRing2Ry"];  archerStructure["rightHandRing2"].rotation.z = object["rightHandRing2Rz"];  
					archerStructure["rightHandRing3"].rotation.x = object["rightHandRing3Rx"];  archerStructure["rightHandRing3"].rotation.y = object["rightHandRing3Ry"];  archerStructure["rightHandRing3"].rotation.z = object["rightHandRing3Rz"];  
					archerStructure["rightHandRing4"].rotation.x = object["rightHandRing4Rx"];  archerStructure["rightHandRing4"].rotation.y = object["rightHandRing4Ry"];  archerStructure["rightHandRing4"].rotation.z = object["rightHandRing4Rz"];  
					archerStructure["rightHandMiddle1"].rotation.x = object["rightHandMiddle1Rx"];  archerStructure["rightHandMiddle1"].rotation.y = object["rightHandMiddle1Ry"];  archerStructure["rightHandMiddle1"].rotation.z = object["rightHandMiddle1Rz"];  
					archerStructure["rightHandMiddle2"].rotation.x = object["rightHandMiddle2Rx"];  archerStructure["rightHandMiddle2"].rotation.y = object["rightHandMiddle2Ry"];  archerStructure["rightHandMiddle2"].rotation.z = object["rightHandMiddle2Rz"];  
					archerStructure["rightHandMiddle3"].rotation.x = object["rightHandMiddle3Rx"];  archerStructure["rightHandMiddle3"].rotation.y = object["rightHandMiddle3Ry"];  archerStructure["rightHandMiddle3"].rotation.z = object["rightHandMiddle3Rz"];  
					archerStructure["rightHandMiddle4"].rotation.x = object["rightHandMiddle4Rx"];  archerStructure["rightHandMiddle4"].rotation.y = object["rightHandMiddle4Ry"];  archerStructure["rightHandMiddle4"].rotation.z = object["rightHandMiddle4Rz"];  
					archerStructure["rightHandIndex1"].rotation.x = object["rightHandIndex1Rx"];  archerStructure["rightHandIndex1"].rotation.y = object["rightHandIndex1Ry"];  archerStructure["rightHandIndex1"].rotation.z = object["rightHandIndex1Rz"];  
					archerStructure["rightHandIndex2"].rotation.x = object["rightHandIndex2Rx"];  archerStructure["rightHandIndex2"].rotation.y = object["rightHandIndex2Ry"];  archerStructure["rightHandIndex2"].rotation.z = object["rightHandIndex2Rz"];  
					archerStructure["rightHandIndex3"].rotation.x = object["rightHandIndex3Rx"];  archerStructure["rightHandIndex3"].rotation.y = object["rightHandIndex3Ry"];  archerStructure["rightHandIndex3"].rotation.z = object["rightHandIndex3Rz"];  
					archerStructure["rightHandIndex4"].rotation.x = object["rightHandIndex4Rx"];  archerStructure["rightHandIndex4"].rotation.y = object["rightHandIndex4Ry"];  archerStructure["rightHandIndex4"].rotation.z = object["rightHandIndex4Rz"];  
					archerStructure["rightHandThumb1"].rotation.x = object["rightHandThumb1Rx"];  archerStructure["rightHandThumb1"].rotation.y = object["rightHandThumb1Ry"];  archerStructure["rightHandThumb1"].rotation.z = object["rightHandThumb1Rz"];  
					archerStructure["rightHandThumb2"].rotation.x = object["rightHandThumb2Rx"];  archerStructure["rightHandThumb2"].rotation.y = object["rightHandThumb2Ry"];  archerStructure["rightHandThumb2"].rotation.z = object["rightHandThumb2Rz"];  
					archerStructure["rightHandThumb3"].rotation.x = object["rightHandThumb3Rx"];  archerStructure["rightHandThumb3"].rotation.y = object["rightHandThumb3Ry"];  archerStructure["rightHandThumb3"].rotation.z = object["rightHandThumb3Rz"];  
					archerStructure["rightHandThumb4"].rotation.x = object["rightHandThumb4Rx"];  archerStructure["rightHandThumb4"].rotation.y = object["rightHandThumb4Ry"];  archerStructure["rightHandThumb4"].rotation.z = object["rightHandThumb4Rz"];   	
				}			
				archerStructure["hips"].rotation.x = object["hipsRx"];  archerStructure["hips"].rotation.y = object["hipsRy"];  archerStructure["hips"].rotation.z = object["hipsRz"];  
				archerStructure["spine"].rotation.x = object["spineRx"];  archerStructure["spine"].rotation.y = object["spineRy"];  archerStructure["spine"].rotation.z = object["spineRz"];  
				archerStructure["spine1"].rotation.x = object["spine1Rx"];  archerStructure["spine1"].rotation.y = object["spine1Ry"];  archerStructure["spine1"].rotation.z = object["spine1Rz"];  
				archerStructure["spine2"].rotation.x = object["spine2Rx"];  archerStructure["spine2"].rotation.y = object["spine2Ry"];  archerStructure["spine2"].rotation.z = object["spine2Rz"];  
				archerStructure["rightEye"].rotation.x = object["rightEyeRx"];  archerStructure["rightEye"].rotation.y = object["rightEyeRy"];  archerStructure["rightEye"].rotation.z = object["rightEyeRz"];  
				archerStructure["leftEye"].rotation.x = object["leftEyeRx"];  archerStructure["leftEye"].rotation.y = object["leftEyeRy"];  archerStructure["leftEye"].rotation.z = object["leftEyeRz"];  
				archerStructure["leftUpLeg"].rotation.x = object["leftUpLegRx"];  archerStructure["leftUpLeg"].rotation.y = object["leftUpLegRy"];  archerStructure["leftUpLeg"].rotation.z = object["leftUpLegRz"];  
				archerStructure["leftLeg"].rotation.x = object["leftLegRx"];  archerStructure["leftLeg"].rotation.y = object["leftLegRy"];  archerStructure["leftLeg"].rotation.z = object["leftLegRz"];  
				archerStructure["leftFoot"].rotation.x = object["leftFootRx"];  archerStructure["leftFoot"].rotation.y = object["leftFootRy"];  archerStructure["leftFoot"].rotation.z = object["leftFootRz"];  
				archerStructure["leftToeBase"].rotation.x = object["leftToeBaseRx"];  archerStructure["leftToeBase"].rotation.y = object["leftToeBaseRy"];  archerStructure["leftToeBase"].rotation.z = object["leftToeBaseRz"];  
				archerStructure["leftToe_End"].rotation.x = object["leftToe_EndRx"];  archerStructure["leftToe_End"].rotation.y = object["leftToe_EndRy"];  archerStructure["leftToe_End"].rotation.z = object["leftToe_EndRz"];  
				archerStructure["rightUpLeg"].rotation.x = object["rightUpLegRx"];  archerStructure["rightUpLeg"].rotation.y = object["rightUpLegRy"];  archerStructure["rightUpLeg"].rotation.z = object["rightUpLegRz"];  
				archerStructure["rightLeg"].rotation.x = object["rightLegRx"];  archerStructure["rightLeg"].rotation.y = object["rightLegRy"];  archerStructure["rightLeg"].rotation.z = object["rightLegRz"];  
				archerStructure["rightFoot"].rotation.x = object["rightFootRx"];  archerStructure["rightFoot"].rotation.y = object["rightFootRy"];  archerStructure["rightFoot"].rotation.z = object["rightFootRz"];  
				archerStructure["rightToeBase"].rotation.x = object["rightToeBaseRx"];  archerStructure["rightToeBase"].rotation.y = object["rightToeBaseRy"];  archerStructure["rightToeBase"].rotation.z = object["rightToeBaseRz"];  
				archerStructure["rightToe_End"].rotation.x = object["rightToe_EndRx"];  archerStructure["rightToe_End"].rotation.y = object["rightToe_EndRy"];  archerStructure["rightToe_End"].rotation.z = object["rightToe_EndRz"]; 
			};


			//updateFunction for the tweens of the archer concerning only the upper part of the body, like when shooting
			const updateFunctionUpperShoot = function (object, elapsedTime) {
				archerStructure["neck"].rotation.x = object["neckRx"];  archerStructure["neck"].rotation.y = object["neckRy"];  archerStructure["neck"].rotation.z = object["neckRz"];  
				archerStructure["head"].rotation.x = object["headRx"];  archerStructure["head"].rotation.y = object["headRy"];  archerStructure["head"].rotation.z = object["headRz"];  
				archerStructure["headTop_End"].rotation.x = object["headTop_EndRx"];  archerStructure["headTop_End"].rotation.y = object["headTop_EndRy"];  archerStructure["headTop_End"].rotation.z = object["headTop_EndRz"];  
				archerStructure["leftShoulder"].rotation.x = object["leftShoulderRx"];  archerStructure["leftShoulder"].rotation.y = object["leftShoulderRy"];  archerStructure["leftShoulder"].rotation.z = object["leftShoulderRz"];  
				archerStructure["leftArm"].rotation.x = object["leftArmRx"];  archerStructure["leftArm"].rotation.y = object["leftArmRy"];  archerStructure["leftArm"].rotation.z = object["leftArmRz"];  
				archerStructure["leftForeArm"].rotation.x = object["leftForeArmRx"];  archerStructure["leftForeArm"].rotation.y = object["leftForeArmRy"];  archerStructure["leftForeArm"].rotation.z = object["leftForeArmRz"];  
				archerStructure["leftHand"].rotation.x = object["leftHandRx"];  archerStructure["leftHand"].rotation.y = object["leftHandRy"];  archerStructure["leftHand"].rotation.z = object["leftHandRz"];  
				archerStructure["leftHandThumb1"].rotation.x = object["leftHandThumb1Rx"];  archerStructure["leftHandThumb1"].rotation.y = object["leftHandThumb1Ry"];  archerStructure["leftHandThumb1"].rotation.z = object["leftHandThumb1Rz"];  
				archerStructure["leftHandThumb2"].rotation.x = object["leftHandThumb2Rx"];  archerStructure["leftHandThumb2"].rotation.y = object["leftHandThumb2Ry"];  archerStructure["leftHandThumb2"].rotation.z = object["leftHandThumb2Rz"];  
				archerStructure["leftHandThumb3"].rotation.x = object["leftHandThumb3Rx"];  archerStructure["leftHandThumb3"].rotation.y = object["leftHandThumb3Ry"];  archerStructure["leftHandThumb3"].rotation.z = object["leftHandThumb3Rz"];  
				archerStructure["leftHandThumb4"].rotation.x = object["leftHandThumb4Rx"];  archerStructure["leftHandThumb4"].rotation.y = object["leftHandThumb4Ry"];  archerStructure["leftHandThumb4"].rotation.z = object["leftHandThumb4Rz"];  
				archerStructure["leftHandIndex1"].rotation.x = object["leftHandIndex1Rx"];  archerStructure["leftHandIndex1"].rotation.y = object["leftHandIndex1Ry"];  archerStructure["leftHandIndex1"].rotation.z = object["leftHandIndex1Rz"];  
				archerStructure["leftHandIndex2"].rotation.x = object["leftHandIndex2Rx"];  archerStructure["leftHandIndex2"].rotation.y = object["leftHandIndex2Ry"];  archerStructure["leftHandIndex2"].rotation.z = object["leftHandIndex2Rz"];  
				archerStructure["leftHandIndex3"].rotation.x = object["leftHandIndex3Rx"];  archerStructure["leftHandIndex3"].rotation.y = object["leftHandIndex3Ry"];  archerStructure["leftHandIndex3"].rotation.z = object["leftHandIndex3Rz"];  
				archerStructure["leftHandIndex4"].rotation.x = object["leftHandIndex4Rx"];  archerStructure["leftHandIndex4"].rotation.y = object["leftHandIndex4Ry"];  archerStructure["leftHandIndex4"].rotation.z = object["leftHandIndex4Rz"];  
				archerStructure["leftHandMiddle1"].rotation.x = object["leftHandMiddle1Rx"];  archerStructure["leftHandMiddle1"].rotation.y = object["leftHandMiddle1Ry"];  archerStructure["leftHandMiddle1"].rotation.z = object["leftHandMiddle1Rz"];  
				archerStructure["leftHandMiddle2"].rotation.x = object["leftHandMiddle2Rx"];  archerStructure["leftHandMiddle2"].rotation.y = object["leftHandMiddle2Ry"];  archerStructure["leftHandMiddle2"].rotation.z = object["leftHandMiddle2Rz"];  
				archerStructure["leftHandMiddle3"].rotation.x = object["leftHandMiddle3Rx"];  archerStructure["leftHandMiddle3"].rotation.y = object["leftHandMiddle3Ry"];  archerStructure["leftHandMiddle3"].rotation.z = object["leftHandMiddle3Rz"];  
				archerStructure["leftHandMiddle4"].rotation.x = object["leftHandMiddle4Rx"];  archerStructure["leftHandMiddle4"].rotation.y = object["leftHandMiddle4Ry"];  archerStructure["leftHandMiddle4"].rotation.z = object["leftHandMiddle4Rz"];  
				archerStructure["leftHandRing1"].rotation.x = object["leftHandRing1Rx"];  archerStructure["leftHandRing1"].rotation.y = object["leftHandRing1Ry"];  archerStructure["leftHandRing1"].rotation.z = object["leftHandRing1Rz"];  
				archerStructure["leftHandRing2"].rotation.x = object["leftHandRing2Rx"];  archerStructure["leftHandRing2"].rotation.y = object["leftHandRing2Ry"];  archerStructure["leftHandRing2"].rotation.z = object["leftHandRing2Rz"];  
				archerStructure["leftHandRing3"].rotation.x = object["leftHandRing3Rx"];  archerStructure["leftHandRing3"].rotation.y = object["leftHandRing3Ry"];  archerStructure["leftHandRing3"].rotation.z = object["leftHandRing3Rz"];  
				archerStructure["leftHandRing4"].rotation.x = object["leftHandRing4Rx"];  archerStructure["leftHandRing4"].rotation.y = object["leftHandRing4Ry"];  archerStructure["leftHandRing4"].rotation.z = object["leftHandRing4Rz"];  
				archerStructure["leftHandPinky1"].rotation.x = object["leftHandPinky1Rx"];  archerStructure["leftHandPinky1"].rotation.y = object["leftHandPinky1Ry"];  archerStructure["leftHandPinky1"].rotation.z = object["leftHandPinky1Rz"];  
				archerStructure["leftHandPinky2"].rotation.x = object["leftHandPinky2Rx"];  archerStructure["leftHandPinky2"].rotation.y = object["leftHandPinky2Ry"];  archerStructure["leftHandPinky2"].rotation.z = object["leftHandPinky2Rz"];  
				archerStructure["leftHandPinky3"].rotation.x = object["leftHandPinky3Rx"];  archerStructure["leftHandPinky3"].rotation.y = object["leftHandPinky3Ry"];  archerStructure["leftHandPinky3"].rotation.z = object["leftHandPinky3Rz"];  
				archerStructure["leftHandPinky4"].rotation.x = object["leftHandPinky4Rx"];  archerStructure["leftHandPinky4"].rotation.y = object["leftHandPinky4Ry"];  archerStructure["leftHandPinky4"].rotation.z = object["leftHandPinky4Rz"];  
				archerStructure["rightShoulder"].rotation.x = object["rightShoulderRx"];  archerStructure["rightShoulder"].rotation.y = object["rightShoulderRy"];  archerStructure["rightShoulder"].rotation.z = object["rightShoulderRz"];  
				archerStructure["rightArm"].rotation.x = object["rightArmRx"];  archerStructure["rightArm"].rotation.y = object["rightArmRy"];  archerStructure["rightArm"].rotation.z = object["rightArmRz"];  
				archerStructure["rightForeArm"].rotation.x = object["rightForeArmRx"];  archerStructure["rightForeArm"].rotation.y = object["rightForeArmRy"];  archerStructure["rightForeArm"].rotation.z = object["rightForeArmRz"];  
				archerStructure["rightHand"].rotation.x = object["rightHandRx"];  archerStructure["rightHand"].rotation.y = object["rightHandRy"];  archerStructure["rightHand"].rotation.z = object["rightHandRz"];  
				archerStructure["rightHandPinky1"].rotation.x = object["rightHandPinky1Rx"];  archerStructure["rightHandPinky1"].rotation.y = object["rightHandPinky1Ry"];  archerStructure["rightHandPinky1"].rotation.z = object["rightHandPinky1Rz"];  
				archerStructure["rightHandPinky2"].rotation.x = object["rightHandPinky2Rx"];  archerStructure["rightHandPinky2"].rotation.y = object["rightHandPinky2Ry"];  archerStructure["rightHandPinky2"].rotation.z = object["rightHandPinky2Rz"];  
				archerStructure["rightHandPinky3"].rotation.x = object["rightHandPinky3Rx"];  archerStructure["rightHandPinky3"].rotation.y = object["rightHandPinky3Ry"];  archerStructure["rightHandPinky3"].rotation.z = object["rightHandPinky3Rz"];  
				archerStructure["rightHandPinky4"].rotation.x = object["rightHandPinky4Rx"];  archerStructure["rightHandPinky4"].rotation.y = object["rightHandPinky4Ry"];  archerStructure["rightHandPinky4"].rotation.z = object["rightHandPinky4Rz"];  
				archerStructure["rightHandRing1"].rotation.x = object["rightHandRing1Rx"];  archerStructure["rightHandRing1"].rotation.y = object["rightHandRing1Ry"];  archerStructure["rightHandRing1"].rotation.z = object["rightHandRing1Rz"];  
				archerStructure["rightHandRing2"].rotation.x = object["rightHandRing2Rx"];  archerStructure["rightHandRing2"].rotation.y = object["rightHandRing2Ry"];  archerStructure["rightHandRing2"].rotation.z = object["rightHandRing2Rz"];  
				archerStructure["rightHandRing3"].rotation.x = object["rightHandRing3Rx"];  archerStructure["rightHandRing3"].rotation.y = object["rightHandRing3Ry"];  archerStructure["rightHandRing3"].rotation.z = object["rightHandRing3Rz"];  
				archerStructure["rightHandRing4"].rotation.x = object["rightHandRing4Rx"];  archerStructure["rightHandRing4"].rotation.y = object["rightHandRing4Ry"];  archerStructure["rightHandRing4"].rotation.z = object["rightHandRing4Rz"];  
				archerStructure["rightHandMiddle1"].rotation.x = object["rightHandMiddle1Rx"];  archerStructure["rightHandMiddle1"].rotation.y = object["rightHandMiddle1Ry"];  archerStructure["rightHandMiddle1"].rotation.z = object["rightHandMiddle1Rz"];  
				archerStructure["rightHandMiddle2"].rotation.x = object["rightHandMiddle2Rx"];  archerStructure["rightHandMiddle2"].rotation.y = object["rightHandMiddle2Ry"];  archerStructure["rightHandMiddle2"].rotation.z = object["rightHandMiddle2Rz"];  
				archerStructure["rightHandMiddle3"].rotation.x = object["rightHandMiddle3Rx"];  archerStructure["rightHandMiddle3"].rotation.y = object["rightHandMiddle3Ry"];  archerStructure["rightHandMiddle3"].rotation.z = object["rightHandMiddle3Rz"];  
				archerStructure["rightHandMiddle4"].rotation.x = object["rightHandMiddle4Rx"];  archerStructure["rightHandMiddle4"].rotation.y = object["rightHandMiddle4Ry"];  archerStructure["rightHandMiddle4"].rotation.z = object["rightHandMiddle4Rz"];  
				archerStructure["rightHandIndex1"].rotation.x = object["rightHandIndex1Rx"];  archerStructure["rightHandIndex1"].rotation.y = object["rightHandIndex1Ry"];  archerStructure["rightHandIndex1"].rotation.z = object["rightHandIndex1Rz"];  
				archerStructure["rightHandIndex2"].rotation.x = object["rightHandIndex2Rx"];  archerStructure["rightHandIndex2"].rotation.y = object["rightHandIndex2Ry"];  archerStructure["rightHandIndex2"].rotation.z = object["rightHandIndex2Rz"];  
				archerStructure["rightHandIndex3"].rotation.x = object["rightHandIndex3Rx"];  archerStructure["rightHandIndex3"].rotation.y = object["rightHandIndex3Ry"];  archerStructure["rightHandIndex3"].rotation.z = object["rightHandIndex3Rz"];  
				archerStructure["rightHandIndex4"].rotation.x = object["rightHandIndex4Rx"];  archerStructure["rightHandIndex4"].rotation.y = object["rightHandIndex4Ry"];  archerStructure["rightHandIndex4"].rotation.z = object["rightHandIndex4Rz"];  
				archerStructure["rightHandThumb1"].rotation.x = object["rightHandThumb1Rx"];  archerStructure["rightHandThumb1"].rotation.y = object["rightHandThumb1Ry"];  archerStructure["rightHandThumb1"].rotation.z = object["rightHandThumb1Rz"];  
				archerStructure["rightHandThumb2"].rotation.x = object["rightHandThumb2Rx"];  archerStructure["rightHandThumb2"].rotation.y = object["rightHandThumb2Ry"];  archerStructure["rightHandThumb2"].rotation.z = object["rightHandThumb2Rz"];  
				archerStructure["rightHandThumb3"].rotation.x = object["rightHandThumb3Rx"];  archerStructure["rightHandThumb3"].rotation.y = object["rightHandThumb3Ry"];  archerStructure["rightHandThumb3"].rotation.z = object["rightHandThumb3Rz"];  
				archerStructure["rightHandThumb4"].rotation.x = object["rightHandThumb4Rx"];  archerStructure["rightHandThumb4"].rotation.y = object["rightHandThumb4Ry"];  archerStructure["rightHandThumb4"].rotation.z = object["rightHandThumb4Rz"];   	
			};

			//Now a list of tweens that characterize the main states of the archer
			idle = new TWEEN.Tween(startRotations).to({
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
													}, 200);
			
			idleB = new TWEEN.Tween(startRotations).to({
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000 + 0.04, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000 + 0.04, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000 + 0.04, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
														}, 1000).repeat(Infinity).yoyo(true);

			idle.onComplete(()=>{
				idleB.start();
			});
							
			jumpA = new TWEEN.Tween(startRotations).to({
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000 + Math.PI/6,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000  - Math.PI/2, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000 - Math.PI/6,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000  + Math.PI/2, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010 - Math.PI/4, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021 + Math.PI/2, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010 - Math.PI/4, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020 + Math.PI/2, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
													}, 900).onComplete(()=>{
														jumpB.start();
													});

													jumpB = new TWEEN.Tween(startRotations).to({
														"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
													}, 500);

			walkA = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/30, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/6, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/6, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010 - Math.PI/16, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021 + Math.PI/3, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
													}, 200).onComplete(() => walkB.start());
			
			walkB = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/27, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000 + Math.PI/6, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/8, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000 - Math.PI/6, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/8, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010 - Math.PI/4, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021 + Math.PI/4, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010 + Math.PI/16, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020 + Math.PI/4, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000}, 200).onComplete(() => walkC.start());

			walkC = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/30, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/6, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/6, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010 - Math.PI/16, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020 + Math.PI/3, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000}, 200).onComplete(() => walkD.start());

			walkD = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/27, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000 - Math.PI/6, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/8, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000 + Math.PI/6, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/8, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010 + Math.PI/16, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021 + Math.PI/4, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010 - Math.PI/4, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020 + Math.PI/4, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000}, 200).onComplete(() => walkA.start());


			runA = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/12, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000 + Math.PI/20, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/3, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/3, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010 - Math.PI/8, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021 + Math.PI/1.5, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
													}, 150).onComplete(() => runB.start());
			
			runB = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/11, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000 + Math.PI/19, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000 + Math.PI/3, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/4, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000 - Math.PI/3, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/4, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010 - Math.PI/2, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021 + Math.PI/2, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010 + Math.PI/8, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020 + Math.PI/2, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000}, 150).onComplete(() => runC.start());

			runC = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/12, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000 + Math.PI/20, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/3, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/3, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010 - Math.PI/8, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020 + Math.PI/1.5, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000}, 150).onComplete(() => runD.start());

			runD = new TWEEN.Tween(startRotations).to({													
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000 + Math.PI/11, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000 + Math.PI/19, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000 - Math.PI/3, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000 - Math.PI/4, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000 + Math.PI/3, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/4, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010 + Math.PI/8, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021 + Math.PI/2, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010 - Math.PI/2, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020 + Math.PI/2, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000}, 150).onComplete(() => runA.start());
			

			shootPre = new TWEEN.Tween(startRotations).to({
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -Math.PI/2, "leftShoulderRy" : -0.0000, "leftShoulderRz" : -Math.PI/6,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000 - Math.PI/1.5, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000 + Math.PI/1.2, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													}, 200).onComplete(()=>{
														shootA.start();
														archerRightHand.add(arrowAnimation);
													});

			shootA = new TWEEN.Tween(startRotations).to({
														"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
														"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
														"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
														"leftShoulderRx" : -Math.PI/2, "leftShoulderRy" : -0.0000, "leftShoulderRz" : -Math.PI/6,
														"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
														"leftForeArmRx" : -0.0000, "leftForeArmRy" : 0, "leftForeArmRz" : -0.0000,
														"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : Math.PI/10,
														"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
														"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
														"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
														"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
														"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
														"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
														"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
														"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
														"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
														"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
														"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
														"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
														"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
														"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
														"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
														"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
														"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
														"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
														"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
														"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
														"rightShoulderRx" : -Math.PI/2, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -Math.PI/8,
														"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
														"rightForeArmRx" : -0.0000, "rightForeArmRy" : 0, "rightForeArmRz" : 0.0000 + Math.PI/2.9,
														"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
														"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
														"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
														"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
														"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
														"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
														"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
														"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
														"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
														"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
														"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
														"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
														"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
														"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
														"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
														"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
														"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
														"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
														"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
														"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
														"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
														}, 200).onComplete(() => {
															shootB.start()
															archerRightHand.remove(arrowAnimation);

														});

			shootB = new TWEEN.Tween(startRotations).to({
														"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
														"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
														"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
														"leftShoulderRx" : -Math.PI/2, "leftShoulderRy" : -0.0000, "leftShoulderRz" : -Math.PI/6,
														"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
														"leftForeArmRx" : -0.0000, "leftForeArmRy" : 0, "leftForeArmRz" : -0.0000,
														"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : Math.PI/10,
														"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
														"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
														"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
														"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
														"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
														"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
														"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
														"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
														"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
														"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
														"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
														"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
														"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
														"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
														"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
														"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
														"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
														"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
														"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
														"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
														"rightShoulderRx" : -Math.PI/2, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -Math.PI/4,
														"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
														"rightForeArmRx" : -0.0000, "rightForeArmRy" : 0, "rightForeArmRz" : 0.0000 + Math.PI/2,
														"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
														"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
														"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
														"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
														"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
														"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
														"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
														"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
														"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
														"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
														"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
														"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
														"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
														"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
														"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
														"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
														"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
														"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
														"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
														"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
														"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
														}, 200).onComplete(() => {
															//When completing the second phase of the animation then the arrow can be emitted
															throwArrow();
															shootC.start()		
														});

			shootC = new TWEEN.Tween(startRotations).to({													
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,													
													}, 200).onComplete(() => {
															canShoot=true;		
														});

			idle.onUpdate(updateFunction);
			idleB.onUpdate(updateFunction);
			runA.onUpdate(updateFunction);
			runB.onUpdate(updateFunction);
			runC.onUpdate(updateFunction);
			runD.onUpdate(updateFunction);
			walkA.onUpdate(updateFunction);
			walkB.onUpdate(updateFunction);
			walkC.onUpdate(updateFunction);
			walkD.onUpdate(updateFunction);
			jumpA.onUpdate(updateFunction);
			jumpB.onUpdate(updateFunction);
			shootPre.onUpdate(updateFunctionUpperShoot);
			shootA.onUpdate(updateFunctionUpperShoot);
			shootB.onUpdate(updateFunctionUpperShoot);
			shootC.onUpdate(updateFunctionUpperShoot);

			//In the beginning the player must be in the idle pose
			idle.start()
		});

		//Function that make the floating platforms fall once the archer goes through the starting line
		function level4Animate(){
			if(currentObsPlat<44 && cubeBody.position.z > 190 && cubeBody.position.z < 305 && canFallPlatform && obsPlat[currentObsPlat]){
					canFallPlatform=false;
					setTimeout(function() {
						canFallPlatform = true;
					},2000);
					obsPlat[currentObsPlat]["rotatePlatFloating"].stop();
					//Makes the floating platform selected fall
					obsPlat[currentObsPlat]["body"].mass=100;
					obsPlat[currentObsPlat]["body"].updateMassProperties();
					currentObsPlat++;
				}
		}

			//Function that makes the cannon shoot the archer
			function cannonShootArcher(){
				//Utility function to see if a bomb is a killer one (it didn't touch the ground yet)
				function checkBombKiller(id){
					var ret=false;
					bombs.forEach(element => {
						if(element["killer"] && element["can"].id==id){
							ret = true;
						}
					});
					return ret;
				}

				//Function that returns the listener for the collision event of the bombs (can't create the listener directly in the loop)
				function bombColliderEvent(genBomb){
					return (e) => {
						//If the bomb is bi and not bj negate the normal of the impact
						if ( e.contact.bi.id == genBomb["can"].id ) {
						e.contact.ni.negate( e.contact.ni );
						}
						//If the normal of contact is vertical within a certain threshold then the bomb touched the ground (so it's not able to kill anymore)
						if ( e.contact.ni.dot( new CANNON.Vec3( 0, 1, 0 ) ) > 0.5) {
							genBomb["killer"] = false;
						}
						//If a bomb who is able to kill thouches the player, then repulse him
						if (cubeBody && cannonBody && ((e.contact.bi.id == cubeBody.id && checkBombKiller(e.contact.bj.id)) || (e.contact.bj.id == cubeBody.id && checkBombKiller(e.contact.bi.id)))) {
							var bombRepulseVelocity = 80;
							var impactDir = new THREE.Vector3();
							//For simplicity I consider the position of the cannon to calculate the direction of the impact (should be near the bomb impact direction)
							impactDir.subVectors(  cubeBody.position,cannonBody.position);
							impactDir.normalize();
							cubeBody.velocity.x = bombRepulseVelocity * impactDir.x;
							cubeBody.velocity.z = bombRepulseVelocity * impactDir.z;
						}
					} 
				}

				//If the player is within a certain zone then start shooting cannon balls
				if(cubeBody.position.z > 135 && cubeBody.position.z < 172 && !justShotCannon1){
					justShotCannon1=true;
					setTimeout(function() {
						justShotCannon1 = false;
					},3000);

					//Cannon must shoot only horizzontally in the direction of the player
					var desAngle = new THREE.Vector3()
					desAngle.x = -(cannonBody.position.x - cubeBody.position.x);
					desAngle.y = 0;
					desAngle.z = -(cannonBody.position.z - cubeBody.position.z);
					desAngle.normalize();


					//Fixing the bomb spawn position, it should spawn at the end of the barrel
					var bombSpawnPosition = new THREE.Vector3(cannonBody.position.x + desAngle.x * 2, cannonBody.position.y, cannonBody.position.z + desAngle.z * 2);

					var genBombCan = new CANNON.Body({
						mass: 0,
						shape: new CANNON.Sphere(0.5),
						position: new CANNON.Vec3(bombSpawnPosition.x, bombSpawnPosition.y, bombSpawnPosition.z),
						linearDamping: 0.5,
						angularDamping: 0.5,
						type : CANNON.Body.DYNAMIC
					});
					
					var genBombMesh = new THREE.Mesh( new THREE.SphereGeometry(0.5), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ));
					
					if(getParameterWireframes == "1")
						scene.add( genBombMesh );
					var genBombModel = bombModel.clone();
					
					var genBombModelParent = new THREE.Object3D();
					genBombModel.position.set(0 , -0.4, 0);
					genBombModelParent.add(genBombModel);
					scene.add( genBombModelParent );

					if(getParameterSoundEf == "1"){
						cannonShootAudio.play();
					}
					
					world.addBody(genBombCan);

					var bombVelocity = 1;

					var impactDir = new THREE.Vector3();

					//For simplicity I consider the position of the player to calculate the direction of the impact (should be near the arrow impact direction)
					impactDir.subVectors( cubeBody.position, cannonBody.position);

					var startPosition = bombSpawnPosition;
					var desPosition= cubeBody.position;
					var shootVelocity = 0.04;
					var distance = Math.abs(cannonBody.position.x - cubeBody.position.x) + Math.abs(cannonBody.position.z - cubeBody.position.z)
					var time = distance / shootVelocity;
					new TWEEN.Tween({"x": startPosition.x, "y": startPosition.y, "z": startPosition.z,}).to({"x": desPosition.x, "y": bombSpawnPosition.y, "z": desPosition.z},time).onComplete(() => {genBombCan.mass=10; genBombCan.updateMassProperties(); genBombCan.velocity.x = bombVelocity * impactDir.x; genBombCan.velocity.z = bombVelocity * impactDir.z; genBombCan.velocity.y = bombVelocity * impactDir.y;}).onUpdate((object)=>{genBombCan.position.x=object["x"];genBombCan.position.y=object["y"];genBombCan.position.z=object["z"];}).start();
					
					var genbomb = {"can":genBombCan, "mesh":genBombMesh, "model":genBombModelParent, "killer" : true};
					
					bombs.push(genbomb);

					genBombCan.addEventListener("collide", bombColliderEvent(genbomb));
				}

			
		}


		//Cannon basic movement animation
		new TWEEN.Tween({"z": 150}).to({"z": 162},1500).repeat(Infinity).yoyo(true).onUpdate((object)=>{cannonBody.position.z=object["z"]; obsPlat[18].body.position.z=object["z"]}).start();
		



		//Setting up the body of the archer (a cube is sufficiently precise for the purpose of this project)
		const cubePhysMat = new CANNON.Material();

		const cubeBody = new CANNON.Body({
			mass: 80,
			shape: new CANNON.Box(new CANNON.Vec3(0.7, 1.5, 1.0)),
			position: new CANNON.Vec3(0, 2.8, 0), //INITIAL POSITION
			//position: new CANNON.Vec3(0, 2.8 + 6., 0 + 180), //SKIP TO END CANNON
			// position: new CANNON.Vec3(0, 2.8 +6 , 320), //SKIP TO FIRST TERMINAL
			// position: new CANNON.Vec3(10, 2.8 +6 , 380), //SKIP TO SECOND TERMINAL
			material: cubePhysMat,
			linearDamping: 0.5,
 		    angularDamping: 0.5,
			type: CANNON.Body.DYNAMIC 
		});

		
		world.addBody(cubeBody);


		//Shooting function for the archer (to start the shooting animation)
		function shoot(){
			shootPre.start();
		}

		//Function to effectively generate the arrow when shooting (in the correct direction and using physics)
		function throwArrow(){
					
			//Function that returns the listener for the collision event of the arrows (can't create the listener directly in the loop, foreach not behaving well with async functions like addEventListener)
			function arrowColliderEvent(genArrow){
				return (e) => {
					if ( e.contact.bi.id == genArrow["can"].id ) {
					e.contact.ni.negate( e.contact.ni );
					}

					if ( e.contact.ni.dot( new CANNON.Vec3( 0, 1, 0 ) ) > 0.5) {
						genArrow["killer"] = false;
					}
				} 
			}

			//Getting the camera direction to see where we have to shoot the arrow
			var cameraDirection= new THREE.Vector3();
			camera.getWorldDirection(cameraDirection);

			//Vertical direction not useful for movement, player can't fly
			cameraDirection.y = 0;
			cameraDirection.normalize();
			cameraDirection.applyAxisAngle(new THREE.Vector3(0,1,0), relDir);
			var moveX = cameraDirection.x;
			var moveZ = cameraDirection.z;
			var arrowDirection = new THREE.Vector3(moveX, 0, 0);
			arrowDirection.add(new THREE.Vector3(0, 0, moveZ));


			var cubeArrowCan = new CANNON.Body({
				mass: 2,
				shape: new CANNON.Box(new CANNON.Vec3(0.05, 0.05, 0.7 )),  
				position: new CANNON.Vec3(archerModelParent.position.x + 2*moveX, archerModelParent.position.y+0.8, archerModelParent.position.z + 2*moveZ),
				linearDamping: 0.5,
				angularDamping: 0.5,
			});
			
			var cubeArrowMesh = new THREE.Mesh( new THREE.BoxGeometry( 0.1 , 0.1, 1.4), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ));
			
			var cubeArrowModel = arrowModel.clone();
			
			var cubeArrowModelParent = new THREE.Object3D();
			cubeArrowModel.getWorldPosition(cubeArrowModelParent.position);
			cubeArrowModel.position.set(0 , 0, -cubeArrowMesh.geometry.parameters.depth/2);
			cubeArrowModelParent.add(cubeArrowModel);
			if(getParameterWireframes == "1")
				scene.add( cubeArrowMesh );
			scene.add( cubeArrowModelParent );

			if(getParameterSoundEf == "1")
				archerShootAudio.play();
			
			world.addBody(cubeArrowCan);
			cubeArrowModelParent.lookAt(arrowDirection);

			var arrowVelocity = 40;

			cubeArrowCan.velocity.z = arrowVelocity * moveZ;
			cubeArrowCan.velocity.x = arrowVelocity * moveX;
			
			var genArrow = {"can":cubeArrowCan, "mesh":cubeArrowMesh, "model":cubeArrowModelParent, "killer" : true};
			
			arrows.push(genArrow);

			cubeArrowCan.addEventListener("collide", arrowColliderEvent(genArrow));

		}

		//Creating CANNON-ES bodies and the THREEJS wireframes for the targets
		var targetBody1 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(-2, 2.5, 20),
			type : CANNON.Body.DYNAMIC,
			mass:0
		});
		const targetMesh1 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		if(getParameterWireframes == "1")	
			scene.add(targetMesh1);
		targetBody1.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody1);		
		
		var targetBody2 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(2, 2.5, 20),
			type : CANNON.Body.DYNAMIC,
			mass:0
		});
		const targetMesh2 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		if(getParameterWireframes == "1")	
			scene.add(targetMesh2);
		targetBody2.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody2);

		var targetBody3 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(-2, 1.5, 90),
			type : CANNON.Body.DYNAMIC,
			mass:0
		});
		const targetMesh3 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		if(getParameterWireframes == "1")	
			scene.add(targetMesh3);
		targetBody3.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody3);		
		
		var targetBody4 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(2, 1.5, 90),
			type : CANNON.Body.DYNAMIC,
			mass:0
		});
		const targetMesh4 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		if(getParameterWireframes == "1")	
			scene.add(targetMesh4);
		targetBody4.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody4);

		var targetBody5 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(0, 40, 400),
			type : CANNON.Body.DYNAMIC,
			mass:0
		});
		const targetMesh5 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		if(getParameterWireframes == "1")	
			scene.add(targetMesh5);
		targetBody5.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody5);		


		//Function called when the first objective is reached (playing audio and rotating the next platform)
		function obj1Completed(){
			if(!target1hit || !target2hit) return;
			level2Unlock.start();
			if(getParameterSoundEf == "1")
				tadaAudio.play();
		}

		//Function called when the second objective is reached (moving the floating platform to make stairs)
		function obj2Completed(){
			if(!target3hit || !target4hit) return;
			rotatePlatFloatingTweens.forEach(element => {
				element.stop();
				rotatePlatFloatingTweens = rotatePlatFloatingTweens.filter(function(ele){ 
					return ele != element; 
				});
				if(getParameterSoundEf == "1")
					tadaAudio.play();
			});
			
			level3Unlock1.onComplete(()=> {
				obsPlat.forEach(element => {
				var rotatePlatFloating = new TWEEN.Tween({y:element["body"].position.y}).to({y:element["body"].position.y+0.2}, 200).onUpdate((object)=>{if(element["body"])element["body"].position.y= object.y;});
				rotatePlatFloating.repeat(Infinity).yoyo(true);
				rotatePlatFloating.start();
				element["rotatePlatFloating"] = rotatePlatFloating;
				rotatePlatFloatingTweens.push(rotatePlatFloating);
			});
			}).start();
			level3Unlock2.start();
			level3Unlock3.start();
			level3Unlock4.start();
			level3Unlock5.start();
			level3Unlock6.start();
		}

		//Function called when the fourth objective is reached (end of the game, showing the endModel balloons)
		function obj4Completed(){
			if(target5hit == true){
				scene.add(endModel);
				new TWEEN.Tween({"y" : endModel.position.y}).to({"y": 15},5000).easing(TWEEN.Easing.Circular.Out).onUpdate((object)=>{
						endModel.position.y = object.y;
					}).onStart(()=>{
						if(mainThemeAudio.isPlaying)
							mainThemeAudio.stop();
						if(getParameterSoundMu == "1")
							theEndAudio.play();
					}).onComplete(()=>{
						new TWEEN.Tween({"y" : endModel.position.y}).to({"y": endModel.position.y + 5},5000).easing(TWEEN.Easing.Back.InOut).onUpdate((object)=>{
							endModel.position.y = object.y;	
						}).repeat(Infinity).yoyo(true).start();;
					}).start();
			}
		}

		
		//Creating the main platforms mesh wireframes and bodies
		const level2PlatformGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const level2PlatformMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
			});
		const level2PlatformMesh = new THREE.Mesh(level2PlatformGeo, level2PlatformMat);
		if(getParameterWireframes == "1")
			scene.add(level2PlatformMesh);
		level2PlatformMesh.receiveShadow=true;
		level2PlatformMesh.castshadow=true;

		const level2PlatformPhysMat = new CANNON.Material();


		const level2PlatformBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: level2PlatformPhysMat,
			position: new CANNON.Vec3(0, 0, 31)
		});
		world.addBody(level2PlatformBody);
		level2PlatformBody.quaternion.setFromEuler(Math.PI/2, Math.PI/6, 0);


		const level3PlatformGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const level3PlatformMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
			});
		const level3PlatformMesh = new THREE.Mesh(level3PlatformGeo, level3PlatformMat);
		if(getParameterWireframes == "1")
			scene.add(level3PlatformMesh);
		level3PlatformMesh.receiveShadow=true;
		level3PlatformMesh.castshadow=true;

		const level3PlatformPhysMat = new CANNON.Material();


		const level3PlatformBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: level3PlatformPhysMat,
			position: new CANNON.Vec3(0, 6.5, 117.5)
		});
		world.addBody(level3PlatformBody);
		level3PlatformBody.quaternion.setFromEuler(0, Math.PI/6, 0);

		const level5PlatformGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const level5PlatformMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
			});
		const level5PlatformMesh = new THREE.Mesh(level5PlatformGeo, level5PlatformMat);
		if(getParameterWireframes == "1")
			scene.add(level5PlatformMesh);
		level5PlatformMesh.receiveShadow=true;
		level5PlatformMesh.castshadow=true;

		const level5PlatformPhysMat = new CANNON.Material();


		const level5PlatformBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: level5PlatformPhysMat,
			position: new CANNON.Vec3(0, 6.5, 320)
		});
		world.addBody(level5PlatformBody);
		level5PlatformBody.quaternion.setFromEuler(0, Math.PI/6, 0);

		const level6PlatformGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const level6PlatformMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
			});
		const level6PlatformMesh = new THREE.Mesh(level6PlatformGeo, level6PlatformMat);
		if(getParameterWireframes == "1")
			scene.add(level6PlatformMesh);
		level6PlatformMesh.receiveShadow=true;
		level6PlatformMesh.castshadow=true;

		const level6PlatformPhysMat = new CANNON.Material();


		const level6PlatformBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: level6PlatformPhysMat,
			position: new CANNON.Vec3(0, 6.5, 370)
		});
		world.addBody(level6PlatformBody);
		level6PlatformBody.quaternion.setFromEuler(0, Math.PI/6, 0);

		

		//Defining contact materials, how two object have to interact physically between them
		const groundBoxContactMat = new CANNON.ContactMaterial(
			groundPhysMat,
			cubePhysMat,
			{restitution : 0},
			{friction : 1}
			);

		world.addContactMaterial(groundBoxContactMat);

		const groundCubeWeightContactMat = new CANNON.ContactMaterial(
			groundPhysMat,
			cubeWeightPhysMat,
			{restitution : 0},
			{friction : 0}
			);

		world.addContactMaterial(groundCubeWeightContactMat);

		//Defining the general event listeners

		//When the pause menu is clicked then the controls are locked
		pause_fg.addEventListener( 'click', function () {
			if ( !gameLoaded || (lastUnlockTime && (performance.now() - lastUnlockTime) < 1250)) {
				return
			}
			else
				orbit.lock();
		}, false );

		//Listener to make the renderer change the resolution
		window.addEventListener('resize', function() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			renderer.setSize(window.innerWidth, window.innerHeight);
		});

		//Listener to go to the main start menu
		document.getElementById("home_btn").addEventListener('click',function(){
			if(confirm("Going to the home you will loose the current progress in the game.\nDo you want to continue?"))
				window.location.href = ("menu.html");
		});

		//Listener to close the textual prompt for interaction
		document.getElementById("close_showText_prompt_btn").addEventListener('click',function(){
			document.getElementById("showText_prompt").style.display = "none";
		})

		//Listener to detect every key pressed
		document.addEventListener('keydown',(event) => {
			if(event.key.toLowerCase() == " ") pressed["SPACE"] = true;
			if(event.key.toLowerCase() == "shift") pressed["SHIFT"] = true;
			if(event.key.toLowerCase() == "w") pressed["W"] = true;
			if(event.key.toLowerCase() == "a") pressed["A"] = true;
			if(event.key.toLowerCase() == "s") pressed["S"] = true;
			if(event.key.toLowerCase() == "d") pressed["D"] = true;
			if(event.key.toLowerCase() == "f") pressed["F"] = true;
			if(event.key.toLowerCase() == "e") {
				pressed["E"] = true
				if(gameUnlocked == true)return;
				//If the interaction prompt text is showed, then hide it
				if(document.getElementById("showText_prompt").style.display == ""){
					document.getElementById("showText_prompt").style.display = "none";
					robotHoloDisappearTween = new TWEEN.Tween({"opacity" : 0.5}).to({"opacity": 0},500).easing(TWEEN.Easing.Bounce.InOut).onUpdate((object)=>{
						robotHoloModel.traverse( function( node ) {
							if (node.isMesh) { 
								node.material.opacity = object["opacity"];
							}
						} );
					}).onComplete(()=>{
						scene.remove(robotHoloModel);
					}).start();
				}
				//If we are near a hologram projection then show the text attached and show the hologram onto it with an animation
				else if(isNearHoloProj){
					if(getParameterSoundEf == "1")
						nearHoloProj["robotBlipAudio"].play();
					document.getElementById("showText_prompt").style.display="";
					document.getElementById("showText_prompt_txt").innerHTML = nearHoloProj["text"];
					scene.add(robotHoloModel)
					if(robotHoloDisappearTween && robotHoloDisappearTween.isPlaying)robotHoloDisappearTween.stop();
					robotHoloAppearTween = new TWEEN.Tween({"opacity" : 0}).to({"opacity": 0.5},500).easing(TWEEN.Easing.Bounce.InOut).onUpdate((object)=>{
						robotHoloModel.traverse( function( node ) {
							if (node.isMesh) { 
								node.material.opacity = object["opacity"];
							}
						} );
					}).start();
					robotHoloModel.position.set(nearHoloProj["body"].position.x, nearHoloProj["body"].position.y + 1.3, nearHoloProj["body"].position.z);
				}
				//If we are near to a terminal then trigger its dedicated function
				else if(isNearTerminal){
					if(getParameterSoundEf == "1")
						nearTerminal["terminalAudio"].play();
					nearTerminal["trigger"]();
				}
		};
		},false);
		
		//Listener for when the keys are released
		document.addEventListener('keyup',(event) => {
			if(event.key.toLowerCase() == " ") pressed["SPACE"] = false;
			if(event.key.toLowerCase() == "shift") pressed["SHIFT"] = false;
			if(event.key.toLowerCase() == "w") pressed["W"] = false;
			if(event.key.toLowerCase() == "a") pressed["A"] = false;
			if(event.key.toLowerCase() == "s") pressed["S"] = false;
			if(event.key.toLowerCase() == "d") pressed["D"] = false;
			if(event.key.toLowerCase() == "f") pressed["F"] = false;
			if(event.key.toLowerCase() == "e") pressed["E"] = false;
		},false);

		//Listener for archer's collisions
		cubeBody.addEventListener( "collide", function (e) {
			//Since e.contact.bi and e.contact.bj are the bodies colliding we would like to discover which is the player, in order to know if he is colliding with a floor or something else looking at the collision normal of the other object
			//the normal of collision with respect to the body e.contact.bi is contained inside e.contact.ni
			
			//If e.contact.ni is the collision normal of the player then we negate it to obtain the collision normal of the other object
			if ( e.contact.bi.id == cubeBody.id ) {
			e.contact.ni.negate( e.contact.ni );
			}

			//If the dot product between the vertical positive axis and the contact normal is between 0 and 1 then we know that the player is hitting a floor (or a surface to which he could stand)
			if ( e.contact.ni.dot( new CANNON.Vec3( 0, 1, 0 ) ) > 0.5){
				playerState = "Idle";
				//Set velocity to 0 to avoid bouncing when hitting the ground
				cubeBody.velocity.y = 0;
			}
		});

		//Remove the arrow considering its ID
		function removeArrowByID(id){
			arrows.forEach(element => {
				if(element["can"].id == id){
					scene.remove(element["model"]);
					setTimeout(function() {
						world.removeBody(element["can"]);
					},0);
					scene.remove(element["mesh"]);
					arrows = arrows.filter(function(ele){ 
						return ele != element; 
					});
				}
			});
		}

		//Collision listeners for each target
		targetBody1.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target1
			if (targetBody1 && (e.contact.bi.id == targetBody1.id || e.contact.bj.id == targetBody1.id)) {
				var arrowRepulseVelocity = 20;
				var impactDir = new THREE.Vector3();
				//For simplicity I consider the position of the player to calculate the direction of the impact (should be near the arrow impact direction)
				impactDir.subVectors( targetBody1.position, cubeBody.position,);
				impactDir.normalize();
				targetBody1.velocity.x = arrowRepulseVelocity * impactDir.x;
				targetBody1.velocity.z = arrowRepulseVelocity * impactDir.z;
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target1hit=true;
				targetBody1.mass=100;
				targetBody1.updateMassProperties();
				targetMovement1.stop();
				setTimeout(function() {
					scene.remove(targetModelParent1);
					world.removeBody(targetBody1);
					scene.remove(targetMesh1);
				},10000);
				obj1Completed();
			}
		});

		targetBody2.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target2
			if (targetBody2 && (e.contact.bi.id == targetBody2.id || e.contact.bj.id == targetBody2.id)) {
				var arrowRepulseVelocity = 20;
				var impactDir = new THREE.Vector3();
				//For simplicity I consider the position of the player to calculate the direction of the impact (should be near the arrow impact direction)
				impactDir.subVectors( targetBody2.position, cubeBody.position,);
				impactDir.normalize();
				targetBody2.velocity.x = arrowRepulseVelocity * impactDir.x;
				targetBody2.velocity.z = arrowRepulseVelocity * impactDir.z;
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target2hit=true;
				targetBody2.mass=100;
				targetBody2.updateMassProperties();
				targetMovement2.stop();
				setTimeout(function() {
					scene.remove(targetModelParent2);
					world.removeBody(targetBody2);
					scene.remove(targetMesh2);
				},10000);
				obj1Completed();
			}
		});

		targetBody3.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target3
			if (targetBody3 && (e.contact.bi.id == targetBody3.id || e.contact.bj.id == targetBody3.id)) {
				var arrowRepulseVelocity = 20;
				var impactDir = new THREE.Vector3();
				//For simplicity I consider the position of the player to calculate the direction of the impact (should be near the arrow impact direction)
				impactDir.subVectors( targetBody3.position, cubeBody.position,);
				impactDir.normalize();
				targetBody3.velocity.x = arrowRepulseVelocity * impactDir.x;
				targetBody3.velocity.z = arrowRepulseVelocity * impactDir.z;
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target3hit=true;
				targetBody3.mass=100;
				targetBody3.updateMassProperties();
				targetMovement3.stop();
				setTimeout(function() {
					scene.remove(targetModelParent3);
					world.removeBody(targetBody3);
					scene.remove(targetMesh3);
				},10000);
				obj2Completed();
			}
		});

		targetBody4.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target4
			if (targetBody4 && (e.contact.bi.id == targetBody4.id || e.contact.bj.id == targetBody4.id)) {
				var arrowRepulseVelocity = 20;
				var impactDir = new THREE.Vector3();
				//For simplicity I consider the position of the player to calculate the direction of the impact (should be near the arrow impact direction)
				impactDir.subVectors( targetBody4.position, cubeBody.position,);
				impactDir.normalize();
				targetBody4.velocity.x = arrowRepulseVelocity * impactDir.x;
				targetBody4.velocity.z = arrowRepulseVelocity * impactDir.z;
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target4hit=true;
				targetBody4.mass=100;
				targetBody4.updateMassProperties();
				targetMovement4.stop();
				setTimeout(function() {
					scene.remove(targetModelParent4);
					world.removeBody(targetBody4);
					scene.remove(targetMesh4);
				},10000);
				obj2Completed();
			}
		});

		targetBody5.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target5
			if (targetBody5 && (e.contact.bi.id == targetBody5.id || e.contact.bj.id == targetBody5.id)) {
				var arrowRepulseVelocity = 20;
				var impactDir = new THREE.Vector3();
				//For simplicity I consider the position of the player to calculate the direction of the impact (should be near the arrow impact direction)
				impactDir.subVectors( targetBody5.position, cubeBody.position,);
				impactDir.normalize();
				if(activatePresPlate0Tween)
					activatePresPlate0Tween.stop();
				if(deactivatePresPlate0Tween)
					deactivatePresPlate0Tween.stop();
				targetBody5.velocity.x = arrowRepulseVelocity * impactDir.x;
				targetBody5.velocity.z = arrowRepulseVelocity * impactDir.z;
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target5hit=true;
				targetBody5.mass=100;
				targetBody5.updateMassProperties();
				setTimeout(function() {
					scene.remove(targetModelParent5);
					world.removeBody(targetBody5);
					scene.remove(targetMesh5);
				},10000);
				obj4Completed();
			}
		});

		//Orbit locking and unlocking listeners
		orbit.addEventListener('lock', function() {gameUnlocked=false; pause_bg.style.display = 'none'; pause_fg.style.display = 'none';});
		orbit.addEventListener('unlock', function() {lastUnlockTime = performance.now(); gameUnlocked=true; pause_fg.style.display = ''; pause_bg.style.display = '';});


		//Using time utility to get time deltas and currentTime
		const time = new THREE.Clock();
		var deltaTime = 0;
		var elapsedTime = 0;

		//Animate function called for every frame
		function animate() {
			deltaTime = time.getDelta();
			//GameUnlocked tells wether game must be blocked or resumed
			if(gameUnlocked == false){
				elapsedTime = time.getElapsedTime() * 1000;

				//Updating functions for every library
				TWEEN.update();
				world.step(1/60,deltaTime,10);
				orbit.update(deltaTime);

				//Updating functions for every element of the game
				playerAnimate(deltaTime);
				enemiesAnimate(deltaTime);
				obsPlatAnimate();
				cannonAnimate();
				cannonShootArcher();
				level4Animate();
				holoProjAnimate();
				robotHoloAnimate();
				terminalsAnimate();
				presPlatesAnimate();

				//Now there are copy functions following, that make the bodies, the meshes and the models be in the same positions

				if(groundMesh && groundPlatModelParent){
					groundMesh.position.copy(groundBody.position);
					groundMesh.quaternion.copy(groundBody.quaternion);
					groundPlatModelParent.position.copy(groundBody.position);
					groundPlatModelParent.quaternion.copy(groundBody.quaternion);
					groundPlatModelParent.rotation.y-=Math.PI/6;
				}

				if(cubeMesh){
					cubeMesh.position.copy(cubeBody.position);
					//CubeMesh copies the cubeBody rotation because threejs offers the rotateTowards function to rotate gradually during movement
					cubeBody.quaternion.copy(cubeMesh.quaternion);
				}

				if(cubeBody && archerModelParent){
					archerModelParent.position.copy(cubeBody.position);
					archerModelParent.quaternion.copy(cubeBody.quaternion);
				}

				if(cannonBody && cannonModelParent){
					cannonModelParent.position.copy(cannonBody.position);
					cannonModelParent.quaternion.copy(cannonMesh.quaternion);
					cannonMesh.position.copy(cannonBody.position);
					cannonBody.quaternion.copy(cannonMesh.quaternion);
				}

				if(targetBody1 && targetModelParent1 && targetMesh1){
					targetModelParent1.position.copy(targetBody1.position);
					targetModelParent1.quaternion.copy(targetBody1.quaternion);
					targetMesh1.quaternion.copy(targetBody1.quaternion);
					targetMesh1.position.copy(targetBody1.position);
				}
				if(targetBody2 && targetModelParent2 && targetMesh2){
					targetModelParent2.position.copy(targetBody2.position);
					targetModelParent2.quaternion.copy(targetBody2.quaternion);
					targetMesh2.quaternion.copy(targetBody2.quaternion);
					targetMesh2.position.copy(targetBody2.position);
				}
				if(targetBody3 && targetModelParent3 && targetMesh3){
					targetModelParent3.position.copy(targetBody3.position);
					targetModelParent3.quaternion.copy(targetBody3.quaternion);
					targetMesh3.quaternion.copy(targetBody3.quaternion);
					targetMesh3.position.copy(targetBody3.position);
				}		
				if(targetBody4 && targetModelParent4 && targetMesh4){
					targetModelParent4.position.copy(targetBody4.position);
					targetModelParent4.quaternion.copy(targetBody4.quaternion);
					targetMesh4.quaternion.copy(targetBody4.quaternion);
					targetMesh4.position.copy(targetBody4.position);
				}

				if(targetBody5 && targetModelParent5 && targetMesh5){
					targetModelParent5.position.copy(targetBody5.position);
					targetModelParent5.quaternion.copy(targetBody5.quaternion);
					targetMesh5.quaternion.copy(targetBody5.quaternion);
					targetMesh5.position.copy(targetBody5.position);
				}

				if(level2PlatformBody && level2PlatformMesh && level2PlatformModelParent){
					level2PlatformMesh.position.copy(level2PlatformBody.position);
					level2PlatformMesh.quaternion.copy(level2PlatformBody.quaternion);
					level2PlatformModelParent.position.copy(level2PlatformBody.position);
					level2PlatformModelParent.quaternion.copy(level2PlatformBody.quaternion);
					level2PlatformModelParent.rotation.y-=Math.PI/6;
				}

				if(level3PlatformBody && level3PlatformMesh && level3PlatformModelParent){
					level3PlatformMesh.position.copy(level3PlatformBody.position);
					level3PlatformMesh.quaternion.copy(level3PlatformBody.quaternion);
					level3PlatformModelParent.position.copy(level3PlatformBody.position);
					level3PlatformModelParent.quaternion.copy(level3PlatformBody.quaternion);
					level3PlatformModelParent.rotation.y-=Math.PI/6;
				}

				if(level5PlatformBody && level5PlatformMesh && level5PlatformModelParent){
					level5PlatformMesh.position.copy(level5PlatformBody.position);
					level5PlatformMesh.quaternion.copy(level5PlatformBody.quaternion);
					level5PlatformModelParent.position.copy(level5PlatformBody.position);
					level5PlatformModelParent.quaternion.copy(level5PlatformBody.quaternion);
					level5PlatformModelParent.rotation.y-=Math.PI/6;
				}

				if(level6PlatformBody && level6PlatformMesh && level6PlatformModelParent){
					level6PlatformMesh.position.copy(level6PlatformBody.position);
					level6PlatformMesh.quaternion.copy(level6PlatformBody.quaternion);
					level6PlatformModelParent.position.copy(level6PlatformBody.position);
					level6PlatformModelParent.quaternion.copy(level6PlatformBody.quaternion);
					level6PlatformModelParent.rotation.y-=Math.PI/6;
				}

				if(cubeWeightBody && cubeWeightMesh && cubeWeightModelParent){
					cubeWeightMesh.position.copy(cubeWeightBody.position);
					cubeWeightMesh.quaternion.copy(cubeWeightBody.quaternion);
					cubeWeightModelParent.position.copy(cubeWeightBody.position);
					cubeWeightModelParent.quaternion.copy(cubeWeightBody.quaternion);
				}

				arrows.forEach(element => {
					element["mesh"].position.copy(element["can"].position);
					element["model"].position.copy(element["can"].position);
					element["can"].quaternion.copy(element["model"].quaternion);
					element["mesh"].quaternion.copy(element["model"].quaternion);

					//Check if the arrow is falling down, if it is then delete it
					if(element["can"].position.y < -5){
							scene.remove(element["model"]);
							//Can't remove it immediately from the CANNON world, otherwise error
							setTimeout(function() {
								world.removeBody(element["can"]);
							},0);
							scene.remove(element["mesh"]);
							arrows = arrows.filter(function(ele){ 
								return ele != element; 
							});
						}
				});

				bombs.forEach(element => {
					element["mesh"].position.copy(element["can"].position);
					element["model"].position.copy(element["can"].position);
					element["can"].quaternion.copy(element["model"].quaternion);
					element["mesh"].quaternion.copy(element["model"].quaternion);

					//Check if the bomb is falling down, if it is then delete it
					if(element["can"].position.y < -5){
							scene.remove(element["model"]);
							//Can't remove it immediately from the CANNON world, otherwise error
							setTimeout(function() {
								world.removeBody(element["can"]);
							},0);
							scene.remove(element["mesh"]);
							bombs = bombs.filter(function(ele){ 
								return ele != element; 
							});
						}
				});

				obsPlat.forEach(element => {
					element["mesh"].position.copy(element["body"].position);
					element["mesh"].quaternion.copy(element["body"].quaternion);
					element["model"].position.copy(element["body"].position);
					element["model"].quaternion.copy(element["body"].quaternion);

					//Check if the floating platform is falling down, if it is then delete it
					if(element["body"].position.y < -20){
						scene.remove(element["model"]);
						//Can't remove it immediately from the CANNON world, otherwise error
						setTimeout(function() {
							world.removeBody(element["body"]);
						},0);
						scene.remove(element["mesh"]);
					}
				});

				robots.forEach(element => {
					element["mesh"].position.copy(element["body"].position);
					element["body"].quaternion.copy(element["mesh"].quaternion);
					element["model"].position.copy(element["body"].position);
					element["model"].quaternion.copy(element["body"].quaternion);
				});

				//Make the skyboxModel rotate to make the clouds move
				if(getParameterClouds == "1" && skyboxModel){
					skyboxModel.rotation.y -= (deltaTime * 1000 * 0.00001);
				}
			}

			renderer.render( scene, camera );

			requestAnimationFrame(animate);
		};

		//Make the archer able to interact with the hologram projectors
		function holoProjAnimate(){
			if(!cubeBody)return;
			var activated = false;
			holoProjs.forEach(element => {
				var distance = new THREE.Vector3();
				distance.subVectors( cubeBody.position, element["body"].position );
				//Archer can interact only if it is sufficiently near
				if(distance.dot(distance) < 30){
					activated=true;
					isNearHoloProj = true;
					nearHoloProj = element;
					interactionPrompt.style.display = "";
				}
			});
			if(!activated){
				isNearHoloProj = false;
				if(!isNearTerminal)
					interactionPrompt.style.display = "none";
			}
		}

		//Make the archer able to interact with the pressure plates
		function presPlatesAnimate(){
			if(!cubeBody)return;
			//Better to see if archer or cubeWeight is in the same position (within a certain threshold) of the pressure plate than using the collision listener, since there could be multiple collision and the cubeWeight could be not fully on the pressure plate
			presPlates.forEach(element => {
				if((Math.abs(cubeBody.position.x - element["body"].position.x)<1 && Math.abs(cubeBody.position.z - element["body"].position.z)<1 && Math.abs(cubeBody.position.y - element["body"].position.y)<2)
				|| (Math.abs(cubeWeightBody.position.x - element["body"].position.x)<1 && Math.abs(cubeWeightBody.position.z - element["body"].position.z)<1 && Math.abs(cubeWeightBody.position.y - element["body"].position.y)<2)){
					if(element["triggered"]==false){
						if(getParameterSoundEf = "1")element["presPlateAudio"].play();
						element["activation"]();
					}
				}
				else{
					if(element["triggered"]==true){
						if(getParameterSoundEf = "1")element["presPlateAudio"].play();
						element["deactivation"]();
					}
				}
			});
		}

		//Make the archer able to interact with the terminals
		function terminalsAnimate(){
			if(!cubeBody)return;
			var activated = false;
			terminals.forEach(element => {
				var distance = new THREE.Vector3();
				distance.subVectors( cubeBody.position, element["body"].position );
				//Archer can interact only if it is sufficiently near
				if(distance.dot(distance) < 30 && element["triggered"]==false){
					activated=true;
					isNearTerminal = true;
					nearTerminal = element;
					interactionPrompt.style.display = "";
				}
			});
			if(!activated){
				isNearTerminal = false;
				if(!isNearHoloProj)
					interactionPrompt.style.display = "none";
			}
		}

		//Make the robot hologram rotate towards the archer
		function robotHoloAnimate(){
			var desAngle = Math.atan2(
						(robotHoloModel.position.x - cubeBody.position.x),
						(robotHoloModel.position.z - cubeBody.position.z));
		
			//Desired final direction, that has to be reached slowly (using rotateTowards)
			robotHoloModel.quaternion.rotateTowards((new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(0,1,0), desAngle - Math.PI/1.5), 0.2);
		}

		//Animate the cannon, make it rotate towards the player (while moving and shooting)
		function cannonAnimate(){
			var desAngle = Math.atan2(
						(cannonBody.position.x - cubeBody.position.x),
						(cannonBody.position.z - cubeBody.position.z));
		
			//Desired final direction, that has to be reached slowly (using rotateTowards)
			cannonMesh.quaternion.rotateTowards((new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(0,1,0), desAngle + Math.PI/2), 0.2);
		}

		//Set elements of archer useful for animations
		function populateArcherStructure(){
			archerStructure["hips"] = archerModel.getObjectByName("Hips_66")
			archerStructure["spine"] = archerModel.getObjectByName("Spine_55")
			archerStructure["spine1"] = archerModel.getObjectByName("Spine1_54")
			archerStructure["spine2"] = archerModel.getObjectByName("Spine2_53")
			archerStructure["neck"] = archerModel.getObjectByName("Neck_4")
			archerStructure["head"] = archerModel.getObjectByName("Head_3")
			archerStructure["rightEye"] = archerModel.getObjectByName("RightEye_0")
			archerStructure["leftEye"] = archerModel.getObjectByName("LeftEye_1")
			archerStructure["headTop_End"] = archerModel.getObjectByName("HeadTop_End_2")
			archerStructure["leftShoulder"] = archerModel.getObjectByName("LeftShoulder_28")
			archerStructure["leftArm"] = archerModel.getObjectByName("LeftArm_27")
			archerStructure["leftForeArm"] = archerModel.getObjectByName("LeftForeArm_26")
			archerStructure["leftHand"] = archerModel.getObjectByName("LeftHand_25")
			archerStructure["leftHandThumb1"] = archerModel.getObjectByName("LeftHandThumb1_8")
			archerStructure["leftHandThumb2"] = archerModel.getObjectByName("LeftHandThumb2_7")
			archerStructure["leftHandThumb3"] = archerModel.getObjectByName("LeftHandThumb3_6")
			archerStructure["leftHandThumb4"] = archerModel.getObjectByName("LeftHandThumb4_5")
			archerStructure["leftHandIndex1"] = archerModel.getObjectByName("LeftHandIndex1_12")
			archerStructure["leftHandIndex2"] = archerModel.getObjectByName("LeftHandIndex2_11")
			archerStructure["leftHandIndex3"] = archerModel.getObjectByName("LeftHandIndex3_10")
			archerStructure["leftHandIndex4"] = archerModel.getObjectByName("LeftHandIndex4_9")
			archerStructure["leftHandMiddle1"] = archerModel.getObjectByName("LeftHandMiddle1_16")
			archerStructure["leftHandMiddle2"] = archerModel.getObjectByName("LeftHandMiddle2_15")
			archerStructure["leftHandMiddle3"] = archerModel.getObjectByName("LeftHandMiddle3_14")
			archerStructure["leftHandMiddle4"] = archerModel.getObjectByName("LeftHandMiddle4_13")
			archerStructure["leftHandRing1"] = archerModel.getObjectByName("LeftHandRing1_20")
			archerStructure["leftHandRing2"] = archerModel.getObjectByName("LeftHandRing2_19")
			archerStructure["leftHandRing3"] = archerModel.getObjectByName("LeftHandRing3_18")
			archerStructure["leftHandRing4"] = archerModel.getObjectByName("LeftHandRing4_17")
			archerStructure["leftHandPinky1"] = archerModel.getObjectByName("LeftHandPinky1_24")
			archerStructure["leftHandPinky2"] = archerModel.getObjectByName("LeftHandPinky2_23")
			archerStructure["leftHandPinky3"] = archerModel.getObjectByName("LeftHandPinky3_22")
			archerStructure["leftHandPinky4"] = archerModel.getObjectByName("LeftHandPinky4_21")
			archerStructure["rightShoulder"] = archerModel.getObjectByName("RightShoulder_52")
			archerStructure["rightArm"] = archerModel.getObjectByName("RightArm_51")
			archerStructure["rightForeArm"] = archerModel.getObjectByName("RightForeArm_50")
			archerStructure["rightHand"] = archerModel.getObjectByName("RightHand_49")
			archerStructure["rightHandPinky1"] = archerModel.getObjectByName("RightHandPinky1_32")
			archerStructure["rightHandPinky2"] = archerModel.getObjectByName("RightHandPinky2_31")
			archerStructure["rightHandPinky3"] = archerModel.getObjectByName("RightHandPinky3_30")
			archerStructure["rightHandPinky4"] = archerModel.getObjectByName("RightHandPinky4_29")
			archerStructure["rightHandRing1"] = archerModel.getObjectByName("RightHandRing1_36")
			archerStructure["rightHandRing2"] = archerModel.getObjectByName("RightHandRing2_35")
			archerStructure["rightHandRing3"] = archerModel.getObjectByName("RightHandRing3_34")
			archerStructure["rightHandRing4"] = archerModel.getObjectByName("RightHandRing4_33")
			archerStructure["rightHandMiddle1"] = archerModel.getObjectByName("RightHandMiddle1_40")
			archerStructure["rightHandMiddle2"] = archerModel.getObjectByName("RightHandMiddle2_39")
			archerStructure["rightHandMiddle3"] = archerModel.getObjectByName("RightHandMiddle3_38")
			archerStructure["rightHandMiddle4"] = archerModel.getObjectByName("RightHandMiddle4_37")
			archerStructure["rightHandIndex1"] = archerModel.getObjectByName("RightHandIndex1_44")
			archerStructure["rightHandIndex2"] = archerModel.getObjectByName("RightHandIndex2_43")
			archerStructure["rightHandIndex3"] = archerModel.getObjectByName("RightHandIndex3_42")
			archerStructure["rightHandIndex4"] = archerModel.getObjectByName("RightHandIndex4_41")
			archerStructure["rightHandThumb1"] = archerModel.getObjectByName("RightHandThumb1_48")
			archerStructure["rightHandThumb2"] = archerModel.getObjectByName("RightHandThumb2_47")
			archerStructure["rightHandThumb3"] = archerModel.getObjectByName("RightHandThumb3_46")
			archerStructure["rightHandThumb4"] = archerModel.getObjectByName("RightHandThumb4_45")
			archerStructure["leftUpLeg"] = archerModel.getObjectByName("LeftUpLeg_60")
			archerStructure["leftLeg"] = archerModel.getObjectByName("LeftLeg_59")
			archerStructure["leftFoot"] = archerModel.getObjectByName("LeftFoot_58")
			archerStructure["leftToeBase"] = archerModel.getObjectByName("LeftToeBase_57")
			archerStructure["leftToe_End"] = archerModel.getObjectByName("LeftToe_End_56")
			archerStructure["rightUpLeg"] = archerModel.getObjectByName("RightUpLeg_65")
			archerStructure["rightLeg"] = archerModel.getObjectByName("RightLeg_64")
			archerStructure["rightFoot"] = archerModel.getObjectByName("RightFoot_63")
			archerStructure["rightToeBase"] = archerModel.getObjectByName("RightToeBase_62")
			archerStructure["rightToe_End"] = archerModel.getObjectByName("RightToe_End_61")
		};

		//Set elements of robots (enemies) useful for animations
		function populateRobotStructure(genRobotModel){
			var struct = {};
			struct["rootJoint"] = genRobotModel.getObjectByName("GLTF_created_0_rootJoint")
			struct["bone"] = genRobotModel.getObjectByName("Bone_74")
			struct["footL"] = genRobotModel.getObjectByName("FootL_2")
			struct["body"] = genRobotModel.getObjectByName("Body_66")
			struct["upperLegL"] = genRobotModel.getObjectByName("UpperLegL_7")
			struct["lowerLegL"] = genRobotModel.getObjectByName("LowerLegL_5")
			struct["upperLegR"] = genRobotModel.getObjectByName("UpperLegR_12")
			struct["lowerLegR"] = genRobotModel.getObjectByName("LowerLegR_10")
			struct["hips"] = genRobotModel.getObjectByName("Hips_62")
			struct["abdomen"] = genRobotModel.getObjectByName("Abdomen_61")
			struct["torso"] = genRobotModel.getObjectByName("Torso_1_60")
			struct["neck"] = genRobotModel.getObjectByName("Neck_19")
			struct["head"] = genRobotModel.getObjectByName("Head_1_18")
			struct["shoulderR"] = genRobotModel.getObjectByName("ShoulderR_59")
			struct["upperArmR"] = genRobotModel.getObjectByName("UpperArmR_57")
			struct["lowerArmR"] = genRobotModel.getObjectByName("LowerArmR_55")
			struct["thumbR"] = genRobotModel.getObjectByName("ThumbR_46")
			struct["thumb2R"] = genRobotModel.getObjectByName("Thumb2R_45")
			struct["palm2R"] = genRobotModel.getObjectByName("Palm2R_43")
			struct["middle1R"] = genRobotModel.getObjectByName("Middle1R_42")
			struct["middle2R"] = genRobotModel.getObjectByName("Middle2R_41")
			struct["palm1R"] = genRobotModel.getObjectByName("Palm1R_50")
			struct["indexR"] = genRobotModel.getObjectByName("IndexR_49")
			struct["index2R"] = genRobotModel.getObjectByName("Index2R_48")
			struct["palm3R"] = genRobotModel.getObjectByName("Palm3R_54")
			struct["ring1R"] = genRobotModel.getObjectByName("Ring1R_53")
			struct["ring2R"] = genRobotModel.getObjectByName("Ring2R_52")
			struct["shoulderL"] = genRobotModel.getObjectByName("ShoulderL_39")
			struct["upperArmL"] = genRobotModel.getObjectByName("UpperArmL_37")
			struct["lowerArmL"] = genRobotModel.getObjectByName("LowerArmL_35")
			struct["palm2L"] = genRobotModel.getObjectByName("Palm2L_23")
			struct["middle1L"] = genRobotModel.getObjectByName("Middle1L_22")
			struct["middle2L"] = genRobotModel.getObjectByName("Middle2L_21")
			struct["thumbL"] = genRobotModel.getObjectByName("ThumbL_26")
			struct["thumb2L"] = genRobotModel.getObjectByName("Thumb2L_25")
			struct["palm1L"] = genRobotModel.getObjectByName("Palm1L_30")
			struct["indexL"] = genRobotModel.getObjectByName("IndexL_29")
			struct["index2L"] = genRobotModel.getObjectByName("Index2L_28")
			struct["palm3L"] = genRobotModel.getObjectByName("Palm3L_34")
			struct["ring1L"] = genRobotModel.getObjectByName("Ring1L_33")
			struct["ring2L"] = genRobotModel.getObjectByName("Ring2L_32")
			struct["poleTargetL"] = genRobotModel.getObjectByName("PoleTargetL_68")
			struct["footR"] = genRobotModel.getObjectByName("FootR_71")
			struct["poleTargetR"] = genRobotModel.getObjectByName("PoleTargetR_73")
			return struct;
		}		
		//Set the correct player animation
		function changePlayerState(){
			//Only if player state changed continue
			if(lastExecutedAnimation == playerState) return;
			lastExecutedAnimation = playerState;
			
			//Stop all the animations to avoid overlapping (stopping an already stopped animation gives no error)
			idle.stop();
			idleB.stop();
			walkA.stop();
			walkB.stop();		
			walkC.stop();
			walkD.stop();
			runA.stop();
			runB.stop();
			runC.stop();
			runD.stop();
			jumpA.stop();
			jumpB.stop();

			//Stop all the sounds emitted from the player to avoid overlapping
			if(playerWalkAudio.isPlaying)
				playerWalkAudio.stop();
			if(playerRunAudio.isPlaying)
				playerRunAudio.stop();

			//Start the correct animation based on the player current state
			switch(playerState){
				case "Idle":
					idle.start();
					break;
				case "Walk":
					walkA.start();
					if(getParameterSoundEf == "1")
						playerWalkAudio.play();
					break;
				case "Run":
					runA.start();
					if(getParameterSoundEf == "1")
						playerRunAudio.play();
					break;
				case "Jump":
					jumpA.start();
					break;
				default:
					break;
			}
		}

	
		//Function that animates the floating platform (different platform requires different animations)
		function obsPlatAnimate(){
			//ObsPlat1
			var xMax = 15;
			var xMin = -15;
			if(obsPlat[0]["body"].position.x >= xMax && obsPlat[0]["phase"]){
				backObsPlat1 = new TWEEN.Tween({"xVelocity" : obsPlat[0]["velocityMax"]}).to({"xVelocity" : -obsPlat[0]["velocityMax"]},1500).onUpdate((object)=>{
					obsPlat[0]["body"].velocity.x = object["xVelocity"];
				}).onComplete(()=>{
					obsPlat[0]["phase"]=false
					obsPlat[0]["animating"]=false;
				}).onStart(()=>{
					obsPlat[0]["animating"]=true;
				})
				backObsPlat1.start();
			}
			else if (obsPlat[0]["body"].position.x <= xMin && !obsPlat[0]["phase"]){
				fwdObsPlat1 = new TWEEN.Tween({"xVelocity" : -obsPlat[0]["velocityMax"]}).to({"xVelocity" : obsPlat[0]["velocityMax"]},1500).onUpdate((object)=>{
					obsPlat[0]["body"].velocity.x = object["xVelocity"];
				}).onComplete(()=>{
					obsPlat[0]["phase"]=true;
					obsPlat[0]["animating"]=false;
				}).onStart(()=>{
					obsPlat[0]["animating"]=true;
				});
				fwdObsPlat1.start();
			}
			else if(!obsPlat[0]["animating"]){
				if(obsPlat[0]["phase"]){
					obsPlat[0]["body"].velocity.x = obsPlat[0]["velocityMax"];
				}
				else {
					obsPlat[0]["body"].velocity.x = -obsPlat[0]["velocityMax"];
				}
			}
			//ObsPlat2
			var xMax = 15;
			var xMin = -15;
			if(obsPlat[1]["body"].position.x >= xMax && obsPlat[1]["phase"]){
				backObsPlat2 = new TWEEN.Tween({xVelocity : obsPlat[1]["velocityMax"]}).to({xVelocity : -obsPlat[1]["velocityMax"]},1500).onUpdate((object)=>{
					obsPlat[1]["body"].velocity.x = object["xVelocity"];
				}).onComplete(()=>{
					obsPlat[1]["phase"]=false
					obsPlat[1]["animating"]=false;;
				}).onStart(()=>{
					obsPlat[1]["animating"]=true;
				});
				backObsPlat2.start();
			}
			else if (obsPlat[1]["body"].position.x <= xMin && !obsPlat[1]["phase"]){
				fwdObsPlat2 = new TWEEN.Tween({xVelocity : -obsPlat[1]["velocityMax"]}).to({xVelocity : obsPlat[1]["velocityMax"]},1500).onUpdate((object)=>{
					obsPlat[1]["body"].velocity.x = object["xVelocity"];
				}).onComplete(()=>{
					obsPlat[1]["phase"]=true;
					obsPlat[1]["animating"]=false;
				}).onStart(()=>{
					obsPlat[1]["animating"]=true;
				});
				fwdObsPlat2.start();
			}
			else if(!obsPlat[1]["animating"]){
				if(obsPlat[1]["phase"]){
					obsPlat[1]["body"].velocity.x = obsPlat[1]["velocityMax"];
				}
				else {
					obsPlat[1]["body"].velocity.x = -obsPlat[1]["velocityMax"];
				}
			}

			//ObsPlat3
			var zMax = 68;
			var zMin = 60;
			if(obsPlat[2]["body"].position.z >= zMax && obsPlat[2]["phase"]){
				backObsPlat3 = new TWEEN.Tween({zVelocity : obsPlat[2]["velocityMax"]}).to({zVelocity : -obsPlat[2]["velocityMax"]},1500).onUpdate((object)=>{
					obsPlat[2]["body"].velocity.z = object["zVelocity"];
				}).onComplete(()=>{
					obsPlat[2]["phase"]=false
					obsPlat[2]["animating"]=false;;
				}).onStart(()=>{
					obsPlat[2]["animating"]=true;
				});
				backObsPlat3.start();
			}
			else if (obsPlat[2]["body"].position.z <= zMin && !obsPlat[2]["phase"]){
				fwdObsPlat3 = new TWEEN.Tween({zVelocity : -obsPlat[2]["velocityMax"]}).to({zVelocity : obsPlat[2]["velocityMax"]},1500).onUpdate((object)=>{
					obsPlat[2]["body"].velocity.z = object["zVelocity"];
				}).onComplete(()=>{
					obsPlat[2]["phase"]=true;
					obsPlat[2]["animating"]=false;
				}).onStart(()=>{
					obsPlat[2]["animating"]=true;
				});
				fwdObsPlat3.start();
			}
			else if(!obsPlat[2]["animating"]){
				if(obsPlat[2]["phase"]){
					obsPlat[2]["body"].velocity.z = obsPlat[2]["velocityMax"];
				}
				else {
					obsPlat[2]["body"].velocity.z = -obsPlat[2]["velocityMax"];
				}
			}
		}

		//Functions that applies the updates to the player and the camera through each frame (animation, movement, etc.)
		function playerAnimate(delta){
			if(pressed["SPACE"] && playerState!="Jump"){
				playerState = "Jump";
				cubeBody.velocity.y = 15;
				return;
			}
			else if(pressed["SHIFT"] && playerState!="Jump")
				playerState = "Run";
			else if(playerState!="Jump")
				playerState = "Walk";
			
			if(pressed["F"] && canShoot){
				canShoot=false;
				shoot();
			}

			var moving = false;

			if(pressed["W"] && pressed["A"]){
				relDir = Math.PI/4;
				moving=true;
			}
			else if(pressed["W"] && pressed["D"]){
				relDir = -Math.PI/4;
				moving=true;
			}
			else if(pressed["S"] && pressed["A"]){
				relDir = 3*Math.PI/4;
				moving=true;
			}
			else if(pressed["S"] && pressed["D"]){
				relDir = -3*Math.PI/4;
				moving=true;
			}
			else if(pressed["W"]){
				relDir = 0;
				moving=true;
			}
			else if(pressed["A"]){
				relDir = Math.PI/2;
				moving=true;
			}
			else if(pressed["S"]){
				relDir = Math.PI;
				moving=true;
			}
			else if(pressed["D"]){
				relDir = -Math.PI/2;
				moving=true;
			}
			else  if(playerState!="Jump") {
				playerState = "Idle";
			}

			//Camera angle with respect to player (obtained through x and z displacements)
			cameraAngle = Math.atan2(
				(camera.position.x - cubeBody.position.x),
				(camera.position.z - cubeBody.position.z));

			//Desired final direction, that has to be reached slowly (using rotateTowards)
			desQuat = (new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(0,1,0), cameraAngle + relDir);
			cubeMesh.quaternion.rotateTowards(desQuat, 0.2);

			if(moving == true){
				//Obtain the world direction of the camera
				var cameraDirection= new THREE.Vector3();
				camera.getWorldDirection(cameraDirection);

				//Vertical direction not useful for movement, player can't fly
				cameraDirection.y = 0;
				cameraDirection.normalize();
				cameraDirection.applyAxisAngle(new THREE.Vector3(0,1,0), relDir);
				var moveX = cameraDirection.x * (playerState == 'Run' ? 15 : 8) * delta;
				var moveZ = cameraDirection.z * (playerState == 'Run' ? 15 : 8) * delta;

				cubeBody.position.x += moveX;
				cubeBody.position.z += moveZ;
			}
			//To make the camera move effectively only if the player moves (not if he encounters obstacles)
			camera.position.x += cubeBody.position.x - oldx;
			camera.position.z += cubeBody.position.z - oldz;

			//Update camera target
			cameraTarget.x += cubeBody.position.x -oldx;
			//Update y easing only if "standing on a platform at different height
			if(playerState!="Jump" && oldy<cubeBody.position.y-0.1 || oldy>cubeBody.position.y+0.1){
				oldy = cubeBody.position.y;
				cameraMoveY();
			}
			cameraTarget.z += cubeBody.position.z - oldz;
			orbit.target = cameraTarget;


			oldx =cubeBody.position.x;
			oldz =cubeBody.position.z;

		//If player falling down reload the page
		if(cubeBody.position.y < -5){
				gameOver();
			}

		//Function that plays the correct animation and sound
		changePlayerState();
		};

		//Function managing the behaviour of the robot enemies
		function enemiesAnimate(deltaTime){
			robots.forEach(enemy => {				
				var enemyPosition = enemy.body.position;
				var archerPos = cubeBody.position;
				var distance = new THREE.Vector3();
				
				distance.subVectors( archerPos, enemyPosition );

				//Approximated distance vector
				if(distance.dot(distance) <  150  && enemy["active"]){
					
					if(enemy.state != "RUNNING"){
						enemy.tweens.idleA.stop();
						enemy.tweens.idleB.stop();
						enemy.tweens.runA.start();
						enemy.state = "RUNNING";
					}

					//Rotating and making the enemy run to the player
					var enemyDir = distance.normalize();
					var desAngle = Math.atan2(
						(enemyPosition.x - archerPos.x),
						(enemyPosition.z - archerPos.z));
		
					//Desired final direction, that has to be reached slowly (using rotateTowards)
					enemy.mesh.quaternion.rotateTowards((new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(0,1,0), desAngle), 0.2);
					var enemyVelocity = 4;
					enemy.body.velocity.x = enemyVelocity * enemyDir.x * deltaTime*100;
					enemy.body.velocity.z = enemyVelocity * enemyDir.z * deltaTime*100;
				}
				else{
						enemy.tweens.runA.stop();
						enemy.tweens.runB.stop();
						enemy.tweens.idleA.start();
						enemy.state = "IDLE";
					}

			//Check if the enemy is falling down, if it is then remove it
			if(enemyPosition.y < -5){
					scene.remove(enemy["model"]);
					setTimeout(function() {
						world.removeBody(enemy["body"]);
					},0);
					scene.remove(enemy["mesh"]);
					robots = robots.filter(function(ele){ 
						return ele != enemy; 
					});
				}
			});
		}
		
		//When there is at least a specific displacement then move the camera with animation
		function cameraMoveY(){
			var moveYTween= new TWEEN.Tween({y : cameraTarget.y}).to({y : cubeBody.position.y + 2}, 800).onUpdate((object)=>{cameraTarget.y= object.y;});
			moveYTween.easing(TWEEN.Easing.Quadratic.InOut);
			moveYTween.start();
		}

		//Function to call when the player obtains game over (e.g. he falls down)
		function gameOver(){
			document.getElementById("gameover_prompt").style.display="";
			setTimeout(()=>{
					location.reload();
				},2000);
		}

		requestAnimationFrame(animate);

		//Function to obtain a GET parameter with a specific name
		function findGetParameter(parameterName) {
			var result = null,
				tmp = [];
			location.search
				.substr(1)
				.split("&")
				.forEach(function (item) {
				tmp = item.split("=");
				if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
				});
			return result;
		}
		</script>
	</body>
</html>