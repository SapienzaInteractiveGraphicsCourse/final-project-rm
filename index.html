<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>My first three.js app</title>
		<style>
			body { margin: 0;
				background: #000;
				font-family: Helvetica, sans-serif; }
			
			.example {
			float: left;
			margin: 10px;
			}
			.inp {
			background: rgba(0,127,128,0.68);
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
			border: 1px solid rgba(128,255,255,0.25);
			color: rgba(255,255,255,0.75);
			text-shadow: 0 0 10px rgba(0,255,255,0.95);
			font-size: 30px;
			padding: 10px 30px;
			text-shadow: 0 0 10px rgba(0,255,255,0.5);
			outline: none;
			}
			.inp:hover {
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			border: 1px solid rgba(128,255,255,0.75);
			}
			.inp:focus {
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			border: 1px solid rgba(128,255,255,0.75);
			}
			.inp-secondary {
			background-color: transparent;
			color: rgba(0,127,128,0.8);
			text-shadow: 0 0 12px rgba(0,255,255,0.3);
			/* text-shadow: none; */
			border: 1px solid rgba(128,255,255,0.5);
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.25);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.25);
			}
			.btn {
			background: rgba(0,127,128,0.68);
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
			border: 1px solid rgba(128,255,255,0.25);
			color: rgba(255,255,255,0.75);
			text-shadow: 0 0 10px rgba(0,255,255,0.95);
			font-size: 30px;
			padding: 10px 30px;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
			outline: none;
			}
			.btn:hover {
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			border: 1px solid rgba(128,255,255,0.75);
			}
			.btn-primary:active {
			background: rgba(0,127,128,0.9);
			}
			.btn-secondary {
			background-color: transparent;
			color: rgba(0,127,128,0.8);
			text-shadow: 0 0 12px rgba(0,255,255,0.3);
			/* text-shadow: none; */
			border: 1px solid rgba(128,255,255,0.5);
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.25);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.25);
			}
			.btn-secondary:active {
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			}
			.element {
			position: relative;
			width: 120px;
			height: 160px;
			color: #fff;
			text-align: center;
			background: rgba(0,127,128,0.68);
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.5);
			border: 1px solid rgba(128,255,255,0.25);
			cursor: default;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
			}
			.element:hover {
			-webkit-box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			box-shadow: 0px 0px 12px rgba(0,255,255,0.75);
			border: 1px solid rgba(128,255,255,0.75);
			}
			.element .number {
			font-size: 12px;
			color: rgba(128,255,255,0.75);
			position: absolute;
			top: 20px;
			right: 20px;
			}
			.element .symbol {
			color: rgba(255,255,255,0.75);
			text-shadow: 0 0 10px rgba(0,255,255,0.95);
			position: absolute;
			font-size: 60px;
			font-weight: bold;
			top: 40px;
			left: 0px;
			right: 0px;
			}
			.element .details {
			font-size: 12px;
			color: rgba(128,255,255,0.75);
			position: absolute;
			bottom: 15px;
			left: 0px;
			right: 0px;
			}

		</style>
	</head>
	<body>
        <!-- Remove this when import maps will be widely supported -->
		<script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>


        <!-- Needed to make the import "three" work-->
		<script type="importmap">
			{
				"imports": {
					"three": "../node_modules/three/build/three.module.js"
				}
			}
		</script>


		<!-- Initial loading bar -->
		<div id="gameLoading_bg" style="text-align:center; position: absolute; width: 100%; height: 100%; background-color: rgba(0,0,0,1);">
			<div id="gameLoading_fg" style="text-align:center; position:absolute;     width: 100em; height: auto; margin: 0 auto; padding: 10px; margin-top:20%;  position: relative; ">
				<label id="gameLoading_label" style=" font-size: 3em; color:white;" for="gameLoading_fb_bar">Loading in progress:</label><br>
				<progress  id="gameLoading_fg_bar" style="width: 100em; height: 3em;" max="100" ></progress>
			</div>
		</div>

		<!-- Pause Menu -->
		<div id="pause_bg" style = "position: absolute; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display:none;">
			<button id="pause_fg" class="btn btn-primary example" style="width: 70%; height: auto; text-align: center; cursor: pointer; margin-left:15%;  margin-top: 20%; padding: 2%; display:none;">
				<p style=" font-size: 50px; vertical-align: top;">
					<b>PAUSE</b>
				</p>
				<hr/>
				<p style="font-size:100px;">
					<b>CLICK TO RESUME</b>
				</p>
				<span style="border: 1px solid white; padding: 2%;">
					<span>
						<span>Move: </span>
						<img style="vertical-align:middle" src="img/wasd.png" width="4%">
					</span>
					|
					<span>
						<span>Jump: </span>
						<img style="vertical-align:middle" src="img/space-bar.png" width="4%">
					</span>
					|
					<span>
						<span>Look: </span>
						<img style="vertical-align:middle" src="img/mouse.png" width="4%">
					</span>
					|
					<span>
						<span>Shoot an arrow: </span>
						<img style="vertical-align:middle" src="img/f-key.png" width="4%">
					</span>
				</span>
			  </button>
				
		</div>


		<script type="module">
        import * as THREE from '../node_modules/three/build/three.module.js';
        import { OrbitControls } from '../node_modules/three/examples/jsm/controls/ModifiedOrbitControls.js';
		import * as CANNON from '../node_modules/cannon-es/dist/cannon-es.js';
		import {GLTFLoader} from '../node_modules/three/examples/jsm/loaders/GLTFLoader.js';
		import { TWEEN } from '../node_modules/three/examples/jsm/libs/tween.module.min.js'
		import { Sky } from '../node_modules/three/examples/jsm/objects/Sky.js';

		var gameLoaded = false;
		var animateScene = true;
		var relDir=0;
		var playerState = "Idle";
		var cameraTarget = new THREE.Vector3();
		var mixer;
		var archerModel, archerModelParent;
		var arrowModel, targetModel, targetModel1, targetModel2,targetModel3, targetModel4;
		var targetModelParent1, targetModelParent2, targetModelParent3, targetModelParent4;
		var archerStructure = {};
		var canShoot=true;
		var lastExecutedAnimation = "Idle";
		var idle, idleB, runA, runB, jumpA, jumpB, walkA, walkB, shootA, shootB, shootC, targetMovement1, targetMovement2, targetMovement3, targetMovement4, level2Unlock, level3Unlock1, level3Unlock2, level3Unlock3, level3Unlock4, level3Unlock5, level3Unlock6;
		var arrows =[];
		var target1hit = false, target2hit = false, target3hit=false, target4hit=false;
		var prevPlayerPosition;
		var obsPlatTweens = [];
		var obsPlat=[];
		var robots=[];
		var robotsTweens = [];
		var oldx = 0, oldz = 0, oldy = 10;
		var cameraAngle, desQuat;
		var rotatingPlatModel;
		var rotatePlatFloatingTweens =[];
		var skyboxModel, mainPlatModel, groundPlatModelParent, level2PlatformModelParent, level3PlatformModelParent;
		var pause_bg = document.getElementById("pause_bg");
		var pause_fg = document.getElementById("pause_fg");
		var justRepulsed = false;

		//CANNON AND THREE SETUP
		const world = new CANNON.World({
			gravity: new CANNON.Vec3(0, -20, 0)
		});

		const scene = new THREE.Scene();
		// scene.background = new THREE.Color( 0x00C0F0 );
		var sky = new Sky();
		sky.scale.setScalar( 450000 );
		scene.add( sky );
		var sunPosition = new THREE.Vector3();

		sky.material.uniforms[ 'turbidity' ].value =20;
		sky.material.uniforms[ 'mieCoefficient' ].value =0;
		sky.material.uniforms[ 'mieDirectionalG' ].value =1;
		sky.material.uniforms[ 'rayleigh' ].value =0.15;
		sunPosition.setFromSphericalCoords( 1, THREE.MathUtils.degToRad( 90 - 45 ), THREE.MathUtils.degToRad( 90 ) );
		sky.material.uniforms[ 'sunPosition' ].value.copy( sunPosition );

		
		const camera = new THREE.PerspectiveCamera(
			45,
			window.innerWidth / window.innerHeight,
			0.1,
			1000
			);
			
			
			const renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			renderer.shadowMap.enabled = true;
			document.body.appendChild( renderer.domElement );
			renderer.toneMappingExposure = 0.5;
			
			var orbit = new OrbitControls(camera,renderer.domElement);
			camera.position.set(0,10,-20);
			camera.quaternion.setFromAxisAngle(new CANNON.Vec3(0,1,0), Math.PI);

			var lastUnlockTime = null;

			document.body.addEventListener( 'click', function () {
				if ( !gameLoaded || (lastUnlockTime && (performance.now() - lastUnlockTime) < 1250)) {
					return
				}
				else
					orbit.lock();
			}, false );



		
		//LIGHT SETUP

		const ambLight = new THREE.AmbientLight(0xFFFFFF, 0.8);
		scene.add(ambLight);

		const dirLight = new THREE.DirectionalLight(0xFFFFFF, 10);
		dirLight.position.set(40, 40, 0);
		dirLight.target.position.set(-2, 0, 0);
		dirLight.castShadow = true; 
		dirLight.shadow.camera.left = - 200;
		dirLight.shadow.camera.right = 15;
		dirLight.shadow.camera.top = 15;
		dirLight.shadow.camera.bottom = - 15;
		dirLight.shadow.camera.far = 100;
		dirLight.shadow.bias = - 0;
		dirLight.shadow.mapSize.width = Math.pow(2,12); // default
		dirLight.shadow.mapSize.height = Math.pow(2,12); // default
		scene.add(dirLight);
		scene.add(dirLight.target);

		const helper = new THREE.CameraHelper( dirLight.shadow.camera );
		//scene.add( helper )
		//CUBE (THREE)
		const cubeGeometry = new THREE.BoxGeometry( 1.4, 3.0, 2.0 );
		const cubeMaterial = new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} );
		const cubeMesh = new THREE.Mesh( cubeGeometry, cubeMaterial );
		//scene.add( cubeMesh );
		cubeMesh.castShadow=true;
		//cubeMesh.receiveShadow=true;
		// var cubeMesh;
		const loadingManager = new THREE.LoadingManager();
		loadingManager.onLoad = () => {gameLoaded = true; document.querySelector('#gameLoading_fg').style.display = 'none'; document.querySelector('#gameLoading_bg').style.display = 'none'; pause_fg.style.display = ''; pause_bg.style.display = '';};
		loadingManager.onProgress = (url, itemsLoaded, itemsTotal) => {
			document.querySelector('#gameLoading_fg_bar').setAttribute("value",`${itemsLoaded / itemsTotal * 100 | 0}`);
		};
		const gltfLoader = new GLTFLoader(loadingManager);
		//GROUND (THREE)
		const groundGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const groundMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
			});
		const groundMesh = new THREE.Mesh(groundGeo, groundMat);
		//scene.add(groundMesh);
		groundMesh.receiveShadow=true;
		groundMesh.castshadow=true;

		//GROUND (CANNON)
		const groundPhysMat = new CANNON.Material();


		const groundBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: groundPhysMat
		});
		world.addBody(groundBody);
		groundBody.quaternion.setFromEuler(0, Math.PI/6, 0);


		gltfLoader.load("gltf/arrow/scene.gltf", (gltf) => {
			arrowModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			arrowModel.scale.setScalar( 0.02 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );
		});

		gltfLoader.load("gltf/main_plat/scene.gltf", (gltf) => {
			mainPlatModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			mainPlatModel.scale.setScalar( 4.5 );

			
			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			var groundPlatModel = mainPlatModel.clone();
			groundPlatModelParent = new THREE.Object3D();
			groundPlatModel.getWorldPosition(groundPlatModelParent.position);
			groundPlatModel.rotation.set(...[0,0,0]);
			groundPlatModelParent.add(groundPlatModel);
			scene.add(groundPlatModelParent);

			var level2PlatformModel= mainPlatModel.clone();
			level2PlatformModelParent = new THREE.Object3D();
			level2PlatformModel.getWorldPosition(level2PlatformModelParent.position);
			level2PlatformModel.rotation.set(...[0,0,0]);
			level2PlatformModelParent.add(level2PlatformModel);
			scene.add(level2PlatformModelParent);

			var level3PlatformModel = mainPlatModel.clone();
			level3PlatformModelParent = new THREE.Object3D();
			level3PlatformModel.getWorldPosition(level3PlatformModelParent.position);
			level3PlatformModel.rotation.set(...[0,0,0]);
			level3PlatformModelParent.add(level3PlatformModel);
			scene.add(level3PlatformModelParent);
		});

		gltfLoader.load("gltf/skybox/scene.gltf", (gltf) => {
			skyboxModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			skyboxModel.scale.setScalar( 1 );
			//Removing the sky (it causes issues with directional light)
			var sky= gltf.scene.getObjectByName("hoth_sky");
			sky.visible=false;
			skyboxModel.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=true;
			}
			} );
			scene.add(skyboxModel);
		});

		gltfLoader.load("gltf/floating_platform/scene.gltf", (gltf) => {
			rotatingPlatModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			rotatingPlatModel.scale.setScalar( 0.05 );

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );



			//OBSTACLES PLATFORMS (THREE)

		var positions = [new CANNON.Vec3(-15, -1, 48),
						new CANNON.Vec3(15, -1, 54),
						new CANNON.Vec3(0, -1, 75),
						new CANNON.Vec3(-20, 0, 90),
						new CANNON.Vec3(20, 0, 90),
						new CANNON.Vec3(-20, 0, 95),
						new CANNON.Vec3(20, 0, 95),
						new CANNON.Vec3(-20, 0, 100),
						new CANNON.Vec3(20, 0, 100)
					];

		
		for(var i=0; i<positions.length; i++){
			var genPlatGeo = new THREE.CylinderGeometry( 2.5, 2.5, 0.5, 8 );
			var genPlatMat = new THREE.MeshPhongMaterial({ 
				color: 0x00ff00,
				side: THREE.DoubleSide,
				wireframe: true
				});
			var genPlatMesh = new THREE.Mesh(genPlatGeo, genPlatMat);
			//scene.add(genPlatMesh);
			genPlatMesh.receiveShadow=true;
			genPlatMesh.castshadow=true;

			var genPlatModel = rotatingPlatModel.clone();
			var rotatingPlatModelParent = new THREE.Object3D();
			rotatingPlatModel.getWorldPosition(rotatingPlatModelParent.position);
			rotatingPlatModel.rotation.set(...[0,0,0]);
			rotatingPlatModelParent.add(genPlatModel);

			scene.add(rotatingPlatModelParent);

			//OBSTACLES PLATFORMS (CANNON)

			var genPlatBody = new CANNON.Body({
				shape: new CANNON.Cylinder(2.5,2.5,0.5,8),
				type: CANNON.Body.KINEMATIC,
				material: groundPhysMat,
				position: positions[i],
				linearDamping: 1,
 		    	angularDamping: 1
			});
			world.addBody(genPlatBody);
			genPlatBody.quaternion.setFromEuler(0, 0, 0);
			obsPlat.push({"mesh" : genPlatMesh, "body" : genPlatBody, "model": rotatingPlatModelParent});
		}

		obsPlat.forEach(element => {
			var helix = element["model"].getObjectByName("Helix");

			var rotateHelixTween = new TWEEN.Tween({theta:0}).to({theta:2*Math.PI}, 1000).onUpdate((object)=>{if(helix)helix.rotation.z= object.theta;});
			rotateHelixTween.repeat(Infinity);
			rotateHelixTween.start();

			var rotatePlatFloating = new TWEEN.Tween({y:element["body"].position.y}).to({y:element["body"].position.y+0.2}, 200).onUpdate((object)=>{if(element["body"])element["body"].position.y= object.y;});
			rotatePlatFloating.repeat(Infinity).yoyo(true);
			rotatePlatFloating.start();

			rotatePlatFloatingTweens.push(rotatePlatFloating);
		});
		var helix = genPlatModel.getObjectByName("Helix");

			var rotateHelixTween = new TWEEN.Tween({theta:0}).to({theta:2*Math.PI}, 1000).onUpdate((object)=>{if(helix)helix.rotation.z= object.theta;});
			rotateHelixTween.repeat(Infinity);
			rotateHelixTween.start();
		});

		gltfLoader.load("gltf/target/scene.gltf", (gltf) => {
			targetModel = gltf.scene.getObjectByName("Sketchfab_Scene");
			targetModel.scale.setScalar( 0.3 );

			
			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			targetModelParent1 = new THREE.Object3D();
			targetModelParent2 = new THREE.Object3D();
			targetModel1 = targetModel.clone();
			targetModel2 = targetModel.clone();
			targetModel1.getWorldPosition(targetModelParent1.position);
			targetModel1.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent1.add(targetModel1);
			scene.add(targetModelParent1);

			targetModel2.getWorldPosition(targetModelParent2.position);
			targetModel2.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent2.add(targetModel2);
			scene.add(targetModelParent2);

			targetModelParent3 = new THREE.Object3D();
			targetModelParent4 = new THREE.Object3D();
			targetModel3 = targetModel.clone();
			targetModel4 = targetModel.clone();
			targetModel3.getWorldPosition(targetModelParent3.position);
			targetModel3.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent3.add(targetModel3);
			scene.add(targetModelParent3);

			targetModel4.getWorldPosition(targetModelParent4.position);
			targetModel4.rotation.set(...[Math.PI/2,0,0]);
			targetModelParent4.add(targetModel4);
			scene.add(targetModelParent4);
		});
	
		gltfLoader.load("gltf/robot/scene.gltf", (gltf) => {
			var robotModel = gltf.scene.getObjectByName("Sketchfab_Scene");

			robotModel.scale.setScalar( 1 );
			var bone = gltf.scene.getObjectByName("Bone_74");
			var leftFoot = gltf.scene.getObjectByName("FootL_2");
			var leftLowerLeg = gltf.scene.getObjectByName("LowerLegL_5");
			bone.remove(leftFoot)
			leftLowerLeg.add(leftFoot);
			var rightFoot = gltf.scene.getObjectByName("FootR_71");
			var rightLowerLeg = gltf.scene.getObjectByName("LowerLegR_10");
			bone.remove(rightFoot)
			rightLowerLeg.add(rightFoot);
			leftFoot.position.set(-0.000, 0.008, 0.000);
			leftFoot.rotation.set(...[leftFoot.rotation.x - Math.PI,leftFoot.rotation.y,leftFoot.rotation.z]);
			rightFoot.position.set(0.000, 0.008, 0.000);
			rightFoot.rotation.set(...[rightFoot.rotation.x - Math.PI,rightFoot.rotation.y,rightFoot.rotation.z]);



			// console.log(dumpObject(robotModel).join('\n'));

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			var positions = [new CANNON.Vec3(5, 8.7, 117.5),
						new CANNON.Vec3(-5, 8.7, 117.5),
						new CANNON.Vec3(0, 8.7, 122.5)
										];


			//Function that returns the listener for the collision event of the robots (can't create the listener directly in the loop)
			function robotColliderEvent(genRobot){
				return (e) => {
					//Function that checks if an arrow with that id exists and it's able to kill
					function checkArrowKiller(id){
						var ret=false;
						arrows.forEach(element => {
							if(element["killer"] && element["can"].id==id) ret = true;
						});
						return ret;
					}
					if (genRobot["body"] && ((e.contact.bi.id == genRobot["body"].id && checkArrowKiller(e.contact.bj.id)) || (e.contact.bj.id == genRobot["body"].id && checkArrowKiller(e.contact.bj.id)))) {
						scene.remove(genRobot["model"]);
						setTimeout(function() {
							world.removeBody(genRobot["body"]);
						},0);
						scene.remove(genRobot["mesh"]);
						robots = robots.filter(function(ele){ 
							return ele != genRobot; 
						});
					}
					else if((justRepulsed == false && genRobot["body"] && cubeBody) && ((e.contact.bi.id == genRobot["body"].id && e.contact.bj.id == cubeBody.id || (e.contact.bj.id == genRobot["body"].id && e.contact.bi.id == cubeBody.id)))){
						justRepulsed = true;
						//Must repulse after some time otherwise too many activations
						setTimeout(function() {
							justRepulsed = false;
						},500);
						var enemyRepulseVelocity = 150;
						var impactDir = new THREE.Vector3();
						impactDir.subVectors( cubeBody.position, genRobot["body"].position);
						impactDir.normalize();
						// console.log(impactDir)
						cubeBody.velocity.x = enemyRepulseVelocity * impactDir.x;
						cubeBody.velocity.z = enemyRepulseVelocity * impactDir.z;
					}
				} 
			}

			//Tween onComplete function to make the next (the one in the argument) tween start
			function getOnCompleteHandler (tween) {
					return function () {tween.start()};
			};

			//Tween update function, can't create it directly in the loop
			function createUpdateFunction(genRobotStructure){
				return (object, elapsedTime) => {
					genRobotStructure["rootJoint"].rotation.x = object["rootJointRx"]; 
					genRobotStructure["rootJoint"].rotation.y = object["rootJointRy"]; 
					genRobotStructure["rootJoint"].rotation.z = object["rootJointRz"];
					genRobotStructure["bone"].rotation.x = object["boneRx"]; 
					genRobotStructure["bone"].rotation.y = object["boneRy"]; 
					genRobotStructure["bone"].rotation.z = object["boneRz"];
					genRobotStructure["footL"].rotation.x = object["footLRx"]; 
					genRobotStructure["footL"].rotation.y = object["footLRy"]; 
					genRobotStructure["footL"].rotation.z = object["footLRz"];
					genRobotStructure["body"].rotation.x = object["bodyRx"]; 
					genRobotStructure["body"].rotation.y = object["bodyRy"]; 
					genRobotStructure["body"].rotation.z = object["bodyRz"];
					genRobotStructure["upperLegL"].rotation.x = object["upperLegLRx"]; 
					genRobotStructure["upperLegL"].rotation.y = object["upperLegLRy"]; 
					genRobotStructure["upperLegL"].rotation.z = object["upperLegLRz"];
					genRobotStructure["lowerLegL"].rotation.x = object["lowerLegLRx"]; 
					genRobotStructure["lowerLegL"].rotation.y = object["lowerLegLRy"]; 
					genRobotStructure["lowerLegL"].rotation.z = object["lowerLegLRz"];
					genRobotStructure["upperLegR"].rotation.x = object["upperLegRRx"]; 
					genRobotStructure["upperLegR"].rotation.y = object["upperLegRRy"]; 
					genRobotStructure["upperLegR"].rotation.z = object["upperLegRRz"];
					genRobotStructure["lowerLegR"].rotation.x = object["lowerLegRRx"]; 
					genRobotStructure["lowerLegR"].rotation.y = object["lowerLegRRy"]; 
					genRobotStructure["lowerLegR"].rotation.z = object["lowerLegRRz"];
					genRobotStructure["hips"].rotation.x = object["hipsRx"]; 
					genRobotStructure["hips"].rotation.y = object["hipsRy"]; 
					genRobotStructure["hips"].rotation.z = object["hipsRz"];
					genRobotStructure["abdomen"].rotation.x = object["abdomenRx"]; 
					genRobotStructure["abdomen"].rotation.y = object["abdomenRy"]; 
					genRobotStructure["abdomen"].rotation.z = object["abdomenRz"];
					genRobotStructure["torso"].rotation.x = object["torsoRx"]; 
					genRobotStructure["torso"].rotation.y = object["torsoRy"]; 
					genRobotStructure["torso"].rotation.z = object["torsoRz"];
					genRobotStructure["neck"].rotation.x = object["neckRx"]; 
					genRobotStructure["neck"].rotation.y = object["neckRy"]; 
					genRobotStructure["neck"].rotation.z = object["neckRz"];
					genRobotStructure["head"].rotation.x = object["headRx"]; 
					genRobotStructure["head"].rotation.y = object["headRy"]; 
					genRobotStructure["head"].rotation.z = object["headRz"];
					genRobotStructure["shoulderR"].rotation.x = object["shoulderRRx"]; 
					genRobotStructure["shoulderR"].rotation.y = object["shoulderRRy"]; 
					genRobotStructure["shoulderR"].rotation.z = object["shoulderRRz"];
					genRobotStructure["upperArmR"].rotation.x = object["upperArmRRx"]; 
					genRobotStructure["upperArmR"].rotation.y = object["upperArmRRy"]; 
					genRobotStructure["upperArmR"].rotation.z = object["upperArmRRz"];
					genRobotStructure["lowerArmR"].rotation.x = object["lowerArmRRx"]; 
					genRobotStructure["lowerArmR"].rotation.y = object["lowerArmRRy"]; 
					genRobotStructure["lowerArmR"].rotation.z = object["lowerArmRRz"];
					genRobotStructure["thumbR"].rotation.x = object["thumbRRx"]; 
					genRobotStructure["thumbR"].rotation.y = object["thumbRRy"]; 
					genRobotStructure["thumbR"].rotation.z = object["thumbRRz"];
					genRobotStructure["thumb2R"].rotation.x = object["thumb2RRx"]; 
					genRobotStructure["thumb2R"].rotation.y = object["thumb2RRy"]; 
					genRobotStructure["thumb2R"].rotation.z = object["thumb2RRz"];
					genRobotStructure["palm2R"].rotation.x = object["palm2RRx"]; 
					genRobotStructure["palm2R"].rotation.y = object["palm2RRy"]; 
					genRobotStructure["palm2R"].rotation.z = object["palm2RRz"];
					genRobotStructure["middle1R"].rotation.x = object["middle1RRx"]; 
					genRobotStructure["middle1R"].rotation.y = object["middle1RRy"]; 
					genRobotStructure["middle1R"].rotation.z = object["middle1RRz"];
					genRobotStructure["middle2R"].rotation.x = object["middle2RRx"]; 
					genRobotStructure["middle2R"].rotation.y = object["middle2RRy"]; 
					genRobotStructure["middle2R"].rotation.z = object["middle2RRz"];
					genRobotStructure["palm1R"].rotation.x = object["palm1RRx"]; 
					genRobotStructure["palm1R"].rotation.y = object["palm1RRy"]; 
					genRobotStructure["palm1R"].rotation.z = object["palm1RRz"];
					genRobotStructure["indexR"].rotation.x = object["indexRRx"]; 
					genRobotStructure["indexR"].rotation.y = object["indexRRy"]; 
					genRobotStructure["indexR"].rotation.z = object["indexRRz"];
					genRobotStructure["index2R"].rotation.x = object["index2RRx"]; 
					genRobotStructure["index2R"].rotation.y = object["index2RRy"]; 
					genRobotStructure["index2R"].rotation.z = object["index2RRz"];
					genRobotStructure["palm3R"].rotation.x = object["palm3RRx"]; 
					genRobotStructure["palm3R"].rotation.y = object["palm3RRy"]; 
					genRobotStructure["palm3R"].rotation.z = object["palm3RRz"];
					genRobotStructure["ring1R"].rotation.x = object["ring1RRx"]; 
					genRobotStructure["ring1R"].rotation.y = object["ring1RRy"]; 
					genRobotStructure["ring1R"].rotation.z = object["ring1RRz"];
					genRobotStructure["ring2R"].rotation.x = object["ring2RRx"]; 
					genRobotStructure["ring2R"].rotation.y = object["ring2RRy"]; 
					genRobotStructure["ring2R"].rotation.z = object["ring2RRz"];
					genRobotStructure["shoulderL"].rotation.x = object["shoulderLRx"]; 
					genRobotStructure["shoulderL"].rotation.y = object["shoulderLRy"]; 
					genRobotStructure["shoulderL"].rotation.z = object["shoulderLRz"];
					genRobotStructure["upperArmL"].rotation.x = object["upperArmLRx"]; 
					genRobotStructure["upperArmL"].rotation.y = object["upperArmLRy"]; 
					genRobotStructure["upperArmL"].rotation.z = object["upperArmLRz"];
					genRobotStructure["lowerArmL"].rotation.x = object["lowerArmLRx"]; 
					genRobotStructure["lowerArmL"].rotation.y = object["lowerArmLRy"]; 
					genRobotStructure["lowerArmL"].rotation.z = object["lowerArmLRz"];
					genRobotStructure["palm2L"].rotation.x = object["palm2LRx"]; 
					genRobotStructure["palm2L"].rotation.y = object["palm2LRy"]; 
					genRobotStructure["palm2L"].rotation.z = object["palm2LRz"];
					genRobotStructure["middle1L"].rotation.x = object["middle1LRx"]; 
					genRobotStructure["middle1L"].rotation.y = object["middle1LRy"]; 
					genRobotStructure["middle1L"].rotation.z = object["middle1LRz"];
					genRobotStructure["middle2L"].rotation.x = object["middle2LRx"]; 
					genRobotStructure["middle2L"].rotation.y = object["middle2LRy"]; 
					genRobotStructure["middle2L"].rotation.z = object["middle2LRz"];
					genRobotStructure["thumbL"].rotation.x = object["thumbLRx"]; 
					genRobotStructure["thumbL"].rotation.y = object["thumbLRy"]; 
					genRobotStructure["thumbL"].rotation.z = object["thumbLRz"];
					genRobotStructure["thumb2L"].rotation.x = object["thumb2LRx"]; 
					genRobotStructure["thumb2L"].rotation.y = object["thumb2LRy"]; 
					genRobotStructure["thumb2L"].rotation.z = object["thumb2LRz"];
					genRobotStructure["palm1L"].rotation.x = object["palm1LRx"]; 
					genRobotStructure["palm1L"].rotation.y = object["palm1LRy"]; 
					genRobotStructure["palm1L"].rotation.z = object["palm1LRz"];
					genRobotStructure["indexL"].rotation.x = object["indexLRx"]; 
					genRobotStructure["indexL"].rotation.y = object["indexLRy"]; 
					genRobotStructure["indexL"].rotation.z = object["indexLRz"];
					genRobotStructure["index2L"].rotation.x = object["index2LRx"]; 
					genRobotStructure["index2L"].rotation.y = object["index2LRy"]; 
					genRobotStructure["index2L"].rotation.z = object["index2LRz"];
					genRobotStructure["palm3L"].rotation.x = object["palm3LRx"]; 
					genRobotStructure["palm3L"].rotation.y = object["palm3LRy"]; 
					genRobotStructure["palm3L"].rotation.z = object["palm3LRz"];
					genRobotStructure["ring1L"].rotation.x = object["ring1LRx"]; 
					genRobotStructure["ring1L"].rotation.y = object["ring1LRy"]; 
					genRobotStructure["ring1L"].rotation.z = object["ring1LRz"];
					genRobotStructure["ring2L"].rotation.x = object["ring2LRx"]; 
					genRobotStructure["ring2L"].rotation.y = object["ring2LRy"]; 
					genRobotStructure["ring2L"].rotation.z = object["ring2LRz"];
					genRobotStructure["poleTargetL"].rotation.x = object["poleTargetLRx"]; 
					genRobotStructure["poleTargetL"].rotation.y = object["poleTargetLRy"]; 
					genRobotStructure["poleTargetL"].rotation.z = object["poleTargetLRz"];
					genRobotStructure["footR"].rotation.x = object["footRRx"]; 
					genRobotStructure["footR"].rotation.y = object["footRRy"]; 
					genRobotStructure["footR"].rotation.z = object["footRRz"];
					genRobotStructure["poleTargetR"].rotation.x = object["poleTargetRRx"]; 
					genRobotStructure["poleTargetR"].rotation.y = object["poleTargetRRy"]; 
					genRobotStructure["poleTargetR"].rotation.z = object["poleTargetRRz"];
				};
			}

			for(var i=0; i<positions.length; i++){
				var genRobotGeo = new THREE.BoxGeometry( 2.5 , 4.4, 2)
				var genRobotMat = new THREE.MeshPhongMaterial({ 
					color: 0x00ff00,
					side: THREE.DoubleSide,
					wireframe: true
					});
				var genRobotMesh = new THREE.Mesh(genRobotGeo, genRobotMat);
				//scene.add(genRobotMesh);
				genRobotMesh.receiveShadow=true;
				genRobotMesh.castshadow=true;

				var robotModelParent = new THREE.Object3D();
				robotModel.getWorldPosition(robotModelParent.position);
				robotModel.position.set(0, -genRobotMesh.geometry.parameters.height/2, genRobotMesh.geometry.parameters.depth/4);
				robotModel.rotation.set(...[0,Math.PI,0]);
				var genRobotModel = robotModel.clone();
				robotModelParent.add(genRobotModel);

				scene.add(robotModelParent);

				//OBSTACLES PLATFORMS (CANNON)

				var genRobotBody = new CANNON.Body({
					mass: 180,
					shape: new CANNON.Box(new CANNON.Vec3(1.25, 2.2, 1)),
					material: cubePhysMat,
					position: positions[i],
					linearDamping: 0.5,
					angularDamping: 0.5,
					type: CANNON.Body.DYNAMIC 
				});
				world.addBody(genRobotBody);
				genRobotBody.quaternion.setFromEuler(0, 0, 0);
				var genRobotStructure = populateRobotStructure(genRobotModel);
				var tweens = {};
				//console.log('"rootJointRx" : ' + genRobotStructure["rootJoint"].rotation.x.toFixed(4) + ',\n"rootJointRy" : ' + genRobotStructure["rootJoint"].rotation.y.toFixed(4) + ',\n"rootJointRz" : ' +genRobotStructure["rootJoint"].rotation.z.toFixed(4) + ',\n"boneRx" : ' + genRobotStructure["bone"].rotation.x.toFixed(4) + ',\n"boneRy" : ' + genRobotStructure["bone"].rotation.y.toFixed(4) + ',\n"boneRz" : ' +genRobotStructure["bone"].rotation.z.toFixed(4) + ',\n"footLRx" : ' + genRobotStructure["footL"].rotation.x.toFixed(4) + ',\n"footLRy" : ' + genRobotStructure["footL"].rotation.y.toFixed(4) + ',\n"footLRz" : ' +genRobotStructure["footL"].rotation.z.toFixed(4) + ',\n"bodyRx" : ' + genRobotStructure["body"].rotation.x.toFixed(4) + ',\n"bodyRy" : ' + genRobotStructure["body"].rotation.y.toFixed(4) + ',\n"bodyRz" : ' +genRobotStructure["body"].rotation.z.toFixed(4) + ',\n"upperLegLRx" : ' + genRobotStructure["upperLegL"].rotation.x.toFixed(4) + ',\n"upperLegLRy" : ' + genRobotStructure["upperLegL"].rotation.y.toFixed(4) + ',\n"upperLegLRz" : ' +genRobotStructure["upperLegL"].rotation.z.toFixed(4) + ',\n"lowerLegLRx" : ' + genRobotStructure["lowerLegL"].rotation.x.toFixed(4) + ',\n"lowerLegLRy" : ' + genRobotStructure["lowerLegL"].rotation.y.toFixed(4) + ',\n"lowerLegLRz" : ' +genRobotStructure["lowerLegL"].rotation.z.toFixed(4) + ',\n"upperLegRRx" : ' + genRobotStructure["upperLegR"].rotation.x.toFixed(4) + ',\n"upperLegRRy" : ' + genRobotStructure["upperLegR"].rotation.y.toFixed(4) + ',\n"upperLegRRz" : ' +genRobotStructure["upperLegR"].rotation.z.toFixed(4) + ',\n"lowerLegRRx" : ' + genRobotStructure["lowerLegR"].rotation.x.toFixed(4) + ',\n"lowerLegRRy" : ' + genRobotStructure["lowerLegR"].rotation.y.toFixed(4) + ',\n"lowerLegRRz" : ' +genRobotStructure["lowerLegR"].rotation.z.toFixed(4) + ',\n"hipsRx" : ' + genRobotStructure["hips"].rotation.x.toFixed(4) + ',\n"hipsRy" : ' + genRobotStructure["hips"].rotation.y.toFixed(4) + ',\n"hipsRz" : ' +genRobotStructure["hips"].rotation.z.toFixed(4) + ',\n"abdomenRx" : ' + genRobotStructure["abdomen"].rotation.x.toFixed(4) + ',\n"abdomenRy" : ' + genRobotStructure["abdomen"].rotation.y.toFixed(4) + ',\n"abdomenRz" : ' +genRobotStructure["abdomen"].rotation.z.toFixed(4) + ',\n"torsoRx" : ' + genRobotStructure["torso"].rotation.x.toFixed(4) + ',\n"torsoRy" : ' + genRobotStructure["torso"].rotation.y.toFixed(4) + ',\n"torsoRz" : ' +genRobotStructure["torso"].rotation.z.toFixed(4) + ',\n"neckRx" : ' + genRobotStructure["neck"].rotation.x.toFixed(4) + ',\n"neckRy" : ' + genRobotStructure["neck"].rotation.y.toFixed(4) + ',\n"neckRz" : ' +genRobotStructure["neck"].rotation.z.toFixed(4) + ',\n"headRx" : ' + genRobotStructure["head"].rotation.x.toFixed(4) + ',\n"headRy" : ' + genRobotStructure["head"].rotation.y.toFixed(4) + ',\n"headRz" : ' +genRobotStructure["head"].rotation.z.toFixed(4) + ',\n"shoulderRRx" : ' + genRobotStructure["shoulderR"].rotation.x.toFixed(4) + ',\n"shoulderRRy" : ' + genRobotStructure["shoulderR"].rotation.y.toFixed(4) + ',\n"shoulderRRz" : ' +genRobotStructure["shoulderR"].rotation.z.toFixed(4) + ',\n"upperArmRRx" : ' + genRobotStructure["upperArmR"].rotation.x.toFixed(4) + ',\n"upperArmRRy" : ' + genRobotStructure["upperArmR"].rotation.y.toFixed(4) + ',\n"upperArmRRz" : ' +genRobotStructure["upperArmR"].rotation.z.toFixed(4) + ',\n"lowerArmRRx" : ' + genRobotStructure["lowerArmR"].rotation.x.toFixed(4) + ',\n"lowerArmRRy" : ' + genRobotStructure["lowerArmR"].rotation.y.toFixed(4) + ',\n"lowerArmRRz" : ' +genRobotStructure["lowerArmR"].rotation.z.toFixed(4) + ',\n"thumbRRx" : ' + genRobotStructure["thumbR"].rotation.x.toFixed(4) + ',\n"thumbRRy" : ' + genRobotStructure["thumbR"].rotation.y.toFixed(4) + ',\n"thumbRRz" : ' +genRobotStructure["thumbR"].rotation.z.toFixed(4) + ',\n"thumb2RRx" : ' + genRobotStructure["thumb2R"].rotation.x.toFixed(4) + ',\n"thumb2RRy" : ' + genRobotStructure["thumb2R"].rotation.y.toFixed(4) + ',\n"thumb2RRz" : ' +genRobotStructure["thumb2R"].rotation.z.toFixed(4) + ',\n"palm2RRx" : ' + genRobotStructure["palm2R"].rotation.x.toFixed(4) + ',\n"palm2RRy" : ' + genRobotStructure["palm2R"].rotation.y.toFixed(4) + ',\n"palm2RRz" : ' +genRobotStructure["palm2R"].rotation.z.toFixed(4) + ',\n"middle1RRx" : ' + genRobotStructure["middle1R"].rotation.x.toFixed(4) + ',\n"middle1RRy" : ' + genRobotStructure["middle1R"].rotation.y.toFixed(4) + ',\n"middle1RRz" : ' +genRobotStructure["middle1R"].rotation.z.toFixed(4) + ',\n"middle2RRx" : ' + genRobotStructure["middle2R"].rotation.x.toFixed(4) + ',\n"middle2RRy" : ' + genRobotStructure["middle2R"].rotation.y.toFixed(4) + ',\n"middle2RRz" : ' +genRobotStructure["middle2R"].rotation.z.toFixed(4) + ',\n"palm1RRx" : ' + genRobotStructure["palm1R"].rotation.x.toFixed(4) + ',\n"palm1RRy" : ' + genRobotStructure["palm1R"].rotation.y.toFixed(4) + ',\n"palm1RRz" : ' +genRobotStructure["palm1R"].rotation.z.toFixed(4) + ',\n"indexRRx" : ' + genRobotStructure["indexR"].rotation.x.toFixed(4) + ',\n"indexRRy" : ' + genRobotStructure["indexR"].rotation.y.toFixed(4) + ',\n"indexRRz" : ' +genRobotStructure["indexR"].rotation.z.toFixed(4) + ',\n"index2RRx" : ' + genRobotStructure["index2R"].rotation.x.toFixed(4) + ',\n"index2RRy" : ' + genRobotStructure["index2R"].rotation.y.toFixed(4) + ',\n"index2RRz" : ' +genRobotStructure["index2R"].rotation.z.toFixed(4) + ',\n"palm3RRx" : ' + genRobotStructure["palm3R"].rotation.x.toFixed(4) + ',\n"palm3RRy" : ' + genRobotStructure["palm3R"].rotation.y.toFixed(4) + ',\n"palm3RRz" : ' +genRobotStructure["palm3R"].rotation.z.toFixed(4) + ',\n"ring1RRx" : ' + genRobotStructure["ring1R"].rotation.x.toFixed(4) + ',\n"ring1RRy" : ' + genRobotStructure["ring1R"].rotation.y.toFixed(4) + ',\n"ring1RRz" : ' +genRobotStructure["ring1R"].rotation.z.toFixed(4) + ',\n"ring2RRx" : ' + genRobotStructure["ring2R"].rotation.x.toFixed(4) + ',\n"ring2RRy" : ' + genRobotStructure["ring2R"].rotation.y.toFixed(4) + ',\n"ring2RRz" : ' +genRobotStructure["ring2R"].rotation.z.toFixed(4) + ',\n"shoulderLRx" : ' + genRobotStructure["shoulderL"].rotation.x.toFixed(4) + ',\n"shoulderLRy" : ' + genRobotStructure["shoulderL"].rotation.y.toFixed(4) + ',\n"shoulderLRz" : ' +genRobotStructure["shoulderL"].rotation.z.toFixed(4) + ',\n"upperArmLRx" : ' + genRobotStructure["upperArmL"].rotation.x.toFixed(4) + ',\n"upperArmLRy" : ' + genRobotStructure["upperArmL"].rotation.y.toFixed(4) + ',\n"upperArmLRz" : ' +genRobotStructure["upperArmL"].rotation.z.toFixed(4) + ',\n"lowerArmLRx" : ' + genRobotStructure["lowerArmL"].rotation.x.toFixed(4) + ',\n"lowerArmLRy" : ' + genRobotStructure["lowerArmL"].rotation.y.toFixed(4) + ',\n"lowerArmLRz" : ' +genRobotStructure["lowerArmL"].rotation.z.toFixed(4) + ',\n"palm2LRx" : ' + genRobotStructure["palm2L"].rotation.x.toFixed(4) + ',\n"palm2LRy" : ' + genRobotStructure["palm2L"].rotation.y.toFixed(4) + ',\n"palm2LRz" : ' +genRobotStructure["palm2L"].rotation.z.toFixed(4) + ',\n"middle1LRx" : ' + genRobotStructure["middle1L"].rotation.x.toFixed(4) + ',\n"middle1LRy" : ' + genRobotStructure["middle1L"].rotation.y.toFixed(4) + ',\n"middle1LRz" : ' +genRobotStructure["middle1L"].rotation.z.toFixed(4) + ',\n"middle2LRx" : ' + genRobotStructure["middle2L"].rotation.x.toFixed(4) + ',\n"middle2LRy" : ' + genRobotStructure["middle2L"].rotation.y.toFixed(4) + ',\n"middle2LRz" : ' +genRobotStructure["middle2L"].rotation.z.toFixed(4) + ',\n"thumbLRx" : ' + genRobotStructure["thumbL"].rotation.x.toFixed(4) + ',\n"thumbLRy" : ' + genRobotStructure["thumbL"].rotation.y.toFixed(4) + ',\n"thumbLRz" : ' +genRobotStructure["thumbL"].rotation.z.toFixed(4) + ',\n"thumb2LRx" : ' + genRobotStructure["thumb2L"].rotation.x.toFixed(4) + ',\n"thumb2LRy" : ' + genRobotStructure["thumb2L"].rotation.y.toFixed(4) + ',\n"thumb2LRz" : ' +genRobotStructure["thumb2L"].rotation.z.toFixed(4) + ',\n"palm1LRx" : ' + genRobotStructure["palm1L"].rotation.x.toFixed(4) + ',\n"palm1LRy" : ' + genRobotStructure["palm1L"].rotation.y.toFixed(4) + ',\n"palm1LRz" : ' +genRobotStructure["palm1L"].rotation.z.toFixed(4) + ',\n"indexLRx" : ' + genRobotStructure["indexL"].rotation.x.toFixed(4) + ',\n"indexLRy" : ' + genRobotStructure["indexL"].rotation.y.toFixed(4) + ',\n"indexLRz" : ' +genRobotStructure["indexL"].rotation.z.toFixed(4) + ',\n"index2LRx" : ' + genRobotStructure["index2L"].rotation.x.toFixed(4) + ',\n"index2LRy" : ' + genRobotStructure["index2L"].rotation.y.toFixed(4) + ',\n"index2LRz" : ' +genRobotStructure["index2L"].rotation.z.toFixed(4) + ',\n"palm3LRx" : ' + genRobotStructure["palm3L"].rotation.x.toFixed(4) + ',\n"palm3LRy" : ' + genRobotStructure["palm3L"].rotation.y.toFixed(4) + ',\n"palm3LRz" : ' +genRobotStructure["palm3L"].rotation.z.toFixed(4) + ',\n"ring1LRx" : ' + genRobotStructure["ring1L"].rotation.x.toFixed(4) + ',\n"ring1LRy" : ' + genRobotStructure["ring1L"].rotation.y.toFixed(4) + ',\n"ring1LRz" : ' +genRobotStructure["ring1L"].rotation.z.toFixed(4) + ',\n"ring2LRx" : ' + genRobotStructure["ring2L"].rotation.x.toFixed(4) + ',\n"ring2LRy" : ' + genRobotStructure["ring2L"].rotation.y.toFixed(4) + ',\n"ring2LRz" : ' +genRobotStructure["ring2L"].rotation.z.toFixed(4) + ',\n"poleTargetLRx" : ' + genRobotStructure["poleTargetL"].rotation.x.toFixed(4) + ',\n"poleTargetLRy" : ' + genRobotStructure["poleTargetL"].rotation.y.toFixed(4) + ',\n"poleTargetLRz" : ' +genRobotStructure["poleTargetL"].rotation.z.toFixed(4) + ',\n"footRRx" : ' + genRobotStructure["footR"].rotation.x.toFixed(4) + ',\n"footRRy" : ' + genRobotStructure["footR"].rotation.y.toFixed(4) + ',\n"footRRz" : ' +genRobotStructure["footR"].rotation.z.toFixed(4) + ',\n"poleTargetRRx" : ' + genRobotStructure["poleTargetR"].rotation.x.toFixed(4) + ',\n"poleTargetRRy" : ' + genRobotStructure["poleTargetR"].rotation.y.toFixed(4) + ',\n"poleTargetRRz" : ' +genRobotStructure["poleTargetR"].rotation.z.toFixed(4));

				var initialRotations = {
					"rootJointRx" : genRobotStructure["rootJoint"].rotation.x, 
					"rootJointRy" : genRobotStructure["rootJoint"].rotation.y, 
					"rootJointRz" :genRobotStructure["rootJoint"].rotation.z,
					"boneRx" : genRobotStructure["bone"].rotation.x, 
					"boneRy" : genRobotStructure["bone"].rotation.y, 
					"boneRz" :genRobotStructure["bone"].rotation.z,
					"footLRx" : genRobotStructure["footL"].rotation.x, 
					"footLRy" : genRobotStructure["footL"].rotation.y, 
					"footLRz" :genRobotStructure["footL"].rotation.z,
					"bodyRx" : genRobotStructure["body"].rotation.x, 
					"bodyRy" : genRobotStructure["body"].rotation.y, 
					"bodyRz" :genRobotStructure["body"].rotation.z,
					"upperLegLRx" : genRobotStructure["upperLegL"].rotation.x, 
					"upperLegLRy" : genRobotStructure["upperLegL"].rotation.y, 
					"upperLegLRz" :genRobotStructure["upperLegL"].rotation.z,
					"lowerLegLRx" : genRobotStructure["lowerLegL"].rotation.x, 
					"lowerLegLRy" : genRobotStructure["lowerLegL"].rotation.y, 
					"lowerLegLRz" :genRobotStructure["lowerLegL"].rotation.z,
					"upperLegRRx" : genRobotStructure["upperLegR"].rotation.x, 
					"upperLegRRy" : genRobotStructure["upperLegR"].rotation.y, 
					"upperLegRRz" :genRobotStructure["upperLegR"].rotation.z,
					"lowerLegRRx" : genRobotStructure["lowerLegR"].rotation.x, 
					"lowerLegRRy" : genRobotStructure["lowerLegR"].rotation.y, 
					"lowerLegRRz" :genRobotStructure["lowerLegR"].rotation.z,
					"hipsRx" : genRobotStructure["hips"].rotation.x, 
					"hipsRy" : genRobotStructure["hips"].rotation.y, 
					"hipsRz" :genRobotStructure["hips"].rotation.z,
					"abdomenRx" : genRobotStructure["abdomen"].rotation.x, 
					"abdomenRy" : genRobotStructure["abdomen"].rotation.y, 
					"abdomenRz" :genRobotStructure["abdomen"].rotation.z,
					"torsoRx" : genRobotStructure["torso"].rotation.x, 
					"torsoRy" : genRobotStructure["torso"].rotation.y, 
					"torsoRz" :genRobotStructure["torso"].rotation.z,
					"neckRx" : genRobotStructure["neck"].rotation.x, 
					"neckRy" : genRobotStructure["neck"].rotation.y, 
					"neckRz" :genRobotStructure["neck"].rotation.z,
					"headRx" : genRobotStructure["head"].rotation.x, 
					"headRy" : genRobotStructure["head"].rotation.y, 
					"headRz" :genRobotStructure["head"].rotation.z,
					"shoulderRRx" : genRobotStructure["shoulderR"].rotation.x, 
					"shoulderRRy" : genRobotStructure["shoulderR"].rotation.y, 
					"shoulderRRz" :genRobotStructure["shoulderR"].rotation.z,
					"upperArmRRx" : genRobotStructure["upperArmR"].rotation.x, 
					"upperArmRRy" : genRobotStructure["upperArmR"].rotation.y, 
					"upperArmRRz" :genRobotStructure["upperArmR"].rotation.z,
					"lowerArmRRx" : genRobotStructure["lowerArmR"].rotation.x, 
					"lowerArmRRy" : genRobotStructure["lowerArmR"].rotation.y, 
					"lowerArmRRz" :genRobotStructure["lowerArmR"].rotation.z,
					"thumbRRx" : genRobotStructure["thumbR"].rotation.x, 
					"thumbRRy" : genRobotStructure["thumbR"].rotation.y, 
					"thumbRRz" :genRobotStructure["thumbR"].rotation.z,
					"thumb2RRx" : genRobotStructure["thumb2R"].rotation.x, 
					"thumb2RRy" : genRobotStructure["thumb2R"].rotation.y, 
					"thumb2RRz" :genRobotStructure["thumb2R"].rotation.z,
					"palm2RRx" : genRobotStructure["palm2R"].rotation.x, 
					"palm2RRy" : genRobotStructure["palm2R"].rotation.y, 
					"palm2RRz" :genRobotStructure["palm2R"].rotation.z,
					"middle1RRx" : genRobotStructure["middle1R"].rotation.x, 
					"middle1RRy" : genRobotStructure["middle1R"].rotation.y, 
					"middle1RRz" :genRobotStructure["middle1R"].rotation.z,
					"middle2RRx" : genRobotStructure["middle2R"].rotation.x, 
					"middle2RRy" : genRobotStructure["middle2R"].rotation.y, 
					"middle2RRz" :genRobotStructure["middle2R"].rotation.z,
					"palm1RRx" : genRobotStructure["palm1R"].rotation.x, 
					"palm1RRy" : genRobotStructure["palm1R"].rotation.y, 
					"palm1RRz" :genRobotStructure["palm1R"].rotation.z,
					"indexRRx" : genRobotStructure["indexR"].rotation.x, 
					"indexRRy" : genRobotStructure["indexR"].rotation.y, 
					"indexRRz" :genRobotStructure["indexR"].rotation.z,
					"index2RRx" : genRobotStructure["index2R"].rotation.x, 
					"index2RRy" : genRobotStructure["index2R"].rotation.y, 
					"index2RRz" :genRobotStructure["index2R"].rotation.z,
					"palm3RRx" : genRobotStructure["palm3R"].rotation.x, 
					"palm3RRy" : genRobotStructure["palm3R"].rotation.y, 
					"palm3RRz" :genRobotStructure["palm3R"].rotation.z,
					"ring1RRx" : genRobotStructure["ring1R"].rotation.x, 
					"ring1RRy" : genRobotStructure["ring1R"].rotation.y, 
					"ring1RRz" :genRobotStructure["ring1R"].rotation.z,
					"ring2RRx" : genRobotStructure["ring2R"].rotation.x, 
					"ring2RRy" : genRobotStructure["ring2R"].rotation.y, 
					"ring2RRz" :genRobotStructure["ring2R"].rotation.z,
					"shoulderLRx" : genRobotStructure["shoulderL"].rotation.x, 
					"shoulderLRy" : genRobotStructure["shoulderL"].rotation.y, 
					"shoulderLRz" :genRobotStructure["shoulderL"].rotation.z,
					"upperArmLRx" : genRobotStructure["upperArmL"].rotation.x, 
					"upperArmLRy" : genRobotStructure["upperArmL"].rotation.y, 
					"upperArmLRz" :genRobotStructure["upperArmL"].rotation.z,
					"lowerArmLRx" : genRobotStructure["lowerArmL"].rotation.x, 
					"lowerArmLRy" : genRobotStructure["lowerArmL"].rotation.y, 
					"lowerArmLRz" :genRobotStructure["lowerArmL"].rotation.z,
					"palm2LRx" : genRobotStructure["palm2L"].rotation.x, 
					"palm2LRy" : genRobotStructure["palm2L"].rotation.y, 
					"palm2LRz" :genRobotStructure["palm2L"].rotation.z,
					"middle1LRx" : genRobotStructure["middle1L"].rotation.x, 
					"middle1LRy" : genRobotStructure["middle1L"].rotation.y, 
					"middle1LRz" :genRobotStructure["middle1L"].rotation.z,
					"middle2LRx" : genRobotStructure["middle2L"].rotation.x, 
					"middle2LRy" : genRobotStructure["middle2L"].rotation.y, 
					"middle2LRz" :genRobotStructure["middle2L"].rotation.z,
					"thumbLRx" : genRobotStructure["thumbL"].rotation.x, 
					"thumbLRy" : genRobotStructure["thumbL"].rotation.y, 
					"thumbLRz" :genRobotStructure["thumbL"].rotation.z,
					"thumb2LRx" : genRobotStructure["thumb2L"].rotation.x, 
					"thumb2LRy" : genRobotStructure["thumb2L"].rotation.y, 
					"thumb2LRz" :genRobotStructure["thumb2L"].rotation.z,
					"palm1LRx" : genRobotStructure["palm1L"].rotation.x, 
					"palm1LRy" : genRobotStructure["palm1L"].rotation.y, 
					"palm1LRz" :genRobotStructure["palm1L"].rotation.z,
					"indexLRx" : genRobotStructure["indexL"].rotation.x, 
					"indexLRy" : genRobotStructure["indexL"].rotation.y, 
					"indexLRz" :genRobotStructure["indexL"].rotation.z,
					"index2LRx" : genRobotStructure["index2L"].rotation.x, 
					"index2LRy" : genRobotStructure["index2L"].rotation.y, 
					"index2LRz" :genRobotStructure["index2L"].rotation.z,
					"palm3LRx" : genRobotStructure["palm3L"].rotation.x, 
					"palm3LRy" : genRobotStructure["palm3L"].rotation.y, 
					"palm3LRz" :genRobotStructure["palm3L"].rotation.z,
					"ring1LRx" : genRobotStructure["ring1L"].rotation.x, 
					"ring1LRy" : genRobotStructure["ring1L"].rotation.y, 
					"ring1LRz" :genRobotStructure["ring1L"].rotation.z,
					"ring2LRx" : genRobotStructure["ring2L"].rotation.x, 
					"ring2LRy" : genRobotStructure["ring2L"].rotation.y, 
					"ring2LRz" :genRobotStructure["ring2L"].rotation.z,
					"poleTargetLRx" : genRobotStructure["poleTargetL"].rotation.x, 
					"poleTargetLRy" : genRobotStructure["poleTargetL"].rotation.y, 
					"poleTargetLRz" :genRobotStructure["poleTargetL"].rotation.z,
					"footRRx" : genRobotStructure["footR"].rotation.x, 
					"footRRy" : genRobotStructure["footR"].rotation.y, 
					"footRRz" :genRobotStructure["footR"].rotation.z,
					"poleTargetRRx" : genRobotStructure["poleTargetR"].rotation.x, 
					"poleTargetRRy" : genRobotStructure["poleTargetR"].rotation.y, 
					"poleTargetRRz" :genRobotStructure["poleTargetR"].rotation.z
				};

				var updateFunction = createUpdateFunction(genRobotStructure);

				var idleAEnemy = new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090 + Math.PI /12,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090 + Math.PI /12,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799 ,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 500);

				var idleBEnemy = new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166 + 0.02,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799 ,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 1000).repeat(Infinity).yoyo(true);

				idleAEnemy.onUpdate(updateFunction);
				idleAEnemy.onComplete(getOnCompleteHandler(idleBEnemy));
				tweens["idleA"] = idleAEnemy;
				idleBEnemy.onUpdate(updateFunction);
				tweens["idleB"] = idleBEnemy;

				var runAEnemy = new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895 - Math.PI/3,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121 + Math.PI/9,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889 + Math.PI/3,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121 - Math.PI/9,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860 + 0.02,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090 + Math.PI/3,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864 + Math.PI/4,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090 - Math.PI/3,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180 - Math.PI/4,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 250);

				var runBEnemy= new TWEEN.Tween(initialRotations).to({
					"rootJointRx" : 0.0000,
					"rootJointRy" : 0.0000,
					"rootJointRz" : 0.0000,
					"boneRx" : 1.5708,
					"boneRy" : 0.0000,
					"boneRz" : -0.0000,
					"footLRx" : -4.6799,
					"footLRy" : 0.0000,
					"footLRz" : 3.1416,
					"bodyRx" : 0.2855,
					"bodyRy" : 0.0000,
					"bodyRz" : -0.0000,
					"upperLegLRx" : 2.7895 + Math.PI/3,
					"upperLegLRy" : -0.1734,
					"upperLegLRz" : -0.0254,
					"lowerLegLRx" : 0.2121 - Math.PI/9,
					"lowerLegLRy" : 0.0000,
					"lowerLegLRz" : -0.0000,
					"upperLegRRx" : 2.7889 - Math.PI/3,
					"upperLegRRy" : 0.2823,
					"upperLegRRz" : 0.0356,
					"lowerLegRRx" : 0.2121 + Math.PI/9,
					"lowerLegRRy" : -0.0000,
					"lowerLegRRz" : 0.0000,
					"hipsRx" : -0.2385,
					"hipsRy" : -0.0000,
					"hipsRz" : -0.0000,
					"abdomenRx" : 0.2308,
					"abdomenRy" : 0.0000,
					"abdomenRz" : 0.0000,
					"torsoRx" : 0.1166,
					"torsoRy" : -0.0000,
					"torsoRz" : 0.0000,
					"neckRx" : -0.0860 - 0.02,
					"neckRy" : -0.0308,
					"neckRz" : 0.0553,
					"headRx" : -0.3351,
					"headRy" : 0.0193,
					"headRz" : 0.0262,
					"shoulderRRx" : -0.1090 - Math.PI/3,
					"shoulderRRy" : -0.0000,
					"shoulderRRz" : 2.6864 + Math.PI/4,
					"upperArmRRx" : 2.0772,
					"upperArmRRy" : 0.3936,
					"upperArmRRz" : -1.8977,
					"lowerArmRRx" : 1.6209,
					"lowerArmRRy" : -0.5227,
					"lowerArmRRz" : -2.9996,
					"thumbRRx" : 2.8878,
					"thumbRRy" : -0.9211,
					"thumbRRz" : 1.3133,
					"thumb2RRx" : -1.7178,
					"thumb2RRy" : -0.6391,
					"thumb2RRz" : -2.9502,
					"palm2RRx" : -0.0222,
					"palm2RRy" : -0.1657,
					"palm2RRz" : 0.6589,
					"middle1RRx" : -0.0636,
					"middle1RRy" : -0.0635,
					"middle1RRz" : 1.1049,
					"middle2RRx" : 0.0997,
					"middle2RRy" : -0.0320,
					"middle2RRz" : 1.0613,
					"palm1RRx" : -1.7964,
					"palm1RRy" : 0.8086,
					"palm1RRz" : 2.0645,
					"indexRRx" : -1.9069,
					"indexRRy" : -1.0366,
					"indexRRz" : -0.9294,
					"index2RRx" : -0.0585,
					"index2RRy" : -0.0646,
					"index2RRz" : 1.1100,
					"palm3RRx" : 2.1885,
					"palm3RRy" : -0.5323,
					"palm3RRz" : 2.5953,
					"ring1RRx" : 2.0308,
					"ring1RRy" : 0.9081,
					"ring1RRz" : -0.9431,
					"ring2RRx" : 0.2315,
					"ring2RRy" : 0.1636,
					"ring2RRz" : 0.8729,
					"shoulderLRx" : -0.1090 + Math.PI/3,
					"shoulderLRy" : -0.0000,
					"shoulderLRz" : -2.7180 - Math.PI/4,
					"upperArmLRx" : 1.7087,
					"upperArmLRy" : -0.4337,
					"upperArmLRz" : 2.0614,
					"lowerArmLRx" : 1.4986,
					"lowerArmLRy" : -0.4114,
					"lowerArmLRz" : -3.1196,
					"palm2LRx" : -0.0025,
					"palm2LRy" : 0.0133,
					"palm2LRz" : -0.6631,
					"middle1LRx" : 0.0190,
					"middle1LRy" : 0.0446,
					"middle1LRz" : -1.1705,
					"middle2LRx" : -0.0532,
					"middle2LRy" : 0.0547,
					"middle2LRz" : -1.5498,
					"thumbLRx" : -3.0654,
					"thumbLRy" : 0.5048,
					"thumbLRz" : -1.4522,
					"thumb2LRx" : -1.4232,
					"thumb2LRy" : -0.9182,
					"thumb2LRz" : -2.8564,
					"palm1LRx" : 0.7827,
					"palm1LRy" : 0.3751,
					"palm1LRz" : -0.6223,
					"indexLRx" : -0.5316,
					"indexLRy" : -0.6584,
					"indexLRz" : -1.5806,
					"index2LRx" : -0.0866,
					"index2LRy" : 0.0334,
					"index2LRz" : -1.5514,
					"palm3LRx" : -0.9059,
					"palm3LRy" : -0.4760,
					"palm3LRz" : -0.6485,
					"ring1LRx" : 0.7377,
					"ring1LRy" : 0.7843,
					"ring1LRz" : -1.7830,
					"ring2LRx" : -0.0866,
					"ring2LRy" : 0.0334,
					"ring2LRz" : -1.5514,
					"poleTargetLRx" : 0.0000,
					"poleTargetLRy" : 0.0000,
					"poleTargetLRz" : -0.0000,
					"footRRx" : -4.6799,
					"footRRy" : 0.0000,
					"footRRz" : 3.1416,
					"poleTargetRRx" : 0.0000,
					"poleTargetRRy" : 0.0000,
					"poleTargetRRz" : -0.0000
				}, 250);


				runAEnemy.onComplete(getOnCompleteHandler(runBEnemy));
				runBEnemy.onComplete(getOnCompleteHandler(runAEnemy));


				runAEnemy.onUpdate(updateFunction);
				runBEnemy.onUpdate(updateFunction);

				tweens["runA"] = runAEnemy;
				tweens["runB"] = runBEnemy;
				
				var genRobot = {"mesh" : genRobotMesh, "body" : genRobotBody, "model": robotModelParent, "state": "IDLE", "tweens": tweens};
				robots.push(genRobot);

				idleAEnemy.start();

				genRobotBody.addEventListener("collide", robotColliderEvent(genRobot));
			}
		});

		gltfLoader.load("gltf/archer/scene.gltf", (gltf) => {
			archerModel = gltf.scene.getObjectByName("Sketchfab_Scene");

			archerModel.scale.setScalar( 1.7 );
			//Creating a parent to move the archerModel through its center and rotate it in the correct direction
			archerModelParent = new THREE.Object3D();
			archerModel.getWorldPosition(archerModelParent.position);
			archerModel.position.set(0, -cubeMesh.geometry.parameters.height/2, 0);
			archerModel.rotation.set(...[0,Math.PI,0]);
			archerModelParent.add(archerModel);
			scene.add(archerModelParent);
			// console.log(dumpObject(archerModel).join('\n'));

			gltf.scene.traverse( function( node ) {
				if (node.isMesh) { 
					node.castShadow = true;
					node.receiveShadow=true;
					node.frustumCulled=false;
			}
			} );

			//Setting only the basic animation, after we're going to animate it ourserlves
			const animations = gltf.animations;
			mixer = new THREE.AnimationMixer(archerModel);

			mixer.clipAction(animations[2]).play();
			if (mixer) mixer.update();
			
			//Set the components useful for creating animations with TweenJS
			populateArcherStructure();

			changePlayerState("Idle");
			archerStructure["rightArm"].rotation.z += Math.PI/2.3;
			archerStructure["leftArm"].rotation.z -= Math.PI/2.3;
			archerStructure["rightHandPinky2"].rotation.z = Math.PI/3;
			archerStructure["rightHandPinky3"].rotation.z = Math.PI/3; 
			archerStructure["rightHandPinky4"].rotation.z = Math.PI/3; 
			archerStructure["rightHandRing2"].rotation.z = Math.PI/3; 
			archerStructure["rightHandRing3"].rotation.z = Math.PI/3; 
			archerStructure["rightHandRing4"].rotation.z = Math.PI/3; 
			archerStructure["rightHandMiddle2"].rotation.z = Math.PI/3; 
			archerStructure["rightHandMiddle3"].rotation.z = Math.PI/3; 
			archerStructure["rightHandMiddle4"].rotation.z = Math.PI/3; 
			archerStructure["rightHandIndex2"].rotation.z = Math.PI/3; 
			archerStructure["rightHandIndex3"].rotation.z = Math.PI/3; 
			archerStructure["rightHandIndex4"].rotation.z = Math.PI/3; 
			archerStructure["rightHandThumb2"].rotation.y = -Math.PI/4; 
			archerStructure["rightHandThumb3"].rotation.y = -Math.PI/4; 
			archerStructure["rightHandThumb4"].rotation.y = -Math.PI/4;
			archerStructure["rightHandThumb2"].rotation.z = -Math.PI/12; 
			archerStructure["rightHandThumb3"].rotation.z = -Math.PI/12; 
			archerStructure["rightHandThumb4"].rotation.z = -Math.PI/12; 
			archerStructure["leftHandPinky2"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandPinky3"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandPinky4"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandRing2"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandRing3"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandRing4"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandMiddle2"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandMiddle3"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandMiddle4"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandIndex2"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandIndex3"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandIndex4"].rotation.z = -Math.PI/3; 
			archerStructure["leftHandThumb2"].rotation.y = Math.PI/4; 
			archerStructure["leftHandThumb3"].rotation.y = Math.PI/4; 
			archerStructure["leftHandThumb4"].rotation.y = Math.PI/4;
			archerStructure["leftHandThumb2"].rotation.z = Math.PI/12; 
			archerStructure["leftHandThumb3"].rotation.z = Math.PI/12; 
			archerStructure["leftHandThumb4"].rotation.z = Math.PI/12; 
			var out = "";
			// Object.keys(archerStructure).forEach(key => {
			// out += ('"'+ key + 'Rx": ' + archerStructure[key].rotation.x.toFixed(4) + ',' +'"'+ key + 'Ry": ' + archerStructure[key].rotation.y.toFixed(4) + ',' + '"'+ key + 'Rz": ' + archerStructure[key].rotation.z.toFixed(4) + ', \n');				
			// });			
			// Object.keys(archerStructure).forEach(key => {
			// out += ('"'+ key + 'Rx": ' + 'archerStructure["'+ key + '"].rotation.x' + ',' +'"'+ key + 'Ry": ' + 'archerStructure["'+ key + '"].rotation.y' + ',' + '"'+ key + 'Rz": ' + 'archerStructure["'+ key + '"].rotation.z'+ ', \n');				
			// });			
			// Object.keys(archerStructure).forEach(key => {
			// out += ('archerStructure["'+ key + '"].rotation.x = ' + 'object["'+ key + 'Rx"]' +  ';' +'archerStructure["'+ key + '"].rotation.y = ' + 'object["'+ key + 'Ry"]' + ';' + 'archerStructure["'+ key + '"].rotation.z = ' + 'object["'+ key + 'Rz"]' +  '; \n');				
			// });

			
			//TWEEN ANIMATIONS
			//var groupPlayer = new TWEEN.Group();
			targetMovement1 = new TWEEN.Tween({x:-10}).to({x:-2}, 4000).onUpdate((object)=>{if(targetBody1)targetBody1.position.x= object.x;});
			targetMovement1.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Bounce.InOut);
			targetMovement1.start();

			targetMovement2 = new TWEEN.Tween({x:10}).to({x:2}, 4000).onUpdate((object)=>{if(targetBody2)targetBody2.position.x= object.x;});
			targetMovement2.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Bounce.InOut);
			targetMovement2.start();

			targetMovement3 = new TWEEN.Tween({x:-10}).to({x:-2}, 4000).onUpdate((object)=>{if(targetBody3)targetBody3.position.x= object.x;});
			targetMovement3.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Back.InOut);
			targetMovement3.start();

			targetMovement4 = new TWEEN.Tween({x:10}).to({x:2}, 4000).onUpdate((object)=>{if(targetBody4)targetBody4.position.x= object.x;});
			targetMovement4.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Back.InOut);
			targetMovement4.start();
			


			var obsPlatStarts = [new THREE.Vector3(15, 0, 0), new THREE.Vector3(-15, 0, 0), new THREE.Vector3(0, 0, 10) ];
			var obsPlatEnds = [new THREE.Vector3(-15, 0, 0), new THREE.Vector3(15, 0, 0), new THREE.Vector3(0, 0, -10) ];
			var genFun = function (i){return (object)=>{if(obsPlat[i] && (obsPlat[i])["body"]){obsPlat[i]["body"].velocity.x = object["x"]; obsPlat[i]["body"].velocity.y = object["y"]; obsPlat[i]["body"].velocity.z = object["z"];}}};
			for(var i=0; i<3; i++){
				var genTween = new TWEEN.Tween({"x" : obsPlatStarts[i].x, "y" : obsPlatStarts[i].y, "z" : obsPlatStarts[i].z}).to({"x" : obsPlatEnds[i].x, "y" : obsPlatEnds[i].y, "z" : obsPlatEnds[i].z}, 4000).onUpdate(genFun(i));
				genTween.repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Exponential.InOut);
				obsPlatTweens.push(genTween)
				genTween.start();
			}

			level2Unlock = new TWEEN.Tween({theta:Math.PI/2}).to({theta:0}, 4000).onUpdate((object)=>{		level2PlatformBody.quaternion.setFromEuler(object.theta, Math.PI/6, 0)});
			level2Unlock.easing(TWEEN.Easing.Bounce.Out);

			level3Unlock1 = new TWEEN.Tween({x:-20}).to({x:-2.5}, 4000).onUpdate((object)=>{obsPlat[3]["body"].position.x= object.x;});
			level3Unlock1.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock2 = new TWEEN.Tween({x:20}).to({x:2.5}, 4000).onUpdate((object)=>{obsPlat[4]["body"].position.x= object.x;});
			level3Unlock2.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock3 = new TWEEN.Tween({y:0, x: -20}).to({y:2, x: -2.5}, 4000).onUpdate((object)=>{obsPlat[5]["body"].position.y= object.y;obsPlat[5]["body"].position.x= object.x;});
			level3Unlock3.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock4 = new TWEEN.Tween({y:0, x: 20}).to({y:2, x: 2.5}, 4000).onUpdate((object)=>{obsPlat[6]["body"].position.y= object.y;obsPlat[6]["body"].position.x= object.x;});
			level3Unlock4.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock5 = new TWEEN.Tween({y:0, x: -20}).to({y:4, x: -2.5}, 4000).onUpdate((object)=>{obsPlat[7]["body"].position.y= object.y;obsPlat[7]["body"].position.x= object.x;});
			level3Unlock5.easing(TWEEN.Easing.Bounce.Out);
			level3Unlock6 = new TWEEN.Tween({y:0, x: 20}).to({y:4, x: 2.5}, 4000).onUpdate((object)=>{obsPlat[8]["body"].position.y= object.y;obsPlat[8]["body"].position.x= object.x;});
			level3Unlock6.easing(TWEEN.Easing.Bounce.Out);
			
			var startRotations ={"hipsRx" : archerStructure["hips"].rotation.x, "hipsRy" : archerStructure["hips"].rotation.y, "hipsRz" : archerStructure["hips"].rotation.z,
								"spineRx" : archerStructure["spine"].rotation.x, "spineRy" : archerStructure["spine"].rotation.y, "spineRz" : archerStructure["spine"].rotation.z,
								"spine1Rx" : archerStructure["spine1"].rotation.x, "spine1Ry" : archerStructure["spine1"].rotation.y, "spine1Rz" : archerStructure["spine1"].rotation.z,
								"spine2Rx" : archerStructure["spine2"].rotation.x, "spine2Ry" : archerStructure["spine2"].rotation.y, "spine2Rz" : archerStructure["spine2"].rotation.z,
								"neckRx" : archerStructure["neck"].rotation.x, "neckRy" : archerStructure["neck"].rotation.y, "neckRz" : archerStructure["neck"].rotation.z,
								"headRx" : archerStructure["head"].rotation.x, "headRy" : archerStructure["head"].rotation.y, "headRz" : archerStructure["head"].rotation.z,
								"rightEyeRx" : archerStructure["rightEye"].rotation.x, "rightEyeRy" : archerStructure["rightEye"].rotation.y, "rightEyeRz" : archerStructure["rightEye"].rotation.z,
								"leftEyeRx" : archerStructure["leftEye"].rotation.x, "leftEyeRy" : archerStructure["leftEye"].rotation.y, "leftEyeRz" : archerStructure["leftEye"].rotation.z,
								"headTop_EndRx" : archerStructure["headTop_End"].rotation.x, "headTop_EndRy" : archerStructure["headTop_End"].rotation.y, "headTop_EndRz" : archerStructure["headTop_End"].rotation.z,
								"leftShoulderRx" : archerStructure["leftShoulder"].rotation.x, "leftShoulderRy" : archerStructure["leftShoulder"].rotation.y, "leftShoulderRz" : archerStructure["leftShoulder"].rotation.z,
								"leftArmRx" : archerStructure["leftArm"].rotation.x, "leftArmRy" : archerStructure["leftArm"].rotation.y, "leftArmRz" : archerStructure["leftArm"].rotation.z,
								"leftForeArmRx" : archerStructure["leftForeArm"].rotation.x, "leftForeArmRy" : archerStructure["leftForeArm"].rotation.y, "leftForeArmRz" : archerStructure["leftForeArm"].rotation.z,
								"leftHandRx" : archerStructure["leftHand"].rotation.x, "leftHandRy" : archerStructure["leftHand"].rotation.y, "leftHandRz" : archerStructure["leftHand"].rotation.z,
								"leftHandThumb1Rx" : archerStructure["leftHandThumb1"].rotation.x, "leftHandThumb1Ry" : archerStructure["leftHandThumb1"].rotation.y, "leftHandThumb1Rz" : archerStructure["leftHandThumb1"].rotation.z,
								"leftHandThumb2Rx" : archerStructure["leftHandThumb2"].rotation.x, "leftHandThumb2Ry" : archerStructure["leftHandThumb2"].rotation.y, "leftHandThumb2Rz" : archerStructure["leftHandThumb2"].rotation.z,
								"leftHandThumb3Rx" : archerStructure["leftHandThumb3"].rotation.x, "leftHandThumb3Ry" : archerStructure["leftHandThumb3"].rotation.y, "leftHandThumb3Rz" : archerStructure["leftHandThumb3"].rotation.z,
								"leftHandThumb4Rx" : archerStructure["leftHandThumb4"].rotation.x, "leftHandThumb4Ry" : archerStructure["leftHandThumb4"].rotation.y, "leftHandThumb4Rz" : archerStructure["leftHandThumb4"].rotation.z,
								"leftHandIndex1Rx" : archerStructure["leftHandIndex1"].rotation.x, "leftHandIndex1Ry" : archerStructure["leftHandIndex1"].rotation.y, "leftHandIndex1Rz" : archerStructure["leftHandIndex1"].rotation.z,
								"leftHandIndex2Rx" : archerStructure["leftHandIndex2"].rotation.x, "leftHandIndex2Ry" : archerStructure["leftHandIndex2"].rotation.y, "leftHandIndex2Rz" : archerStructure["leftHandIndex2"].rotation.z,
								"leftHandIndex3Rx" : archerStructure["leftHandIndex3"].rotation.x, "leftHandIndex3Ry" : archerStructure["leftHandIndex3"].rotation.y, "leftHandIndex3Rz" : archerStructure["leftHandIndex3"].rotation.z,
								"leftHandIndex4Rx" : archerStructure["leftHandIndex4"].rotation.x, "leftHandIndex4Ry" : archerStructure["leftHandIndex4"].rotation.y, "leftHandIndex4Rz" : archerStructure["leftHandIndex4"].rotation.z,
								"leftHandMiddle1Rx" : archerStructure["leftHandMiddle1"].rotation.x, "leftHandMiddle1Ry" : archerStructure["leftHandMiddle1"].rotation.y, "leftHandMiddle1Rz" : archerStructure["leftHandMiddle1"].rotation.z,
								"leftHandMiddle2Rx" : archerStructure["leftHandMiddle2"].rotation.x, "leftHandMiddle2Ry" : archerStructure["leftHandMiddle2"].rotation.y, "leftHandMiddle2Rz" : archerStructure["leftHandMiddle2"].rotation.z,
								"leftHandMiddle3Rx" : archerStructure["leftHandMiddle3"].rotation.x, "leftHandMiddle3Ry" : archerStructure["leftHandMiddle3"].rotation.y, "leftHandMiddle3Rz" : archerStructure["leftHandMiddle3"].rotation.z,
								"leftHandMiddle4Rx" : archerStructure["leftHandMiddle4"].rotation.x, "leftHandMiddle4Ry" : archerStructure["leftHandMiddle4"].rotation.y, "leftHandMiddle4Rz" : archerStructure["leftHandMiddle4"].rotation.z,
								"leftHandRing1Rx" : archerStructure["leftHandRing1"].rotation.x, "leftHandRing1Ry" : archerStructure["leftHandRing1"].rotation.y, "leftHandRing1Rz" : archerStructure["leftHandRing1"].rotation.z,
								"leftHandRing2Rx" : archerStructure["leftHandRing2"].rotation.x, "leftHandRing2Ry" : archerStructure["leftHandRing2"].rotation.y, "leftHandRing2Rz" : archerStructure["leftHandRing2"].rotation.z,
								"leftHandRing3Rx" : archerStructure["leftHandRing3"].rotation.x, "leftHandRing3Ry" : archerStructure["leftHandRing3"].rotation.y, "leftHandRing3Rz" : archerStructure["leftHandRing3"].rotation.z,
								"leftHandRing4Rx" : archerStructure["leftHandRing4"].rotation.x, "leftHandRing4Ry" : archerStructure["leftHandRing4"].rotation.y, "leftHandRing4Rz" : archerStructure["leftHandRing4"].rotation.z,
								"leftHandPinky1Rx" : archerStructure["leftHandPinky1"].rotation.x, "leftHandPinky1Ry" : archerStructure["leftHandPinky1"].rotation.y, "leftHandPinky1Rz" : archerStructure["leftHandPinky1"].rotation.z,
								"leftHandPinky2Rx" : archerStructure["leftHandPinky2"].rotation.x, "leftHandPinky2Ry" : archerStructure["leftHandPinky2"].rotation.y, "leftHandPinky2Rz" : archerStructure["leftHandPinky2"].rotation.z,
								"leftHandPinky3Rx" : archerStructure["leftHandPinky3"].rotation.x, "leftHandPinky3Ry" : archerStructure["leftHandPinky3"].rotation.y, "leftHandPinky3Rz" : archerStructure["leftHandPinky3"].rotation.z,
								"leftHandPinky4Rx" : archerStructure["leftHandPinky4"].rotation.x, "leftHandPinky4Ry" : archerStructure["leftHandPinky4"].rotation.y, "leftHandPinky4Rz" : archerStructure["leftHandPinky4"].rotation.z,
								"rightShoulderRx" : archerStructure["rightShoulder"].rotation.x, "rightShoulderRy" : archerStructure["rightShoulder"].rotation.y, "rightShoulderRz" : archerStructure["rightShoulder"].rotation.z,
								"rightArmRx" : archerStructure["rightArm"].rotation.x, "rightArmRy" : archerStructure["rightArm"].rotation.y, "rightArmRz" : archerStructure["rightArm"].rotation.z,
								"rightForeArmRx" : archerStructure["rightForeArm"].rotation.x, "rightForeArmRy" : archerStructure["rightForeArm"].rotation.y, "rightForeArmRz" : archerStructure["rightForeArm"].rotation.z,
								"rightHandRx" : archerStructure["rightHand"].rotation.x, "rightHandRy" : archerStructure["rightHand"].rotation.y, "rightHandRz" : archerStructure["rightHand"].rotation.z,
								"rightHandPinky1Rx" : archerStructure["rightHandPinky1"].rotation.x, "rightHandPinky1Ry" : archerStructure["rightHandPinky1"].rotation.y, "rightHandPinky1Rz" : archerStructure["rightHandPinky1"].rotation.z,
								"rightHandPinky2Rx" : archerStructure["rightHandPinky2"].rotation.x, "rightHandPinky2Ry" : archerStructure["rightHandPinky2"].rotation.y, "rightHandPinky2Rz" : archerStructure["rightHandPinky2"].rotation.z,
								"rightHandPinky3Rx" : archerStructure["rightHandPinky3"].rotation.x, "rightHandPinky3Ry" : archerStructure["rightHandPinky3"].rotation.y, "rightHandPinky3Rz" : archerStructure["rightHandPinky3"].rotation.z,
								"rightHandPinky4Rx" : archerStructure["rightHandPinky4"].rotation.x, "rightHandPinky4Ry" : archerStructure["rightHandPinky4"].rotation.y, "rightHandPinky4Rz" : archerStructure["rightHandPinky4"].rotation.z,
								"rightHandRing1Rx" : archerStructure["rightHandRing1"].rotation.x, "rightHandRing1Ry" : archerStructure["rightHandRing1"].rotation.y, "rightHandRing1Rz" : archerStructure["rightHandRing1"].rotation.z,
								"rightHandRing2Rx" : archerStructure["rightHandRing2"].rotation.x, "rightHandRing2Ry" : archerStructure["rightHandRing2"].rotation.y, "rightHandRing2Rz" : archerStructure["rightHandRing2"].rotation.z,
								"rightHandRing3Rx" : archerStructure["rightHandRing3"].rotation.x, "rightHandRing3Ry" : archerStructure["rightHandRing3"].rotation.y, "rightHandRing3Rz" : archerStructure["rightHandRing3"].rotation.z,
								"rightHandRing4Rx" : archerStructure["rightHandRing4"].rotation.x, "rightHandRing4Ry" : archerStructure["rightHandRing4"].rotation.y, "rightHandRing4Rz" : archerStructure["rightHandRing4"].rotation.z,
								"rightHandMiddle1Rx" : archerStructure["rightHandMiddle1"].rotation.x, "rightHandMiddle1Ry" : archerStructure["rightHandMiddle1"].rotation.y, "rightHandMiddle1Rz" : archerStructure["rightHandMiddle1"].rotation.z,
								"rightHandMiddle2Rx" : archerStructure["rightHandMiddle2"].rotation.x, "rightHandMiddle2Ry" : archerStructure["rightHandMiddle2"].rotation.y, "rightHandMiddle2Rz" : archerStructure["rightHandMiddle2"].rotation.z,
								"rightHandMiddle3Rx" : archerStructure["rightHandMiddle3"].rotation.x, "rightHandMiddle3Ry" : archerStructure["rightHandMiddle3"].rotation.y, "rightHandMiddle3Rz" : archerStructure["rightHandMiddle3"].rotation.z,
								"rightHandMiddle4Rx" : archerStructure["rightHandMiddle4"].rotation.x, "rightHandMiddle4Ry" : archerStructure["rightHandMiddle4"].rotation.y, "rightHandMiddle4Rz" : archerStructure["rightHandMiddle4"].rotation.z,
								"rightHandIndex1Rx" : archerStructure["rightHandIndex1"].rotation.x, "rightHandIndex1Ry" : archerStructure["rightHandIndex1"].rotation.y, "rightHandIndex1Rz" : archerStructure["rightHandIndex1"].rotation.z,
								"rightHandIndex2Rx" : archerStructure["rightHandIndex2"].rotation.x, "rightHandIndex2Ry" : archerStructure["rightHandIndex2"].rotation.y, "rightHandIndex2Rz" : archerStructure["rightHandIndex2"].rotation.z,
								"rightHandIndex3Rx" : archerStructure["rightHandIndex3"].rotation.x, "rightHandIndex3Ry" : archerStructure["rightHandIndex3"].rotation.y, "rightHandIndex3Rz" : archerStructure["rightHandIndex3"].rotation.z,
								"rightHandIndex4Rx" : archerStructure["rightHandIndex4"].rotation.x, "rightHandIndex4Ry" : archerStructure["rightHandIndex4"].rotation.y, "rightHandIndex4Rz" : archerStructure["rightHandIndex4"].rotation.z,
								"rightHandThumb1Rx" : archerStructure["rightHandThumb1"].rotation.x, "rightHandThumb1Ry" : archerStructure["rightHandThumb1"].rotation.y, "rightHandThumb1Rz" : archerStructure["rightHandThumb1"].rotation.z,
								"rightHandThumb2Rx" : archerStructure["rightHandThumb2"].rotation.x, "rightHandThumb2Ry" : archerStructure["rightHandThumb2"].rotation.y, "rightHandThumb2Rz" : archerStructure["rightHandThumb2"].rotation.z,
								"rightHandThumb3Rx" : archerStructure["rightHandThumb3"].rotation.x, "rightHandThumb3Ry" : archerStructure["rightHandThumb3"].rotation.y, "rightHandThumb3Rz" : archerStructure["rightHandThumb3"].rotation.z,
								"rightHandThumb4Rx" : archerStructure["rightHandThumb4"].rotation.x, "rightHandThumb4Ry" : archerStructure["rightHandThumb4"].rotation.y, "rightHandThumb4Rz" : archerStructure["rightHandThumb4"].rotation.z,
								"leftUpLegRx" : archerStructure["leftUpLeg"].rotation.x, "leftUpLegRy" : archerStructure["leftUpLeg"].rotation.y, "leftUpLegRz" : archerStructure["leftUpLeg"].rotation.z,
								"leftLegRx" : archerStructure["leftLeg"].rotation.x, "leftLegRy" : archerStructure["leftLeg"].rotation.y, "leftLegRz" : archerStructure["leftLeg"].rotation.z,
								"leftFootRx" : archerStructure["leftFoot"].rotation.x, "leftFootRy" : archerStructure["leftFoot"].rotation.y, "leftFootRz" : archerStructure["leftFoot"].rotation.z,
								"leftToeBaseRx" : archerStructure["leftToeBase"].rotation.x, "leftToeBaseRy" : archerStructure["leftToeBase"].rotation.y, "leftToeBaseRz" : archerStructure["leftToeBase"].rotation.z,
								"leftToe_EndRx" : archerStructure["leftToe_End"].rotation.x, "leftToe_EndRy" : archerStructure["leftToe_End"].rotation.y, "leftToe_EndRz" : archerStructure["leftToe_End"].rotation.z,
								"rightUpLegRx" : archerStructure["rightUpLeg"].rotation.x, "rightUpLegRy" : archerStructure["rightUpLeg"].rotation.y, "rightUpLegRz" : archerStructure["rightUpLeg"].rotation.z,
								"rightLegRx" : archerStructure["rightLeg"].rotation.x, "rightLegRy" : archerStructure["rightLeg"].rotation.y, "rightLegRz" : archerStructure["rightLeg"].rotation.z,
								"rightFootRx" : archerStructure["rightFoot"].rotation.x, "rightFootRy" : archerStructure["rightFoot"].rotation.y, "rightFootRz" : archerStructure["rightFoot"].rotation.z,
								"rightToeBaseRx" : archerStructure["rightToeBase"].rotation.x, "rightToeBaseRy" : archerStructure["rightToeBase"].rotation.y, "rightToeBaseRz" : archerStructure["rightToeBase"].rotation.z,
								"rightToe_EndRx" : archerStructure["rightToe_End"].rotation.x, "rightToe_EndRy" : archerStructure["rightToe_End"].rotation.y, "rightToe_EndRz" : archerStructure["rightToe_End"].rotation.z
								};
			
			const updateFunction = function (object, elapsedTime) {
				//If the player is not shooting then you can move the upper part of the body
				if(canShoot){
					archerStructure["neck"].rotation.x = object["neckRx"];  archerStructure["neck"].rotation.y = object["neckRy"];  archerStructure["neck"].rotation.z = object["neckRz"];  
					archerStructure["head"].rotation.x = object["headRx"];  archerStructure["head"].rotation.y = object["headRy"];  archerStructure["head"].rotation.z = object["headRz"];  
					archerStructure["headTop_End"].rotation.x = object["headTop_EndRx"];  archerStructure["headTop_End"].rotation.y = object["headTop_EndRy"];  archerStructure["headTop_End"].rotation.z = object["headTop_EndRz"];  
					archerStructure["leftShoulder"].rotation.x = object["leftShoulderRx"];  archerStructure["leftShoulder"].rotation.y = object["leftShoulderRy"];  archerStructure["leftShoulder"].rotation.z = object["leftShoulderRz"];  
					archerStructure["leftArm"].rotation.x = object["leftArmRx"];  archerStructure["leftArm"].rotation.y = object["leftArmRy"];  archerStructure["leftArm"].rotation.z = object["leftArmRz"];  
					archerStructure["leftForeArm"].rotation.x = object["leftForeArmRx"];  archerStructure["leftForeArm"].rotation.y = object["leftForeArmRy"];  archerStructure["leftForeArm"].rotation.z = object["leftForeArmRz"];  
					archerStructure["leftHand"].rotation.x = object["leftHandRx"];  archerStructure["leftHand"].rotation.y = object["leftHandRy"];  archerStructure["leftHand"].rotation.z = object["leftHandRz"];  
					archerStructure["leftHandThumb1"].rotation.x = object["leftHandThumb1Rx"];  archerStructure["leftHandThumb1"].rotation.y = object["leftHandThumb1Ry"];  archerStructure["leftHandThumb1"].rotation.z = object["leftHandThumb1Rz"];  
					archerStructure["leftHandThumb2"].rotation.x = object["leftHandThumb2Rx"];  archerStructure["leftHandThumb2"].rotation.y = object["leftHandThumb2Ry"];  archerStructure["leftHandThumb2"].rotation.z = object["leftHandThumb2Rz"];  
					archerStructure["leftHandThumb3"].rotation.x = object["leftHandThumb3Rx"];  archerStructure["leftHandThumb3"].rotation.y = object["leftHandThumb3Ry"];  archerStructure["leftHandThumb3"].rotation.z = object["leftHandThumb3Rz"];  
					archerStructure["leftHandThumb4"].rotation.x = object["leftHandThumb4Rx"];  archerStructure["leftHandThumb4"].rotation.y = object["leftHandThumb4Ry"];  archerStructure["leftHandThumb4"].rotation.z = object["leftHandThumb4Rz"];  
					archerStructure["leftHandIndex1"].rotation.x = object["leftHandIndex1Rx"];  archerStructure["leftHandIndex1"].rotation.y = object["leftHandIndex1Ry"];  archerStructure["leftHandIndex1"].rotation.z = object["leftHandIndex1Rz"];  
					archerStructure["leftHandIndex2"].rotation.x = object["leftHandIndex2Rx"];  archerStructure["leftHandIndex2"].rotation.y = object["leftHandIndex2Ry"];  archerStructure["leftHandIndex2"].rotation.z = object["leftHandIndex2Rz"];  
					archerStructure["leftHandIndex3"].rotation.x = object["leftHandIndex3Rx"];  archerStructure["leftHandIndex3"].rotation.y = object["leftHandIndex3Ry"];  archerStructure["leftHandIndex3"].rotation.z = object["leftHandIndex3Rz"];  
					archerStructure["leftHandIndex4"].rotation.x = object["leftHandIndex4Rx"];  archerStructure["leftHandIndex4"].rotation.y = object["leftHandIndex4Ry"];  archerStructure["leftHandIndex4"].rotation.z = object["leftHandIndex4Rz"];  
					archerStructure["leftHandMiddle1"].rotation.x = object["leftHandMiddle1Rx"];  archerStructure["leftHandMiddle1"].rotation.y = object["leftHandMiddle1Ry"];  archerStructure["leftHandMiddle1"].rotation.z = object["leftHandMiddle1Rz"];  
					archerStructure["leftHandMiddle2"].rotation.x = object["leftHandMiddle2Rx"];  archerStructure["leftHandMiddle2"].rotation.y = object["leftHandMiddle2Ry"];  archerStructure["leftHandMiddle2"].rotation.z = object["leftHandMiddle2Rz"];  
					archerStructure["leftHandMiddle3"].rotation.x = object["leftHandMiddle3Rx"];  archerStructure["leftHandMiddle3"].rotation.y = object["leftHandMiddle3Ry"];  archerStructure["leftHandMiddle3"].rotation.z = object["leftHandMiddle3Rz"];  
					archerStructure["leftHandMiddle4"].rotation.x = object["leftHandMiddle4Rx"];  archerStructure["leftHandMiddle4"].rotation.y = object["leftHandMiddle4Ry"];  archerStructure["leftHandMiddle4"].rotation.z = object["leftHandMiddle4Rz"];  
					archerStructure["leftHandRing1"].rotation.x = object["leftHandRing1Rx"];  archerStructure["leftHandRing1"].rotation.y = object["leftHandRing1Ry"];  archerStructure["leftHandRing1"].rotation.z = object["leftHandRing1Rz"];  
					archerStructure["leftHandRing2"].rotation.x = object["leftHandRing2Rx"];  archerStructure["leftHandRing2"].rotation.y = object["leftHandRing2Ry"];  archerStructure["leftHandRing2"].rotation.z = object["leftHandRing2Rz"];  
					archerStructure["leftHandRing3"].rotation.x = object["leftHandRing3Rx"];  archerStructure["leftHandRing3"].rotation.y = object["leftHandRing3Ry"];  archerStructure["leftHandRing3"].rotation.z = object["leftHandRing3Rz"];  
					archerStructure["leftHandRing4"].rotation.x = object["leftHandRing4Rx"];  archerStructure["leftHandRing4"].rotation.y = object["leftHandRing4Ry"];  archerStructure["leftHandRing4"].rotation.z = object["leftHandRing4Rz"];  
					archerStructure["leftHandPinky1"].rotation.x = object["leftHandPinky1Rx"];  archerStructure["leftHandPinky1"].rotation.y = object["leftHandPinky1Ry"];  archerStructure["leftHandPinky1"].rotation.z = object["leftHandPinky1Rz"];  
					archerStructure["leftHandPinky2"].rotation.x = object["leftHandPinky2Rx"];  archerStructure["leftHandPinky2"].rotation.y = object["leftHandPinky2Ry"];  archerStructure["leftHandPinky2"].rotation.z = object["leftHandPinky2Rz"];  
					archerStructure["leftHandPinky3"].rotation.x = object["leftHandPinky3Rx"];  archerStructure["leftHandPinky3"].rotation.y = object["leftHandPinky3Ry"];  archerStructure["leftHandPinky3"].rotation.z = object["leftHandPinky3Rz"];  
					archerStructure["leftHandPinky4"].rotation.x = object["leftHandPinky4Rx"];  archerStructure["leftHandPinky4"].rotation.y = object["leftHandPinky4Ry"];  archerStructure["leftHandPinky4"].rotation.z = object["leftHandPinky4Rz"];  
					archerStructure["rightShoulder"].rotation.x = object["rightShoulderRx"];  archerStructure["rightShoulder"].rotation.y = object["rightShoulderRy"];  archerStructure["rightShoulder"].rotation.z = object["rightShoulderRz"];  
					archerStructure["rightArm"].rotation.x = object["rightArmRx"];  archerStructure["rightArm"].rotation.y = object["rightArmRy"];  archerStructure["rightArm"].rotation.z = object["rightArmRz"];  
					archerStructure["rightForeArm"].rotation.x = object["rightForeArmRx"];  archerStructure["rightForeArm"].rotation.y = object["rightForeArmRy"];  archerStructure["rightForeArm"].rotation.z = object["rightForeArmRz"];  
					archerStructure["rightHand"].rotation.x = object["rightHandRx"];  archerStructure["rightHand"].rotation.y = object["rightHandRy"];  archerStructure["rightHand"].rotation.z = object["rightHandRz"];  
					archerStructure["rightHandPinky1"].rotation.x = object["rightHandPinky1Rx"];  archerStructure["rightHandPinky1"].rotation.y = object["rightHandPinky1Ry"];  archerStructure["rightHandPinky1"].rotation.z = object["rightHandPinky1Rz"];  
					archerStructure["rightHandPinky2"].rotation.x = object["rightHandPinky2Rx"];  archerStructure["rightHandPinky2"].rotation.y = object["rightHandPinky2Ry"];  archerStructure["rightHandPinky2"].rotation.z = object["rightHandPinky2Rz"];  
					archerStructure["rightHandPinky3"].rotation.x = object["rightHandPinky3Rx"];  archerStructure["rightHandPinky3"].rotation.y = object["rightHandPinky3Ry"];  archerStructure["rightHandPinky3"].rotation.z = object["rightHandPinky3Rz"];  
					archerStructure["rightHandPinky4"].rotation.x = object["rightHandPinky4Rx"];  archerStructure["rightHandPinky4"].rotation.y = object["rightHandPinky4Ry"];  archerStructure["rightHandPinky4"].rotation.z = object["rightHandPinky4Rz"];  
					archerStructure["rightHandRing1"].rotation.x = object["rightHandRing1Rx"];  archerStructure["rightHandRing1"].rotation.y = object["rightHandRing1Ry"];  archerStructure["rightHandRing1"].rotation.z = object["rightHandRing1Rz"];  
					archerStructure["rightHandRing2"].rotation.x = object["rightHandRing2Rx"];  archerStructure["rightHandRing2"].rotation.y = object["rightHandRing2Ry"];  archerStructure["rightHandRing2"].rotation.z = object["rightHandRing2Rz"];  
					archerStructure["rightHandRing3"].rotation.x = object["rightHandRing3Rx"];  archerStructure["rightHandRing3"].rotation.y = object["rightHandRing3Ry"];  archerStructure["rightHandRing3"].rotation.z = object["rightHandRing3Rz"];  
					archerStructure["rightHandRing4"].rotation.x = object["rightHandRing4Rx"];  archerStructure["rightHandRing4"].rotation.y = object["rightHandRing4Ry"];  archerStructure["rightHandRing4"].rotation.z = object["rightHandRing4Rz"];  
					archerStructure["rightHandMiddle1"].rotation.x = object["rightHandMiddle1Rx"];  archerStructure["rightHandMiddle1"].rotation.y = object["rightHandMiddle1Ry"];  archerStructure["rightHandMiddle1"].rotation.z = object["rightHandMiddle1Rz"];  
					archerStructure["rightHandMiddle2"].rotation.x = object["rightHandMiddle2Rx"];  archerStructure["rightHandMiddle2"].rotation.y = object["rightHandMiddle2Ry"];  archerStructure["rightHandMiddle2"].rotation.z = object["rightHandMiddle2Rz"];  
					archerStructure["rightHandMiddle3"].rotation.x = object["rightHandMiddle3Rx"];  archerStructure["rightHandMiddle3"].rotation.y = object["rightHandMiddle3Ry"];  archerStructure["rightHandMiddle3"].rotation.z = object["rightHandMiddle3Rz"];  
					archerStructure["rightHandMiddle4"].rotation.x = object["rightHandMiddle4Rx"];  archerStructure["rightHandMiddle4"].rotation.y = object["rightHandMiddle4Ry"];  archerStructure["rightHandMiddle4"].rotation.z = object["rightHandMiddle4Rz"];  
					archerStructure["rightHandIndex1"].rotation.x = object["rightHandIndex1Rx"];  archerStructure["rightHandIndex1"].rotation.y = object["rightHandIndex1Ry"];  archerStructure["rightHandIndex1"].rotation.z = object["rightHandIndex1Rz"];  
					archerStructure["rightHandIndex2"].rotation.x = object["rightHandIndex2Rx"];  archerStructure["rightHandIndex2"].rotation.y = object["rightHandIndex2Ry"];  archerStructure["rightHandIndex2"].rotation.z = object["rightHandIndex2Rz"];  
					archerStructure["rightHandIndex3"].rotation.x = object["rightHandIndex3Rx"];  archerStructure["rightHandIndex3"].rotation.y = object["rightHandIndex3Ry"];  archerStructure["rightHandIndex3"].rotation.z = object["rightHandIndex3Rz"];  
					archerStructure["rightHandIndex4"].rotation.x = object["rightHandIndex4Rx"];  archerStructure["rightHandIndex4"].rotation.y = object["rightHandIndex4Ry"];  archerStructure["rightHandIndex4"].rotation.z = object["rightHandIndex4Rz"];  
					archerStructure["rightHandThumb1"].rotation.x = object["rightHandThumb1Rx"];  archerStructure["rightHandThumb1"].rotation.y = object["rightHandThumb1Ry"];  archerStructure["rightHandThumb1"].rotation.z = object["rightHandThumb1Rz"];  
					archerStructure["rightHandThumb2"].rotation.x = object["rightHandThumb2Rx"];  archerStructure["rightHandThumb2"].rotation.y = object["rightHandThumb2Ry"];  archerStructure["rightHandThumb2"].rotation.z = object["rightHandThumb2Rz"];  
					archerStructure["rightHandThumb3"].rotation.x = object["rightHandThumb3Rx"];  archerStructure["rightHandThumb3"].rotation.y = object["rightHandThumb3Ry"];  archerStructure["rightHandThumb3"].rotation.z = object["rightHandThumb3Rz"];  
					archerStructure["rightHandThumb4"].rotation.x = object["rightHandThumb4Rx"];  archerStructure["rightHandThumb4"].rotation.y = object["rightHandThumb4Ry"];  archerStructure["rightHandThumb4"].rotation.z = object["rightHandThumb4Rz"];   	
				}			
				archerStructure["hips"].rotation.x = object["hipsRx"];  archerStructure["hips"].rotation.y = object["hipsRy"];  archerStructure["hips"].rotation.z = object["hipsRz"];  
				archerStructure["spine"].rotation.x = object["spineRx"];  archerStructure["spine"].rotation.y = object["spineRy"];  archerStructure["spine"].rotation.z = object["spineRz"];  
				archerStructure["spine1"].rotation.x = object["spine1Rx"];  archerStructure["spine1"].rotation.y = object["spine1Ry"];  archerStructure["spine1"].rotation.z = object["spine1Rz"];  
				archerStructure["spine2"].rotation.x = object["spine2Rx"];  archerStructure["spine2"].rotation.y = object["spine2Ry"];  archerStructure["spine2"].rotation.z = object["spine2Rz"];  
				archerStructure["rightEye"].rotation.x = object["rightEyeRx"];  archerStructure["rightEye"].rotation.y = object["rightEyeRy"];  archerStructure["rightEye"].rotation.z = object["rightEyeRz"];  
				archerStructure["leftEye"].rotation.x = object["leftEyeRx"];  archerStructure["leftEye"].rotation.y = object["leftEyeRy"];  archerStructure["leftEye"].rotation.z = object["leftEyeRz"];  
				archerStructure["leftUpLeg"].rotation.x = object["leftUpLegRx"];  archerStructure["leftUpLeg"].rotation.y = object["leftUpLegRy"];  archerStructure["leftUpLeg"].rotation.z = object["leftUpLegRz"];  
				archerStructure["leftLeg"].rotation.x = object["leftLegRx"];  archerStructure["leftLeg"].rotation.y = object["leftLegRy"];  archerStructure["leftLeg"].rotation.z = object["leftLegRz"];  
				archerStructure["leftFoot"].rotation.x = object["leftFootRx"];  archerStructure["leftFoot"].rotation.y = object["leftFootRy"];  archerStructure["leftFoot"].rotation.z = object["leftFootRz"];  
				archerStructure["leftToeBase"].rotation.x = object["leftToeBaseRx"];  archerStructure["leftToeBase"].rotation.y = object["leftToeBaseRy"];  archerStructure["leftToeBase"].rotation.z = object["leftToeBaseRz"];  
				archerStructure["leftToe_End"].rotation.x = object["leftToe_EndRx"];  archerStructure["leftToe_End"].rotation.y = object["leftToe_EndRy"];  archerStructure["leftToe_End"].rotation.z = object["leftToe_EndRz"];  
				archerStructure["rightUpLeg"].rotation.x = object["rightUpLegRx"];  archerStructure["rightUpLeg"].rotation.y = object["rightUpLegRy"];  archerStructure["rightUpLeg"].rotation.z = object["rightUpLegRz"];  
				archerStructure["rightLeg"].rotation.x = object["rightLegRx"];  archerStructure["rightLeg"].rotation.y = object["rightLegRy"];  archerStructure["rightLeg"].rotation.z = object["rightLegRz"];  
				archerStructure["rightFoot"].rotation.x = object["rightFootRx"];  archerStructure["rightFoot"].rotation.y = object["rightFootRy"];  archerStructure["rightFoot"].rotation.z = object["rightFootRz"];  
				archerStructure["rightToeBase"].rotation.x = object["rightToeBaseRx"];  archerStructure["rightToeBase"].rotation.y = object["rightToeBaseRy"];  archerStructure["rightToeBase"].rotation.z = object["rightToeBaseRz"];  
				archerStructure["rightToe_End"].rotation.x = object["rightToe_EndRx"];  archerStructure["rightToe_End"].rotation.y = object["rightToe_EndRy"];  archerStructure["rightToe_End"].rotation.z = object["rightToe_EndRz"]; 
			};

			const updateFunctionUpper = function (object, elapsedTime) {
				archerStructure["neck"].rotation.x = object["neckRx"];  archerStructure["neck"].rotation.y = object["neckRy"];  archerStructure["neck"].rotation.z = object["neckRz"];  
				archerStructure["head"].rotation.x = object["headRx"];  archerStructure["head"].rotation.y = object["headRy"];  archerStructure["head"].rotation.z = object["headRz"];  
				archerStructure["headTop_End"].rotation.x = object["headTop_EndRx"];  archerStructure["headTop_End"].rotation.y = object["headTop_EndRy"];  archerStructure["headTop_End"].rotation.z = object["headTop_EndRz"];  
				archerStructure["leftShoulder"].rotation.x = object["leftShoulderRx"];  archerStructure["leftShoulder"].rotation.y = object["leftShoulderRy"];  archerStructure["leftShoulder"].rotation.z = object["leftShoulderRz"];  
				archerStructure["leftArm"].rotation.x = object["leftArmRx"];  archerStructure["leftArm"].rotation.y = object["leftArmRy"];  archerStructure["leftArm"].rotation.z = object["leftArmRz"];  
				archerStructure["leftForeArm"].rotation.x = object["leftForeArmRx"];  archerStructure["leftForeArm"].rotation.y = object["leftForeArmRy"];  archerStructure["leftForeArm"].rotation.z = object["leftForeArmRz"];  
				archerStructure["leftHand"].rotation.x = object["leftHandRx"];  archerStructure["leftHand"].rotation.y = object["leftHandRy"];  archerStructure["leftHand"].rotation.z = object["leftHandRz"];  
				archerStructure["leftHandThumb1"].rotation.x = object["leftHandThumb1Rx"];  archerStructure["leftHandThumb1"].rotation.y = object["leftHandThumb1Ry"];  archerStructure["leftHandThumb1"].rotation.z = object["leftHandThumb1Rz"];  
				archerStructure["leftHandThumb2"].rotation.x = object["leftHandThumb2Rx"];  archerStructure["leftHandThumb2"].rotation.y = object["leftHandThumb2Ry"];  archerStructure["leftHandThumb2"].rotation.z = object["leftHandThumb2Rz"];  
				archerStructure["leftHandThumb3"].rotation.x = object["leftHandThumb3Rx"];  archerStructure["leftHandThumb3"].rotation.y = object["leftHandThumb3Ry"];  archerStructure["leftHandThumb3"].rotation.z = object["leftHandThumb3Rz"];  
				archerStructure["leftHandThumb4"].rotation.x = object["leftHandThumb4Rx"];  archerStructure["leftHandThumb4"].rotation.y = object["leftHandThumb4Ry"];  archerStructure["leftHandThumb4"].rotation.z = object["leftHandThumb4Rz"];  
				archerStructure["leftHandIndex1"].rotation.x = object["leftHandIndex1Rx"];  archerStructure["leftHandIndex1"].rotation.y = object["leftHandIndex1Ry"];  archerStructure["leftHandIndex1"].rotation.z = object["leftHandIndex1Rz"];  
				archerStructure["leftHandIndex2"].rotation.x = object["leftHandIndex2Rx"];  archerStructure["leftHandIndex2"].rotation.y = object["leftHandIndex2Ry"];  archerStructure["leftHandIndex2"].rotation.z = object["leftHandIndex2Rz"];  
				archerStructure["leftHandIndex3"].rotation.x = object["leftHandIndex3Rx"];  archerStructure["leftHandIndex3"].rotation.y = object["leftHandIndex3Ry"];  archerStructure["leftHandIndex3"].rotation.z = object["leftHandIndex3Rz"];  
				archerStructure["leftHandIndex4"].rotation.x = object["leftHandIndex4Rx"];  archerStructure["leftHandIndex4"].rotation.y = object["leftHandIndex4Ry"];  archerStructure["leftHandIndex4"].rotation.z = object["leftHandIndex4Rz"];  
				archerStructure["leftHandMiddle1"].rotation.x = object["leftHandMiddle1Rx"];  archerStructure["leftHandMiddle1"].rotation.y = object["leftHandMiddle1Ry"];  archerStructure["leftHandMiddle1"].rotation.z = object["leftHandMiddle1Rz"];  
				archerStructure["leftHandMiddle2"].rotation.x = object["leftHandMiddle2Rx"];  archerStructure["leftHandMiddle2"].rotation.y = object["leftHandMiddle2Ry"];  archerStructure["leftHandMiddle2"].rotation.z = object["leftHandMiddle2Rz"];  
				archerStructure["leftHandMiddle3"].rotation.x = object["leftHandMiddle3Rx"];  archerStructure["leftHandMiddle3"].rotation.y = object["leftHandMiddle3Ry"];  archerStructure["leftHandMiddle3"].rotation.z = object["leftHandMiddle3Rz"];  
				archerStructure["leftHandMiddle4"].rotation.x = object["leftHandMiddle4Rx"];  archerStructure["leftHandMiddle4"].rotation.y = object["leftHandMiddle4Ry"];  archerStructure["leftHandMiddle4"].rotation.z = object["leftHandMiddle4Rz"];  
				archerStructure["leftHandRing1"].rotation.x = object["leftHandRing1Rx"];  archerStructure["leftHandRing1"].rotation.y = object["leftHandRing1Ry"];  archerStructure["leftHandRing1"].rotation.z = object["leftHandRing1Rz"];  
				archerStructure["leftHandRing2"].rotation.x = object["leftHandRing2Rx"];  archerStructure["leftHandRing2"].rotation.y = object["leftHandRing2Ry"];  archerStructure["leftHandRing2"].rotation.z = object["leftHandRing2Rz"];  
				archerStructure["leftHandRing3"].rotation.x = object["leftHandRing3Rx"];  archerStructure["leftHandRing3"].rotation.y = object["leftHandRing3Ry"];  archerStructure["leftHandRing3"].rotation.z = object["leftHandRing3Rz"];  
				archerStructure["leftHandRing4"].rotation.x = object["leftHandRing4Rx"];  archerStructure["leftHandRing4"].rotation.y = object["leftHandRing4Ry"];  archerStructure["leftHandRing4"].rotation.z = object["leftHandRing4Rz"];  
				archerStructure["leftHandPinky1"].rotation.x = object["leftHandPinky1Rx"];  archerStructure["leftHandPinky1"].rotation.y = object["leftHandPinky1Ry"];  archerStructure["leftHandPinky1"].rotation.z = object["leftHandPinky1Rz"];  
				archerStructure["leftHandPinky2"].rotation.x = object["leftHandPinky2Rx"];  archerStructure["leftHandPinky2"].rotation.y = object["leftHandPinky2Ry"];  archerStructure["leftHandPinky2"].rotation.z = object["leftHandPinky2Rz"];  
				archerStructure["leftHandPinky3"].rotation.x = object["leftHandPinky3Rx"];  archerStructure["leftHandPinky3"].rotation.y = object["leftHandPinky3Ry"];  archerStructure["leftHandPinky3"].rotation.z = object["leftHandPinky3Rz"];  
				archerStructure["leftHandPinky4"].rotation.x = object["leftHandPinky4Rx"];  archerStructure["leftHandPinky4"].rotation.y = object["leftHandPinky4Ry"];  archerStructure["leftHandPinky4"].rotation.z = object["leftHandPinky4Rz"];  
				archerStructure["rightShoulder"].rotation.x = object["rightShoulderRx"];  archerStructure["rightShoulder"].rotation.y = object["rightShoulderRy"];  archerStructure["rightShoulder"].rotation.z = object["rightShoulderRz"];  
				archerStructure["rightArm"].rotation.x = object["rightArmRx"];  archerStructure["rightArm"].rotation.y = object["rightArmRy"];  archerStructure["rightArm"].rotation.z = object["rightArmRz"];  
				archerStructure["rightForeArm"].rotation.x = object["rightForeArmRx"];  archerStructure["rightForeArm"].rotation.y = object["rightForeArmRy"];  archerStructure["rightForeArm"].rotation.z = object["rightForeArmRz"];  
				archerStructure["rightHand"].rotation.x = object["rightHandRx"];  archerStructure["rightHand"].rotation.y = object["rightHandRy"];  archerStructure["rightHand"].rotation.z = object["rightHandRz"];  
				archerStructure["rightHandPinky1"].rotation.x = object["rightHandPinky1Rx"];  archerStructure["rightHandPinky1"].rotation.y = object["rightHandPinky1Ry"];  archerStructure["rightHandPinky1"].rotation.z = object["rightHandPinky1Rz"];  
				archerStructure["rightHandPinky2"].rotation.x = object["rightHandPinky2Rx"];  archerStructure["rightHandPinky2"].rotation.y = object["rightHandPinky2Ry"];  archerStructure["rightHandPinky2"].rotation.z = object["rightHandPinky2Rz"];  
				archerStructure["rightHandPinky3"].rotation.x = object["rightHandPinky3Rx"];  archerStructure["rightHandPinky3"].rotation.y = object["rightHandPinky3Ry"];  archerStructure["rightHandPinky3"].rotation.z = object["rightHandPinky3Rz"];  
				archerStructure["rightHandPinky4"].rotation.x = object["rightHandPinky4Rx"];  archerStructure["rightHandPinky4"].rotation.y = object["rightHandPinky4Ry"];  archerStructure["rightHandPinky4"].rotation.z = object["rightHandPinky4Rz"];  
				archerStructure["rightHandRing1"].rotation.x = object["rightHandRing1Rx"];  archerStructure["rightHandRing1"].rotation.y = object["rightHandRing1Ry"];  archerStructure["rightHandRing1"].rotation.z = object["rightHandRing1Rz"];  
				archerStructure["rightHandRing2"].rotation.x = object["rightHandRing2Rx"];  archerStructure["rightHandRing2"].rotation.y = object["rightHandRing2Ry"];  archerStructure["rightHandRing2"].rotation.z = object["rightHandRing2Rz"];  
				archerStructure["rightHandRing3"].rotation.x = object["rightHandRing3Rx"];  archerStructure["rightHandRing3"].rotation.y = object["rightHandRing3Ry"];  archerStructure["rightHandRing3"].rotation.z = object["rightHandRing3Rz"];  
				archerStructure["rightHandRing4"].rotation.x = object["rightHandRing4Rx"];  archerStructure["rightHandRing4"].rotation.y = object["rightHandRing4Ry"];  archerStructure["rightHandRing4"].rotation.z = object["rightHandRing4Rz"];  
				archerStructure["rightHandMiddle1"].rotation.x = object["rightHandMiddle1Rx"];  archerStructure["rightHandMiddle1"].rotation.y = object["rightHandMiddle1Ry"];  archerStructure["rightHandMiddle1"].rotation.z = object["rightHandMiddle1Rz"];  
				archerStructure["rightHandMiddle2"].rotation.x = object["rightHandMiddle2Rx"];  archerStructure["rightHandMiddle2"].rotation.y = object["rightHandMiddle2Ry"];  archerStructure["rightHandMiddle2"].rotation.z = object["rightHandMiddle2Rz"];  
				archerStructure["rightHandMiddle3"].rotation.x = object["rightHandMiddle3Rx"];  archerStructure["rightHandMiddle3"].rotation.y = object["rightHandMiddle3Ry"];  archerStructure["rightHandMiddle3"].rotation.z = object["rightHandMiddle3Rz"];  
				archerStructure["rightHandMiddle4"].rotation.x = object["rightHandMiddle4Rx"];  archerStructure["rightHandMiddle4"].rotation.y = object["rightHandMiddle4Ry"];  archerStructure["rightHandMiddle4"].rotation.z = object["rightHandMiddle4Rz"];  
				archerStructure["rightHandIndex1"].rotation.x = object["rightHandIndex1Rx"];  archerStructure["rightHandIndex1"].rotation.y = object["rightHandIndex1Ry"];  archerStructure["rightHandIndex1"].rotation.z = object["rightHandIndex1Rz"];  
				archerStructure["rightHandIndex2"].rotation.x = object["rightHandIndex2Rx"];  archerStructure["rightHandIndex2"].rotation.y = object["rightHandIndex2Ry"];  archerStructure["rightHandIndex2"].rotation.z = object["rightHandIndex2Rz"];  
				archerStructure["rightHandIndex3"].rotation.x = object["rightHandIndex3Rx"];  archerStructure["rightHandIndex3"].rotation.y = object["rightHandIndex3Ry"];  archerStructure["rightHandIndex3"].rotation.z = object["rightHandIndex3Rz"];  
				archerStructure["rightHandIndex4"].rotation.x = object["rightHandIndex4Rx"];  archerStructure["rightHandIndex4"].rotation.y = object["rightHandIndex4Ry"];  archerStructure["rightHandIndex4"].rotation.z = object["rightHandIndex4Rz"];  
				archerStructure["rightHandThumb1"].rotation.x = object["rightHandThumb1Rx"];  archerStructure["rightHandThumb1"].rotation.y = object["rightHandThumb1Ry"];  archerStructure["rightHandThumb1"].rotation.z = object["rightHandThumb1Rz"];  
				archerStructure["rightHandThumb2"].rotation.x = object["rightHandThumb2Rx"];  archerStructure["rightHandThumb2"].rotation.y = object["rightHandThumb2Ry"];  archerStructure["rightHandThumb2"].rotation.z = object["rightHandThumb2Rz"];  
				archerStructure["rightHandThumb3"].rotation.x = object["rightHandThumb3Rx"];  archerStructure["rightHandThumb3"].rotation.y = object["rightHandThumb3Ry"];  archerStructure["rightHandThumb3"].rotation.z = object["rightHandThumb3Rz"];  
				archerStructure["rightHandThumb4"].rotation.x = object["rightHandThumb4Rx"];  archerStructure["rightHandThumb4"].rotation.y = object["rightHandThumb4Ry"];  archerStructure["rightHandThumb4"].rotation.z = object["rightHandThumb4Rz"];   	
			};

			idle = new TWEEN.Tween(startRotations).to({
													"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
													"spineRx" : 0.0000, "spineRy" : 0.0000, "spineRz" : -0.0000,
													"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
													"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
													"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
													"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
													"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
													"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
													"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
													"leftShoulderRx" : -0.0000, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
													"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
													"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000, "leftForeArmRz" : -0.0000,
													"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
													"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
													"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
													"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
													"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
													"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
													"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
													"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
													"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
													"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
													"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
													"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
													"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
													"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
													"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
													"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
													"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
													"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
													"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
													"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
													"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
													"rightShoulderRx" : -0.0000, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
													"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
													"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000, "rightForeArmRz" : 0.0000,
													"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
													"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
													"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
													"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
													"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
													"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
													"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
													"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
													"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
													"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
													"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
													"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
													"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
													"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
													"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
													"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
													"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
													"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
													"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
													"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
													"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
													"leftUpLegRx" : -0.0010, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
													"leftLegRx" : 0.0021, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
													"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
													"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
													"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
													"rightUpLegRx" : -0.0010, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
													"rightLegRx" : 0.0020, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
													"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
													"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
													"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
													}, 1000);
			
														idleB = new TWEEN.Tween(startRotations).to({
															"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
															"spineRx" : 0.0000, "spineRy" : 0.0000, "spineRz" : -0.0000,
															"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
															"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
															"neckRx" : -0.0000 + 0.04, "neckRy" : -0.0000, "neckRz" : -0.0000,
															"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
															"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
															"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
															"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
															"leftShoulderRx" : -0.0000 + 0.04, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
															"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
															"leftForeArmRx" : -0.0000, "leftForeArmRy" : -0.0000, "leftForeArmRz" : -0.0000,
															"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
															"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
															"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
															"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
															"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
															"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
															"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
															"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
															"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
															"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
															"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
															"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
															"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
															"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
															"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
															"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
															"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
															"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
															"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
															"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
															"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
															"rightShoulderRx" : -0.0000 + 0.04, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
															"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
															"rightForeArmRx" : -0.0000, "rightForeArmRy" : -0.0000, "rightForeArmRz" : 0.0000,
															"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
															"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
															"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
															"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
															"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
															"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
															"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
															"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
															"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
															"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
															"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
															"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
															"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
															"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
															"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
															"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
															"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
															"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
															"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
															"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
															"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
															"leftUpLegRx" : -0.0010, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
															"leftLegRx" : 0.0021, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
															"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
															"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
															"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
															"rightUpLegRx" : -0.0010, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
															"rightLegRx" : 0.0020, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
															"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
															"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
															"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000
														}, 1000).repeat(Infinity).yoyo(true);

			idle.onComplete(()=>{
				idleB.start();
			});
			
			
													
			jumpA = new TWEEN.Tween(startRotations).to({
															"hipsRx" : -1.5708, "hipsRy" : -0.0000, "hipsRz" : 0.0000,
															"spineRx" : 0.0000, "spineRy" : 0.0000, "spineRz" : -0.0000,
															"spine1Rx" : 0.0000, "spine1Ry" : 0.0000, "spine1Rz" : -0.0000,
															"spine2Rx" : 0.0000, "spine2Ry" : -0.0000, "spine2Rz" : -0.0000,
															"neckRx" : -0.0000, "neckRy" : -0.0000, "neckRz" : -0.0000,
															"headRx" : 0.0000, "headRy" : 0.0000, "headRz" : -0.0000,
															"rightEyeRx" : -0.0000, "rightEyeRy" : 0.0000, "rightEyeRz" : -0.0000,
															"leftEyeRx" : -0.0000, "leftEyeRy" : 0.0000, "leftEyeRz" : -0.0000,
															"headTop_EndRx" : -0.0000, "headTop_EndRy" : 0.0000, "headTop_EndRz" : -0.0000,
															"leftShoulderRx" : Math.PI/2, "leftShoulderRy" : -0.0000, "leftShoulderRz" : 0.0000,
															"leftArmRx" : 0.0000, "leftArmRy" : -0.0000, "leftArmRz" : -1.3659,
															"leftForeArmRx" : -0.0000, "leftForeArmRy" : -Math.PI/2, "leftForeArmRz" : -0.0000,
															"leftHandRx" : 0.0005, "leftHandRy" : -0.0000, "leftHandRz" : 0.0000,
															"leftHandThumb1Rx" : -0.0002, "leftHandThumb1Ry" : -0.0002, "leftHandThumb1Rz" : 0.0002,
															"leftHandThumb2Rx" : 0.0000, "leftHandThumb2Ry" : 0.7854, "leftHandThumb2Rz" : 0.2618,
															"leftHandThumb3Rx" : -0.0000, "leftHandThumb3Ry" : 0.7854, "leftHandThumb3Rz" : 0.2618,
															"leftHandThumb4Rx" : -0.0000, "leftHandThumb4Ry" : 0.7854, "leftHandThumb4Rz" : 0.2618,
															"leftHandIndex1Rx" : 0.0000, "leftHandIndex1Ry" : -0.0000, "leftHandIndex1Rz" : -0.0000,
															"leftHandIndex2Rx" : -0.0000, "leftHandIndex2Ry" : 0.0000, "leftHandIndex2Rz" : -1.0472,
															"leftHandIndex3Rx" : -0.0000, "leftHandIndex3Ry" : -0.0000, "leftHandIndex3Rz" : -1.0472,
															"leftHandIndex4Rx" : -0.0000, "leftHandIndex4Ry" : -0.0000, "leftHandIndex4Rz" : -1.0472,
															"leftHandMiddle1Rx" : -0.0000, "leftHandMiddle1Ry" : 0.0000, "leftHandMiddle1Rz" : -0.0000,
															"leftHandMiddle2Rx" : -0.0000, "leftHandMiddle2Ry" : 0.0000, "leftHandMiddle2Rz" : -1.0472,
															"leftHandMiddle3Rx" : 0.0000, "leftHandMiddle3Ry" : 0.0000, "leftHandMiddle3Rz" : -1.0472,
															"leftHandMiddle4Rx" : 0.0000, "leftHandMiddle4Ry" : 0.0000, "leftHandMiddle4Rz" : -1.0472,
															"leftHandRing1Rx" : 0.0000, "leftHandRing1Ry" : 0.0000, "leftHandRing1Rz" : -0.0000,
															"leftHandRing2Rx" : -0.0000, "leftHandRing2Ry" : -0.0000, "leftHandRing2Rz" : -1.0472,
															"leftHandRing3Rx" : 0.0000, "leftHandRing3Ry" : 0.0000, "leftHandRing3Rz" : -1.0472,
															"leftHandRing4Rx" : 0.0000, "leftHandRing4Ry" : -0.0000, "leftHandRing4Rz" : -1.0472,
															"leftHandPinky1Rx" : 0.0000, "leftHandPinky1Ry" : 0.0000, "leftHandPinky1Rz" : 0.0000,
															"leftHandPinky2Rx" : 0.0000, "leftHandPinky2Ry" : -0.0000, "leftHandPinky2Rz" : -1.0472,
															"leftHandPinky3Rx" : -0.0000, "leftHandPinky3Ry" : 0.0000, "leftHandPinky3Rz" : -1.0472,
															"leftHandPinky4Rx" : 0.0000, "leftHandPinky4Ry" : 0.0000, "leftHandPinky4Rz" : -1.0472,
															"rightShoulderRx" : Math.PI/2, "rightShoulderRy" : -0.0000, "rightShoulderRz" : -0.0000,
															"rightArmRx" : 0.0000, "rightArmRy" : 0.0000, "rightArmRz" : 1.3659,
															"rightForeArmRx" : -0.0000, "rightForeArmRy" : Math.PI/2, "rightForeArmRz" : 0.0000,
															"rightHandRx" : 0.0005, "rightHandRy" : 0.0000, "rightHandRz" : -0.0000,
															"rightHandPinky1Rx" : 0.0000, "rightHandPinky1Ry" : -0.0000, "rightHandPinky1Rz" : -0.0000,
															"rightHandPinky2Rx" : 0.0000, "rightHandPinky2Ry" : 0.0000, "rightHandPinky2Rz" : 1.0472,
															"rightHandPinky3Rx" : -0.0000, "rightHandPinky3Ry" : -0.0000, "rightHandPinky3Rz" : 1.0472,
															"rightHandPinky4Rx" : -0.0000, "rightHandPinky4Ry" : 0.0000, "rightHandPinky4Rz" : 1.0472,
															"rightHandRing1Rx" : 0.0000, "rightHandRing1Ry" : -0.0000, "rightHandRing1Rz" : 0.0000,
															"rightHandRing2Rx" : -0.0000, "rightHandRing2Ry" : 0.0000, "rightHandRing2Rz" : 1.0472,
															"rightHandRing3Rx" : 0.0000, "rightHandRing3Ry" : -0.0000, "rightHandRing3Rz" : 1.0472,
															"rightHandRing4Rx" : 0.0000, "rightHandRing4Ry" : -0.0000, "rightHandRing4Rz" : 1.0472,
															"rightHandMiddle1Rx" : -0.0000, "rightHandMiddle1Ry" : -0.0000, "rightHandMiddle1Rz" : 0.0000,
															"rightHandMiddle2Rx" : -0.0000, "rightHandMiddle2Ry" : -0.0000, "rightHandMiddle2Rz" : 1.0472,
															"rightHandMiddle3Rx" : 0.0000, "rightHandMiddle3Ry" : -0.0000, "rightHandMiddle3Rz" : 1.0472,
															"rightHandMiddle4Rx" : 0.0000, "rightHandMiddle4Ry" : 0.0000, "rightHandMiddle4Rz" : 1.0472,
															"rightHandIndex1Rx" : -0.0000, "rightHandIndex1Ry" : 0.0000, "rightHandIndex1Rz" : 0.0000,
															"rightHandIndex2Rx" : -0.0000, "rightHandIndex2Ry" : -0.0000, "rightHandIndex2Rz" : 1.0472,
															"rightHandIndex3Rx" : 0.0000, "rightHandIndex3Ry" : 0.0000, "rightHandIndex3Rz" : 1.0472,
															"rightHandIndex4Rx" : 0.0000, "rightHandIndex4Ry" : 0.0000, "rightHandIndex4Rz" : 1.0472,
															"rightHandThumb1Rx" : -0.0002, "rightHandThumb1Ry" : 0.0002, "rightHandThumb1Rz" : -0.0002,
															"rightHandThumb2Rx" : 0.0000, "rightHandThumb2Ry" : -0.7854, "rightHandThumb2Rz" : -0.2618,
															"rightHandThumb3Rx" : 0.0000, "rightHandThumb3Ry" : -0.7854, "rightHandThumb3Rz" : -0.2618,
															"rightHandThumb4Rx" : 0.0000, "rightHandThumb4Ry" : -0.7854, "rightHandThumb4Rz" : -0.2618,
															"leftUpLegRx" : Math.PI/3, "leftUpLegRy" : 0.0000, "leftUpLegRz" : -0.0001,
															"leftLegRx" : Math.PI/9, "leftLegRy" : 0.0000, "leftLegRz" : 0.0000,
															"leftFootRx" : -0.0010, "leftFootRy" : -0.0000, "leftFootRz" : 0.0001,
															"leftToeBaseRx" : 0.0000, "leftToeBaseRy" : -0.0000, "leftToeBaseRz" : -0.0000,
															"leftToe_EndRx" : -0.0000, "leftToe_EndRy" : 0.0000, "leftToe_EndRz" : 0.0000,
															"rightUpLegRx" : -Math.PI/3, "rightUpLegRy" : 0.0000, "rightUpLegRz" : -0.0001,
															"rightLegRx" : Math.PI/4, "rightLegRy" : 0.0000, "rightLegRz" : -0.0000,
															"rightFootRx" : -0.0010, "rightFootRy" : -0.0000, "rightFootRz" : 0.0001,
															"rightToeBaseRx" : 0.0000, "rightToeBaseRy" : -0.0000, "rightToeBaseRz" : -0.0000,
															"rightToe_EndRx" : 0.0000, "rightToe_EndRy" : -0.0000, "rightToe_EndRz" : -0.0000}, 800);
			
			jumpB = new TWEEN.Tween(startRotations).to({"rightShoulderRx": Math.PI/2,"rightShoulderRy": -0.0000,"rightShoulderRz": -0.0000, 
														"rightArmRx": 0,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": 0,"rightForeArmRy": Math.PI/2,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": Math.PI/2,"leftShoulderRy": -0.0000,"leftShoulderRz": 0.0000, 
														"leftArmRx": 0,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": 0,"leftForeArmRy": -Math.PI/2,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0.0005,"leftHandRy": -0.0000,"leftHandRz": 0.0000, 
														"rightUpLegRx": -Math.PI/5,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": Math.PI/9,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": Math.PI/5,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": Math.PI/9,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2618, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 800);

			walkA = new TWEEN.Tween(startRotations).to({"rightShoulderRx": Math.PI/9,"rightShoulderRy": -0.0000,"rightShoulderRz": -0.0000, 
														"rightArmRx": 0,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": 0,"rightForeArmRy": Math.PI/9,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": -Math.PI/9,"leftShoulderRy": -0.0000,"leftShoulderRz": 0.0000, 
														"leftArmRx": 0,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": 0,"leftForeArmRy": -Math.PI/9,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0.0005,"leftHandRy": -0.0000,"leftHandRz": 0.0000, 
														"rightUpLegRx": Math.PI/5,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": Math.PI/9,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": -Math.PI/5,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": Math.PI/9,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2618, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 400);
			
			walkB = new TWEEN.Tween(startRotations).to({"rightShoulderRx": -Math.PI/9,"rightShoulderRy": -0.0000,"rightShoulderRz": -0.0000, 
														"rightArmRx": 0,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": 0,"rightForeArmRy": Math.PI/9,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": Math.PI/9,"leftShoulderRy": -0.0000,"leftShoulderRz": 0.0000, 
														"leftArmRx": 0,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": 0,"leftForeArmRy": -Math.PI/9,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0.0005,"leftHandRy": -0.0000,"leftHandRz": 0.0000, 
														"rightUpLegRx": -Math.PI/3,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": Math.PI/4,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": Math.PI/3,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": Math.PI/9,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2618, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 400).onComplete(() => walkA.start());


			runA = new TWEEN.Tween(startRotations).to({"rightShoulderRx": Math.PI/4,"rightShoulderRy": -0.0000,"rightShoulderRz": -0.0000, 
														"rightArmRx": 0,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": 0,"rightForeArmRy": Math.PI/4,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": -Math.PI/4,"leftShoulderRy": -0.0000,"leftShoulderRz": 0.0000, 
														"leftArmRx": 0,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": 0,"leftForeArmRy": -Math.PI/4,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0.0005,"leftHandRy": -0.0000,"leftHandRz": 0.0000, 
														"rightUpLegRx": Math.PI/3,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": Math.PI/9,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": -Math.PI/3,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": Math.PI/9,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2618, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 400);
			
			runB = new TWEEN.Tween(startRotations).to({"rightShoulderRx": -Math.PI/4,"rightShoulderRy": -0.0000,"rightShoulderRz": -0.0000, 
														"rightArmRx": 0,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": 0,"rightForeArmRy": Math.PI/4,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": Math.PI/4,"leftShoulderRy": -0.0000,"leftShoulderRz": 0.0000, 
														"leftArmRx": 0,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": 0,"leftForeArmRy": -Math.PI/4,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0.0005,"leftHandRy": -0.0000,"leftHandRz": 0.0000, 
														"rightUpLegRx": -Math.PI/3,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": Math.PI/9,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": Math.PI/3,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": Math.PI/9,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2618, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 400).onComplete(() => runA.start());

			shootA = new TWEEN.Tween(startRotations).to({"rightShoulderRx": -Math.PI/2,"rightShoulderRy": -0.0000,"rightShoulderRz": Math.PI/9, 
														"rightArmRx": 0,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": 0,"rightForeArmRy": 0,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": -Math.PI/2,"leftShoulderRy": -0.0000,"leftShoulderRz": -Math.PI/6, 
														"leftArmRx": 0,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": 0,"leftForeArmRy": 0,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0,"leftHandRy": -0.0000,"leftHandRz": Math.PI/10, 
														"rightUpLegRx": -0,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": 0,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": 0,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": 0,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2619, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 200).onComplete(() => {
															shootB.start()		
														});
			shootA.onStart(() => {
															
														});

			shootB = new TWEEN.Tween(startRotations).to({"rightShoulderRx": -Math.PI/2,"rightShoulderRy": -0.0000,"rightShoulderRz": Math.PI/8, 
														"rightArmRx": Math.PI/2,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": 0,"rightForeArmRy": Math.PI/2,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": -Math.PI/2,"leftShoulderRy": -0.0000,"leftShoulderRz": -Math.PI/6, 
														"leftArmRx": 0,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": 0,"leftForeArmRy": 0,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0.0005,"leftHandRy": -0.0000,"leftHandRz": Math.PI/10, 
														"rightUpLegRx": -0,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": 0,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": 0,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": 0,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2618, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 200).onComplete(() => {
															throwArrow();
															shootC.start()		
														});

			shootC = new TWEEN.Tween(startRotations).to({"rightShoulderRx": -0.0000,"rightShoulderRy": -0.0000,"rightShoulderRz": -0.0000, 
														"rightArmRx": 0.0000,"rightArmRy": 0.0000,"rightArmRz": 1.3659, 
														"rightForeArmRx": -0.0000,"rightForeArmRy": -0.0000,"rightForeArmRz": 0.0000, 
														"rightHandRx": 0.0005,"rightHandRy": 0.0000,"rightHandRz": -0.0000, 
														"leftShoulderRx": -0.0000,"leftShoulderRy": -0.0000,"leftShoulderRz": 0.0000, 
														"leftArmRx": 0.0000,"leftArmRy": -0.0000,"leftArmRz": -1.3659, 
														"leftForeArmRx": -0.0000,"leftForeArmRy": -0.0000,"leftForeArmRz": -0.0000, 
														"leftHandRx": 0.0005,"leftHandRy": -0.0000,"leftHandRz": 0.0000, 
														"rightUpLegRx": -0.0010,"rightUpLegRy": 0.0000,"rightUpLegRz": -0.0001, 
														"rightLegRx": 0.0020,"rightLegRy": 0.0000,"rightLegRz": -0.0000, 
														"rightFootRx": -0.0010,"rightFootRy": -0.0000,"rightFootRz": 0.0001, 
														"leftUpLegRx": -0.0010,"leftUpLegRy": 0.0000,"leftUpLegRz": -0.0001, 
														"leftLegRx": 0.0021,"leftLegRy": 0.0000,"leftLegRz": 0.0000, 
														"leftFootRx": -0.0010,"leftFootRy": -0.0000,"leftFootRz": 0.0001, 
														"neckRx": -0.0000,"neckRy": -0.0000,"neckRz": -0.0000, 
														"headRx": 0.0000,"headRy": 0.0000,"headRz": -0.0000,
														"rightHandPinky2Rz": 1.0472, 
														"rightHandPinky3Rz": 1.0472, 
														"rightHandPinky4Rz": 1.0472, 
														"rightHandRing2Rz": 1.0472, 
														"rightHandRing3Rz": 1.0472, 
														"rightHandRing4Rz": 1.0472, 
														"rightHandMiddle2Rz": 1.0472, 
														"rightHandMiddle3Rz": 1.0472, 
														"rightHandMiddle4Rz": 1.0472, 
														"rightHandIndex2Rz": 1.0472, 
														"rightHandIndex3Rz": 1.0472, 
														"rightHandIndex4Rz": 1.0472, 
														"rightHandThumb2Rz": -0.2618, 
														"rightHandThumb3Rz": -0.2618, 
														"rightHandThumb4Rz": -0.2618,
														"rightHandThumb2Ry": -0.7854, 
														"rightHandThumb3Ry": -0.7854, 
														"rightHandThumb4Ry": -0.7854, 
														"leftHandPinky2Rz": -1.0472, 
														"leftHandPinky3Rz": -1.0472, 
														"leftHandPinky4Rz": -1.0472, 
														"leftHandRing2Rz": -1.0472, 
														"leftHandRing3Rz": -1.0472, 
														"leftHandRing4Rz": -1.0472, 
														"leftHandMiddle2Rz": -1.0472, 
														"leftHandMiddle3Rz": -1.0472, 
														"leftHandMiddle4Rz": -1.0472, 
														"leftHandIndex2Rz": -1.0472, 
														"leftHandIndex3Rz": -1.0472, 
														"leftHandIndex4Rz": -1.0472, 
														"leftHandThumb2Rz": 0.2618, 
														"leftHandThumb3Rz": 0.2618, 
														"leftHandThumb4Rz": 0.2618,
														"leftHandThumb2Ry": 0.7854, 
														"leftHandThumb3Ry": 0.7854, 
														"leftHandThumb4Ry": 0.7854}, 200).onComplete(() => {
															canShoot=true;		
														});

			idle.onUpdate(updateFunction);
			idleB.onUpdate(updateFunction);
			runA.onUpdate(updateFunction);
			runB.onUpdate(updateFunction);
			walkA.onUpdate(updateFunction);
			walkB.onUpdate(updateFunction);
			jumpA.onUpdate(updateFunction);
			shootA.onUpdate(updateFunctionUpper);
			shootB.onUpdate(updateFunctionUpper);
			shootC.onUpdate(updateFunctionUpper);
			runA.chain(runB);
			walkA.chain(walkB);
		});



		//CUBE (CANNON)
		const cubePhysMat = new CANNON.Material();

		const cubeBody = new CANNON.Body({
			mass: 80,
			shape: new CANNON.Box(new CANNON.Vec3(0.7, 1.5, 1.0)),
			position: new CANNON.Vec3(0, 2.8, 0),
			material: cubePhysMat,
			linearDamping: 0.5,
 		    angularDamping: 0.5,
			type: CANNON.Body.DYNAMIC 
		});
		world.addBody(cubeBody);

		function shoot(){
			shootA.start();
		}

		function throwArrow(){
					
			//Function that returns the listener for the collision event of the arrows (can't create the listener directly in the loop)
			function arrowColliderEvent(genArrow){
				return (e) => {
					if ( e.contact.bi.id == genArrow["can"].id ) {
					e.contact.ni.negate( e.contact.ni );
					}

					if ( e.contact.ni.dot( new CANNON.Vec3( 0, 1, 0 ) ) > 0.5) {
						genArrow["killer"] = false;
					}
				} 
			}

			var cameraDirection= new THREE.Vector3();
			camera.getWorldDirection(cameraDirection);

			//Vertical direction not useful for movement, player can't fly
			cameraDirection.y = 0;
			cameraDirection.normalize();
			cameraDirection.applyAxisAngle(new THREE.Vector3(0,1,0), relDir);
			var moveX = cameraDirection.x;
			var moveZ = cameraDirection.z;
			var arrowDirection = new THREE.Vector3(moveX, 0, 0);
			arrowDirection.add(new THREE.Vector3(0, 0, moveZ));


			var cubeArrowCan = new CANNON.Body({
				mass: 2,
				shape: new CANNON.Box(new CANNON.Vec3(0.05, 0.05, 0.35 )),  
				position: new CANNON.Vec3(archerModelParent.position.x + 2*moveX, archerModelParent.position.y+0.8, archerModelParent.position.z + 2*moveZ),
				linearDamping: 0.5,
				angularDamping: 0.5,
			});
			
			var cubeArrowMesh = new THREE.Mesh( new THREE.BoxGeometry( 0.1 , 0.1, 0.7), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ));
			
			var cubeArrowModel = arrowModel.clone();
			
			var cubeArrowModelParent = new THREE.Object3D();
			cubeArrowModel.getWorldPosition(cubeArrowModelParent.position);
			cubeArrowModel.position.set(0 , 0, -cubeArrowMesh.geometry.parameters.depth/2);
			cubeArrowModelParent.add(cubeArrowModel);
			
			//scene.add( cubeArrowMesh );
			scene.add( cubeArrowModelParent );
			
			world.addBody(cubeArrowCan);
			cubeArrowModelParent.lookAt(arrowDirection);

			var arrowVelocity = 40;

			cubeArrowCan.velocity.z = arrowVelocity * moveZ;
			cubeArrowCan.velocity.x = arrowVelocity * moveX;
			
			var genArrow = {"can":cubeArrowCan, "mesh":cubeArrowMesh, "model":cubeArrowModelParent, "killer" : true};
			
			arrows.push(genArrow);

			cubeArrowCan.addEventListener("collide", arrowColliderEvent(genArrow));

		}


		var targetBody1 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(-2, 2.5, 20),
			type: CANNON.Body.STATIC
		});
		const targetMesh1 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		//scene.add(targetMesh1);
		targetBody1.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody1);		
		
		var targetBody2 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(2, 2.5, 20),
			type: CANNON.Body.STATIC
		});
		const targetMesh2 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		//scene.add(targetMesh2);
		targetBody2.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody2);

		var targetBody3 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(-2, 1.5, 90),
			type: CANNON.Body.STATIC
		});
		const targetMesh3 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		//scene.add(targetMesh3);
		targetBody3.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody3);		
		
		var targetBody4 = new CANNON.Body({
			shape: new CANNON.Cylinder(1,1,0.5,10),
			position: new CANNON.Vec3(2, 1.5, 90),
			type: CANNON.Body.STATIC
		});
		const targetMesh4 = new THREE.Mesh( new THREE.CylinderGeometry( 1, 1, 0.5, 10 ), new THREE.MeshPhongMaterial( { color: 0x00ff00, wireframe: true} ) );
		//scene.add(targetMesh4);
		targetBody4.quaternion.setFromAxisAngle(new CANNON.Vec3(1,0,0), Math.PI / 2);
		world.addBody(targetBody4);

		function obj1Completed(){
			if(!target1hit || !target2hit) return;
			// console.log("LEVEL 2");
			level2Unlock.start();
		}

		function obj2Completed(){
			if(!target3hit || !target4hit) return;
			// console.log("LEVEL 3");
			rotatePlatFloatingTweens.forEach(element => {
				element.stop();
				rotatePlatFloatingTweens = rotatePlatFloatingTweens.filter(function(ele){ 
					return ele != element; 
				});
			});
			
			level3Unlock1.onComplete(()=> {
				obsPlat.forEach(element => {
				var rotatePlatFloating = new TWEEN.Tween({y:element["body"].position.y}).to({y:element["body"].position.y+0.2}, 200).onUpdate((object)=>{if(element["body"])element["body"].position.y= object.y;});
				rotatePlatFloating.repeat(Infinity).yoyo(true);
				rotatePlatFloating.start();

				rotatePlatFloatingTweens.push(rotatePlatFloating);
			});
			}).start();
			level3Unlock2.start();
			level3Unlock3.start();
			level3Unlock4.start();
			level3Unlock5.start();
			level3Unlock6.start();
		}
		

		

		//LEVEL2PLATFORM (THREE)
		const level2PlatformGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const level2PlatformMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
			});
		const level2PlatformMesh = new THREE.Mesh(level2PlatformGeo, level2PlatformMat);
		//scene.add(level2PlatformMesh);
		level2PlatformMesh.receiveShadow=true;
		level2PlatformMesh.castshadow=true;

		//LEVEL2PLATFORM (CANNON)
		const level2PlatformPhysMat = new CANNON.Material();


		const level2PlatformBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: level2PlatformPhysMat,
			position: new CANNON.Vec3(0, 0, 31)
		});
		world.addBody(level2PlatformBody);
		level2PlatformBody.quaternion.setFromEuler(Math.PI/2, Math.PI/6, 0);


		//LEVEL3PLATFORM (THREE)
		const level3PlatformGeo = new THREE.CylinderGeometry( 18, 18, 1, 6 );
		const level3PlatformMat = new THREE.MeshPhongMaterial({ 
			color: 0x00ff00,
			side: THREE.DoubleSide,
			wireframe: true
			});
		const level3PlatformMesh = new THREE.Mesh(level3PlatformGeo, level3PlatformMat);
		//scene.add(level3PlatformMesh);
		level3PlatformMesh.receiveShadow=true;
		level3PlatformMesh.castshadow=true;

		//LEVEL3PLATFORM (CANNON)
		const level3PlatformPhysMat = new CANNON.Material();


		const level3PlatformBody = new CANNON.Body({
			shape: new CANNON.Cylinder(18,18,1,6),
			type: CANNON.Body.KINEMATIC,
			material: level3PlatformPhysMat,
			position: new CANNON.Vec3(0, 6.5, 117.5)
		});
		world.addBody(level3PlatformBody);
		level3PlatformBody.quaternion.setFromEuler(0, Math.PI/6, 0);

		

		//CONTACT MATERIALS (CANNON)
		const groundBoxContactMat = new CANNON.ContactMaterial(
			groundPhysMat,
			cubePhysMat,
			{restitution : 0},
			{friction : 1}
			// {contactEquationRelaxation : 1000},
			// {restitution : 0},
			// {linearDamping : 1},
		);

		world.addContactMaterial(groundBoxContactMat);

		//EVENT LISTENERS
		window.addEventListener('resize', function() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			renderer.setSize(window.innerWidth, window.innerHeight);
		});

		var pressed = {"SHIFT" : false, "W" : false, "A" : false, "S" : false, "D" : false, "F" : false};
		
		document.addEventListener('keydown',(event) => {
			if(event.key.toLowerCase() == " ") pressed["SPACE"] = true;
			if(event.key.toLowerCase() == "shift") pressed["SHIFT"] = true;
			if(event.key.toLowerCase() == "w") pressed["W"] = true;
			if(event.key.toLowerCase() == "a") pressed["A"] = true;
			if(event.key.toLowerCase() == "s") pressed["S"] = true;
			if(event.key.toLowerCase() == "d") pressed["D"] = true;
			if(event.key.toLowerCase() == "f") pressed["F"] = true;
		},false);
		
		document.addEventListener('keyup',(event) => {
			if(event.key.toLowerCase() == " ") pressed["SPACE"] = false;
			if(event.key.toLowerCase() == "shift") pressed["SHIFT"] = false;
			if(event.key.toLowerCase() == "w") pressed["W"] = false;
			if(event.key.toLowerCase() == "a") pressed["A"] = false;
			if(event.key.toLowerCase() == "s") pressed["S"] = false;
			if(event.key.toLowerCase() == "d") pressed["D"] = false;
			if(event.key.toLowerCase() == "f") pressed["F"] = false;
		},false);

		cubeBody.addEventListener( "collide", function (e) {
			//Since e.contact.bi and e.contact.bj are the bodies colliding we would like to discover which is the player, in order to know if he is colliding with a floor or something else looking at the collision normal of the other object
			//the normal of collision with respect to the body e.contact.bi is contained inside e.contact.ni
			
			//if e.contact.ni is the collision normal of the player then we negate it to obtain the collision normal of the other object
			if ( e.contact.bi.id == cubeBody.id ) {
			e.contact.ni.negate( e.contact.ni );
			}

			// If the dot product between the vertical positive axis and the contact normal is between 0 and 1 then we know that the player is hitting a floor (or a surface to which he could stand)
			if ( e.contact.ni.dot( new CANNON.Vec3( 0, 1, 0 ) ) > 0.5) playerState = "Idle";
		});

		function removeArrowByID(id){
			arrows.forEach(element => {
				if(element["can"].id == id){
					scene.remove(element["model"]);
					setTimeout(function() {
						world.removeBody(element["can"]);
					},0);
					scene.remove(element["mesh"]);
					arrows = arrows.filter(function(ele){ 
						return ele != element; 
					});
				}
			});
		}
		targetBody1.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target1
			if (targetBody1 && (e.contact.bi.id == targetBody1.id || e.contact.bj.id == targetBody1.id)) {
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target1hit=true;
				scene.remove(targetModelParent1);
				setTimeout(function() {
					world.removeBody(targetBody1);
				},0);
				scene.remove(targetMesh1);
				obj1Completed();
			}
		});

		targetBody2.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target2
			if (targetBody2 && (e.contact.bi.id == targetBody2.id || e.contact.bj.id == targetBody2.id)) {
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target2hit=true;
				scene.remove(targetModelParent2);
				setTimeout(function() {
					world.removeBody(targetBody2);
				},0);
				scene.remove(targetMesh2);
				obj1Completed();
			}
		});

		targetBody3.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target3
			if (targetBody3 && (e.contact.bi.id == targetBody3.id || e.contact.bj.id == targetBody3.id)) {
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target3hit=true;
				scene.remove(targetModelParent3);
				setTimeout(function() {
					world.removeBody(targetBody3);
				},0);
				scene.remove(targetMesh3);
				obj2Completed();
			}
		});

		targetBody4.addEventListener("collide", function(e){
			//We've to check if one of the arrows hits the target4
			if (targetBody4 && (e.contact.bi.id == targetBody4.id || e.contact.bj.id == targetBody4.id)) {
				removeArrowByID(e.contact.bi.id);
				removeArrowByID(e.contact.bj.id);
				target4hit=true;
				scene.remove(targetModelParent4);
				setTimeout(function() {
					world.removeBody(targetBody4);
				},0);
				scene.remove(targetMesh4);
				obj2Completed();
			}
		});




		orbit.addEventListener('lock', function() {animateScene=false; pause_bg.style.display = 'none'; pause_fg.style.display = 'none';});
		orbit.addEventListener('unlock', function() {lastUnlockTime = performance.now(); animateScene=true; pause_fg.style.display = ''; pause_bg.style.display = '';
				//console.log('"hipsRx" : ' + archerStructure["hips"].rotation.x.toFixed(4) + ', "hipsRy" : ' + archerStructure["hips"].rotation.y.toFixed(4) + ', "hipsRz" : ' + archerStructure["hips"].rotation.z.toFixed(4) + ',\n"spineRx" : ' + archerStructure["spine"].rotation.x.toFixed(4) + ', "spineRy" : ' + archerStructure["spine"].rotation.y.toFixed(4) + ', "spineRz" : ' + archerStructure["spine"].rotation.z.toFixed(4) + ',\n"spine1Rx" : ' + archerStructure["spine1"].rotation.x.toFixed(4) + ', "spine1Ry" : ' + archerStructure["spine1"].rotation.y.toFixed(4) + ', "spine1Rz" : ' + archerStructure["spine1"].rotation.z.toFixed(4) + ',\n"spine2Rx" : ' + archerStructure["spine2"].rotation.x.toFixed(4) + ', "spine2Ry" : ' + archerStructure["spine2"].rotation.y.toFixed(4) + ', "spine2Rz" : ' + archerStructure["spine2"].rotation.z.toFixed(4) + ',\n"neckRx" : ' + archerStructure["neck"].rotation.x.toFixed(4) + ', "neckRy" : ' + archerStructure["neck"].rotation.y.toFixed(4) + ', "neckRz" : ' + archerStructure["neck"].rotation.z.toFixed(4) + ',\n"headRx" : ' + archerStructure["head"].rotation.x.toFixed(4) + ', "headRy" : ' + archerStructure["head"].rotation.y.toFixed(4) + ', "headRz" : ' + archerStructure["head"].rotation.z.toFixed(4) + ',\n"rightEyeRx" : ' + archerStructure["rightEye"].rotation.x.toFixed(4) + ', "rightEyeRy" : ' + archerStructure["rightEye"].rotation.y.toFixed(4) + ', "rightEyeRz" : ' + archerStructure["rightEye"].rotation.z.toFixed(4) + ',\n"leftEyeRx" : ' + archerStructure["leftEye"].rotation.x.toFixed(4) + ', "leftEyeRy" : ' + archerStructure["leftEye"].rotation.y.toFixed(4) + ', "leftEyeRz" : ' + archerStructure["leftEye"].rotation.z.toFixed(4) + ',\n"headTop_EndRx" : ' + archerStructure["headTop_End"].rotation.x.toFixed(4) + ', "headTop_EndRy" : ' + archerStructure["headTop_End"].rotation.y.toFixed(4) + ', "headTop_EndRz" : ' + archerStructure["headTop_End"].rotation.z.toFixed(4) + ',\n"leftShoulderRx" : ' + archerStructure["leftShoulder"].rotation.x.toFixed(4) + ', "leftShoulderRy" : ' + archerStructure["leftShoulder"].rotation.y.toFixed(4) + ', "leftShoulderRz" : ' + archerStructure["leftShoulder"].rotation.z.toFixed(4) + ',\n"leftArmRx" : ' + archerStructure["leftArm"].rotation.x.toFixed(4) + ', "leftArmRy" : ' + archerStructure["leftArm"].rotation.y.toFixed(4) + ', "leftArmRz" : ' + archerStructure["leftArm"].rotation.z.toFixed(4) + ',\n"leftForeArmRx" : ' + archerStructure["leftForeArm"].rotation.x.toFixed(4) + ', "leftForeArmRy" : ' + archerStructure["leftForeArm"].rotation.y.toFixed(4) + ', "leftForeArmRz" : ' + archerStructure["leftForeArm"].rotation.z.toFixed(4) + ',\n"leftHandRx" : ' + archerStructure["leftHand"].rotation.x.toFixed(4) + ', "leftHandRy" : ' + archerStructure["leftHand"].rotation.y.toFixed(4) + ', "leftHandRz" : ' + archerStructure["leftHand"].rotation.z.toFixed(4) + ',\n"leftHandThumb1Rx" : ' + archerStructure["leftHandThumb1"].rotation.x.toFixed(4) + ', "leftHandThumb1Ry" : ' + archerStructure["leftHandThumb1"].rotation.y.toFixed(4) + ', "leftHandThumb1Rz" : ' + archerStructure["leftHandThumb1"].rotation.z.toFixed(4) + ',\n"leftHandThumb2Rx" : ' + archerStructure["leftHandThumb2"].rotation.x.toFixed(4) + ', "leftHandThumb2Ry" : ' + archerStructure["leftHandThumb2"].rotation.y.toFixed(4) + ', "leftHandThumb2Rz" : ' + archerStructure["leftHandThumb2"].rotation.z.toFixed(4) + ',\n"leftHandThumb3Rx" : ' + archerStructure["leftHandThumb3"].rotation.x.toFixed(4) + ', "leftHandThumb3Ry" : ' + archerStructure["leftHandThumb3"].rotation.y.toFixed(4) + ', "leftHandThumb3Rz" : ' + archerStructure["leftHandThumb3"].rotation.z.toFixed(4) + ',\n"leftHandThumb4Rx" : ' + archerStructure["leftHandThumb4"].rotation.x.toFixed(4) + ', "leftHandThumb4Ry" : ' + archerStructure["leftHandThumb4"].rotation.y.toFixed(4) + ', "leftHandThumb4Rz" : ' + archerStructure["leftHandThumb4"].rotation.z.toFixed(4) + ',\n"leftHandIndex1Rx" : ' + archerStructure["leftHandIndex1"].rotation.x.toFixed(4) + ', "leftHandIndex1Ry" : ' + archerStructure["leftHandIndex1"].rotation.y.toFixed(4) + ', "leftHandIndex1Rz" : ' + archerStructure["leftHandIndex1"].rotation.z.toFixed(4) + ',\n"leftHandIndex2Rx" : ' + archerStructure["leftHandIndex2"].rotation.x.toFixed(4) + ', "leftHandIndex2Ry" : ' + archerStructure["leftHandIndex2"].rotation.y.toFixed(4) + ', "leftHandIndex2Rz" : ' + archerStructure["leftHandIndex2"].rotation.z.toFixed(4) + ',\n"leftHandIndex3Rx" : ' + archerStructure["leftHandIndex3"].rotation.x.toFixed(4) + ', "leftHandIndex3Ry" : ' + archerStructure["leftHandIndex3"].rotation.y.toFixed(4) + ', "leftHandIndex3Rz" : ' + archerStructure["leftHandIndex3"].rotation.z.toFixed(4) + ',\n"leftHandIndex4Rx" : ' + archerStructure["leftHandIndex4"].rotation.x.toFixed(4) + ', "leftHandIndex4Ry" : ' + archerStructure["leftHandIndex4"].rotation.y.toFixed(4) + ', "leftHandIndex4Rz" : ' + archerStructure["leftHandIndex4"].rotation.z.toFixed(4) + ',\n"leftHandMiddle1Rx" : ' + archerStructure["leftHandMiddle1"].rotation.x.toFixed(4) + ', "leftHandMiddle1Ry" : ' + archerStructure["leftHandMiddle1"].rotation.y.toFixed(4) + ', "leftHandMiddle1Rz" : ' + archerStructure["leftHandMiddle1"].rotation.z.toFixed(4) + ',\n"leftHandMiddle2Rx" : ' + archerStructure["leftHandMiddle2"].rotation.x.toFixed(4) + ', "leftHandMiddle2Ry" : ' + archerStructure["leftHandMiddle2"].rotation.y.toFixed(4) + ', "leftHandMiddle2Rz" : ' + archerStructure["leftHandMiddle2"].rotation.z.toFixed(4) + ',\n"leftHandMiddle3Rx" : ' + archerStructure["leftHandMiddle3"].rotation.x.toFixed(4) + ', "leftHandMiddle3Ry" : ' + archerStructure["leftHandMiddle3"].rotation.y.toFixed(4) + ', "leftHandMiddle3Rz" : ' + archerStructure["leftHandMiddle3"].rotation.z.toFixed(4) + ',\n"leftHandMiddle4Rx" : ' + archerStructure["leftHandMiddle4"].rotation.x.toFixed(4) + ', "leftHandMiddle4Ry" : ' + archerStructure["leftHandMiddle4"].rotation.y.toFixed(4) + ', "leftHandMiddle4Rz" : ' + archerStructure["leftHandMiddle4"].rotation.z.toFixed(4) + ',\n"leftHandRing1Rx" : ' + archerStructure["leftHandRing1"].rotation.x.toFixed(4) + ', "leftHandRing1Ry" : ' + archerStructure["leftHandRing1"].rotation.y.toFixed(4) + ', "leftHandRing1Rz" : ' + archerStructure["leftHandRing1"].rotation.z.toFixed(4) + ',\n"leftHandRing2Rx" : ' + archerStructure["leftHandRing2"].rotation.x.toFixed(4) + ', "leftHandRing2Ry" : ' + archerStructure["leftHandRing2"].rotation.y.toFixed(4) + ', "leftHandRing2Rz" : ' + archerStructure["leftHandRing2"].rotation.z.toFixed(4) + ',\n"leftHandRing3Rx" : ' + archerStructure["leftHandRing3"].rotation.x.toFixed(4) + ', "leftHandRing3Ry" : ' + archerStructure["leftHandRing3"].rotation.y.toFixed(4) + ', "leftHandRing3Rz" : ' + archerStructure["leftHandRing3"].rotation.z.toFixed(4) + ',\n"leftHandRing4Rx" : ' + archerStructure["leftHandRing4"].rotation.x.toFixed(4) + ', "leftHandRing4Ry" : ' + archerStructure["leftHandRing4"].rotation.y.toFixed(4) + ', "leftHandRing4Rz" : ' + archerStructure["leftHandRing4"].rotation.z.toFixed(4) + ',\n"leftHandPinky1Rx" : ' + archerStructure["leftHandPinky1"].rotation.x.toFixed(4) + ', "leftHandPinky1Ry" : ' + archerStructure["leftHandPinky1"].rotation.y.toFixed(4) + ', "leftHandPinky1Rz" : ' + archerStructure["leftHandPinky1"].rotation.z.toFixed(4) + ',\n"leftHandPinky2Rx" : ' + archerStructure["leftHandPinky2"].rotation.x.toFixed(4) + ', "leftHandPinky2Ry" : ' + archerStructure["leftHandPinky2"].rotation.y.toFixed(4) + ', "leftHandPinky2Rz" : ' + archerStructure["leftHandPinky2"].rotation.z.toFixed(4) + ',\n"leftHandPinky3Rx" : ' + archerStructure["leftHandPinky3"].rotation.x.toFixed(4) + ', "leftHandPinky3Ry" : ' + archerStructure["leftHandPinky3"].rotation.y.toFixed(4) + ', "leftHandPinky3Rz" : ' + archerStructure["leftHandPinky3"].rotation.z.toFixed(4) + ',\n"leftHandPinky4Rx" : ' + archerStructure["leftHandPinky4"].rotation.x.toFixed(4) + ', "leftHandPinky4Ry" : ' + archerStructure["leftHandPinky4"].rotation.y.toFixed(4) + ', "leftHandPinky4Rz" : ' + archerStructure["leftHandPinky4"].rotation.z.toFixed(4) + ',\n"rightShoulderRx" : ' + archerStructure["rightShoulder"].rotation.x.toFixed(4) + ', "rightShoulderRy" : ' + archerStructure["rightShoulder"].rotation.y.toFixed(4) + ', "rightShoulderRz" : ' + archerStructure["rightShoulder"].rotation.z.toFixed(4) + ',\n"rightArmRx" : ' + archerStructure["rightArm"].rotation.x.toFixed(4) + ', "rightArmRy" : ' + archerStructure["rightArm"].rotation.y.toFixed(4) + ', "rightArmRz" : ' + archerStructure["rightArm"].rotation.z.toFixed(4) + ',\n"rightForeArmRx" : ' + archerStructure["rightForeArm"].rotation.x.toFixed(4) + ', "rightForeArmRy" : ' + archerStructure["rightForeArm"].rotation.y.toFixed(4) + ', "rightForeArmRz" : ' + archerStructure["rightForeArm"].rotation.z.toFixed(4) + ',\n"rightHandRx" : ' + archerStructure["rightHand"].rotation.x.toFixed(4) + ', "rightHandRy" : ' + archerStructure["rightHand"].rotation.y.toFixed(4) + ', "rightHandRz" : ' + archerStructure["rightHand"].rotation.z.toFixed(4) + ',\n"rightHandPinky1Rx" : ' + archerStructure["rightHandPinky1"].rotation.x.toFixed(4) + ', "rightHandPinky1Ry" : ' + archerStructure["rightHandPinky1"].rotation.y.toFixed(4) + ', "rightHandPinky1Rz" : ' + archerStructure["rightHandPinky1"].rotation.z.toFixed(4) + ',\n"rightHandPinky2Rx" : ' + archerStructure["rightHandPinky2"].rotation.x.toFixed(4) + ', "rightHandPinky2Ry" : ' + archerStructure["rightHandPinky2"].rotation.y.toFixed(4) + ', "rightHandPinky2Rz" : ' + archerStructure["rightHandPinky2"].rotation.z.toFixed(4) + ',\n"rightHandPinky3Rx" : ' + archerStructure["rightHandPinky3"].rotation.x.toFixed(4) + ', "rightHandPinky3Ry" : ' + archerStructure["rightHandPinky3"].rotation.y.toFixed(4) + ', "rightHandPinky3Rz" : ' + archerStructure["rightHandPinky3"].rotation.z.toFixed(4) + ',\n"rightHandPinky4Rx" : ' + archerStructure["rightHandPinky4"].rotation.x.toFixed(4) + ', "rightHandPinky4Ry" : ' + archerStructure["rightHandPinky4"].rotation.y.toFixed(4) + ', "rightHandPinky4Rz" : ' + archerStructure["rightHandPinky4"].rotation.z.toFixed(4) + ',\n"rightHandRing1Rx" : ' + archerStructure["rightHandRing1"].rotation.x.toFixed(4) + ', "rightHandRing1Ry" : ' + archerStructure["rightHandRing1"].rotation.y.toFixed(4) + ', "rightHandRing1Rz" : ' + archerStructure["rightHandRing1"].rotation.z.toFixed(4) + ',\n"rightHandRing2Rx" : ' + archerStructure["rightHandRing2"].rotation.x.toFixed(4) + ', "rightHandRing2Ry" : ' + archerStructure["rightHandRing2"].rotation.y.toFixed(4) + ', "rightHandRing2Rz" : ' + archerStructure["rightHandRing2"].rotation.z.toFixed(4) + ',\n"rightHandRing3Rx" : ' + archerStructure["rightHandRing3"].rotation.x.toFixed(4) + ', "rightHandRing3Ry" : ' + archerStructure["rightHandRing3"].rotation.y.toFixed(4) + ', "rightHandRing3Rz" : ' + archerStructure["rightHandRing3"].rotation.z.toFixed(4) + ',\n"rightHandRing4Rx" : ' + archerStructure["rightHandRing4"].rotation.x.toFixed(4) + ', "rightHandRing4Ry" : ' + archerStructure["rightHandRing4"].rotation.y.toFixed(4) + ', "rightHandRing4Rz" : ' + archerStructure["rightHandRing4"].rotation.z.toFixed(4) + ',\n"rightHandMiddle1Rx" : ' + archerStructure["rightHandMiddle1"].rotation.x.toFixed(4) + ', "rightHandMiddle1Ry" : ' + archerStructure["rightHandMiddle1"].rotation.y.toFixed(4) + ', "rightHandMiddle1Rz" : ' + archerStructure["rightHandMiddle1"].rotation.z.toFixed(4) + ',\n"rightHandMiddle2Rx" : ' + archerStructure["rightHandMiddle2"].rotation.x.toFixed(4) + ', "rightHandMiddle2Ry" : ' + archerStructure["rightHandMiddle2"].rotation.y.toFixed(4) + ', "rightHandMiddle2Rz" : ' + archerStructure["rightHandMiddle2"].rotation.z.toFixed(4) + ',\n"rightHandMiddle3Rx" : ' + archerStructure["rightHandMiddle3"].rotation.x.toFixed(4) + ', "rightHandMiddle3Ry" : ' + archerStructure["rightHandMiddle3"].rotation.y.toFixed(4) + ', "rightHandMiddle3Rz" : ' + archerStructure["rightHandMiddle3"].rotation.z.toFixed(4) + ',\n"rightHandMiddle4Rx" : ' + archerStructure["rightHandMiddle4"].rotation.x.toFixed(4) + ', "rightHandMiddle4Ry" : ' + archerStructure["rightHandMiddle4"].rotation.y.toFixed(4) + ', "rightHandMiddle4Rz" : ' + archerStructure["rightHandMiddle4"].rotation.z.toFixed(4) + ',\n"rightHandIndex1Rx" : ' + archerStructure["rightHandIndex1"].rotation.x.toFixed(4) + ', "rightHandIndex1Ry" : ' + archerStructure["rightHandIndex1"].rotation.y.toFixed(4) + ', "rightHandIndex1Rz" : ' + archerStructure["rightHandIndex1"].rotation.z.toFixed(4) + ',\n"rightHandIndex2Rx" : ' + archerStructure["rightHandIndex2"].rotation.x.toFixed(4) + ', "rightHandIndex2Ry" : ' + archerStructure["rightHandIndex2"].rotation.y.toFixed(4) + ', "rightHandIndex2Rz" : ' + archerStructure["rightHandIndex2"].rotation.z.toFixed(4) + ',\n"rightHandIndex3Rx" : ' + archerStructure["rightHandIndex3"].rotation.x.toFixed(4) + ', "rightHandIndex3Ry" : ' + archerStructure["rightHandIndex3"].rotation.y.toFixed(4) + ', "rightHandIndex3Rz" : ' + archerStructure["rightHandIndex3"].rotation.z.toFixed(4) + ',\n"rightHandIndex4Rx" : ' + archerStructure["rightHandIndex4"].rotation.x.toFixed(4) + ', "rightHandIndex4Ry" : ' + archerStructure["rightHandIndex4"].rotation.y.toFixed(4) + ', "rightHandIndex4Rz" : ' + archerStructure["rightHandIndex4"].rotation.z.toFixed(4) + ',\n"rightHandThumb1Rx" : ' + archerStructure["rightHandThumb1"].rotation.x.toFixed(4) + ', "rightHandThumb1Ry" : ' + archerStructure["rightHandThumb1"].rotation.y.toFixed(4) + ', "rightHandThumb1Rz" : ' + archerStructure["rightHandThumb1"].rotation.z.toFixed(4) + ',\n"rightHandThumb2Rx" : ' + archerStructure["rightHandThumb2"].rotation.x.toFixed(4) + ', "rightHandThumb2Ry" : ' + archerStructure["rightHandThumb2"].rotation.y.toFixed(4) + ', "rightHandThumb2Rz" : ' + archerStructure["rightHandThumb2"].rotation.z.toFixed(4) + ',\n"rightHandThumb3Rx" : ' + archerStructure["rightHandThumb3"].rotation.x.toFixed(4) + ', "rightHandThumb3Ry" : ' + archerStructure["rightHandThumb3"].rotation.y.toFixed(4) + ', "rightHandThumb3Rz" : ' + archerStructure["rightHandThumb3"].rotation.z.toFixed(4) + ',\n"rightHandThumb4Rx" : ' + archerStructure["rightHandThumb4"].rotation.x.toFixed(4) + ', "rightHandThumb4Ry" : ' + archerStructure["rightHandThumb4"].rotation.y.toFixed(4) + ', "rightHandThumb4Rz" : ' + archerStructure["rightHandThumb4"].rotation.z.toFixed(4) + ',\n"leftUpLegRx" : ' + archerStructure["leftUpLeg"].rotation.x.toFixed(4) + ', "leftUpLegRy" : ' + archerStructure["leftUpLeg"].rotation.y.toFixed(4) + ', "leftUpLegRz" : ' + archerStructure["leftUpLeg"].rotation.z.toFixed(4) + ',\n"leftLegRx" : ' + archerStructure["leftLeg"].rotation.x.toFixed(4) + ', "leftLegRy" : ' + archerStructure["leftLeg"].rotation.y.toFixed(4) + ', "leftLegRz" : ' + archerStructure["leftLeg"].rotation.z.toFixed(4) + ',\n"leftFootRx" : ' + archerStructure["leftFoot"].rotation.x.toFixed(4) + ', "leftFootRy" : ' + archerStructure["leftFoot"].rotation.y.toFixed(4) + ', "leftFootRz" : ' + archerStructure["leftFoot"].rotation.z.toFixed(4) + ',\n"leftToeBaseRx" : ' + archerStructure["leftToeBase"].rotation.x.toFixed(4) + ', "leftToeBaseRy" : ' + archerStructure["leftToeBase"].rotation.y.toFixed(4) + ', "leftToeBaseRz" : ' + archerStructure["leftToeBase"].rotation.z.toFixed(4) + ',\n"leftToe_EndRx" : ' + archerStructure["leftToe_End"].rotation.x.toFixed(4) + ', "leftToe_EndRy" : ' + archerStructure["leftToe_End"].rotation.y.toFixed(4) + ', "leftToe_EndRz" : ' + archerStructure["leftToe_End"].rotation.z.toFixed(4) + ',\n"rightUpLegRx" : ' + archerStructure["rightUpLeg"].rotation.x.toFixed(4) + ', "rightUpLegRy" : ' + archerStructure["rightUpLeg"].rotation.y.toFixed(4) + ', "rightUpLegRz" : ' + archerStructure["rightUpLeg"].rotation.z.toFixed(4) + ',\n"rightLegRx" : ' + archerStructure["rightLeg"].rotation.x.toFixed(4) + ', "rightLegRy" : ' + archerStructure["rightLeg"].rotation.y.toFixed(4) + ', "rightLegRz" : ' + archerStructure["rightLeg"].rotation.z.toFixed(4) + ',\n"rightFootRx" : ' + archerStructure["rightFoot"].rotation.x.toFixed(4) + ', "rightFootRy" : ' + archerStructure["rightFoot"].rotation.y.toFixed(4) + ', "rightFootRz" : ' + archerStructure["rightFoot"].rotation.z.toFixed(4) + ',\n"rightToeBaseRx" : ' + archerStructure["rightToeBase"].rotation.x.toFixed(4) + ', "rightToeBaseRy" : ' + archerStructure["rightToeBase"].rotation.y.toFixed(4) + ', "rightToeBaseRz" : ' + archerStructure["rightToeBase"].rotation.z.toFixed(4) + ',\n"rightToe_EndRx" : ' + archerStructure["rightToe_End"].rotation.x.toFixed(4) + ', "rightToe_EndRy" : ' + archerStructure["rightToe_End"].rotation.y.toFixed(4) + ', "rightToe_EndRz" : ' + archerStructure["rightToe_End"].rotation.z.toFixed(4) + ',\n')
		});

		const time = new THREE.Clock();
		var deltaTime = 0;
		var elapsedTime = 0;
		function animate() {
			deltaTime = time.getDelta();
			if(animateScene == false){
				elapsedTime = time.getElapsedTime() * 1000;
				TWEEN.update();
				world.step(1/60,deltaTime,10);
				orbit.update(deltaTime);


				playerAnimate(deltaTime);
				enemiesAnimate(deltaTime);

				if(groundMesh && groundPlatModelParent){
					groundMesh.position.copy(groundBody.position);
					groundMesh.quaternion.copy(groundBody.quaternion);
					groundPlatModelParent.position.copy(groundBody.position);
					groundPlatModelParent.quaternion.copy(groundBody.quaternion);
					groundPlatModelParent.rotation.y-=Math.PI/6;
				}

				if(cubeMesh){
					cubeMesh.position.copy(cubeBody.position);
					//CubeMesh copies the cubeBody rotation because threejs offers the rotateTowards function to rotate gradually during movement
					cubeBody.quaternion.copy(cubeMesh.quaternion);
				}

				if(cubeBody && archerModelParent){
					archerModelParent.position.copy(cubeBody.position);
					archerModelParent.quaternion.copy(cubeBody.quaternion);
				}

				if(targetBody1 && targetModelParent1 && targetMesh1){
					targetModelParent1.position.copy(targetBody1.position);
					targetModelParent1.quaternion.copy(targetBody1.quaternion);
					targetMesh1.quaternion.copy(targetBody1.quaternion);
					targetMesh1.position.copy(targetBody1.position);
				}
				if(targetBody2 && targetModelParent2 && targetMesh2){
					targetModelParent2.position.copy(targetBody2.position);
					targetModelParent2.quaternion.copy(targetBody2.quaternion);
					targetMesh2.quaternion.copy(targetBody2.quaternion);
					targetMesh2.position.copy(targetBody2.position);
				}
				if(targetBody3 && targetModelParent3 && targetMesh3){
					targetModelParent3.position.copy(targetBody3.position);
					targetModelParent3.quaternion.copy(targetBody3.quaternion);
					targetMesh3.quaternion.copy(targetBody3.quaternion);
					targetMesh3.position.copy(targetBody3.position);
				}		
				if(targetBody4 && targetModelParent4 && targetMesh4){
					targetModelParent4.position.copy(targetBody4.position);
					targetModelParent4.quaternion.copy(targetBody4.quaternion);
					targetMesh4.quaternion.copy(targetBody4.quaternion);
					targetMesh4.position.copy(targetBody4.position);
				}

				if(level2PlatformBody && level2PlatformMesh && level2PlatformModelParent){
					level2PlatformMesh.position.copy(level2PlatformBody.position);
					level2PlatformMesh.quaternion.copy(level2PlatformBody.quaternion);
					level2PlatformModelParent.position.copy(level2PlatformBody.position);
					level2PlatformModelParent.quaternion.copy(level2PlatformBody.quaternion);
					level2PlatformModelParent.rotation.y-=Math.PI/6;
				}

				if(level3PlatformBody && level3PlatformMesh && level3PlatformModelParent){
					level3PlatformMesh.position.copy(level3PlatformBody.position);
					level3PlatformMesh.quaternion.copy(level3PlatformBody.quaternion);
					level3PlatformModelParent.position.copy(level3PlatformBody.position);
					level3PlatformModelParent.quaternion.copy(level3PlatformBody.quaternion);
					level3PlatformModelParent.rotation.y-=Math.PI/6;
				}

				//if (mixer) mixer.update(time.getDelta());
				arrows.forEach(element => {
					element["mesh"].position.copy(element["can"].position);
					element["model"].position.copy(element["can"].position);
					element["can"].quaternion.copy(element["model"].quaternion);
					element["mesh"].quaternion.copy(element["model"].quaternion);

					//Check if the arrow is falling down
					if(element["can"].position.y < -5){
							scene.remove(element["model"]);
							setTimeout(function() {
								world.removeBody(element["can"]);
							},0);
							scene.remove(element["mesh"]);
							arrows = arrows.filter(function(ele){ 
								return ele != element; 
							});
						}
				});

				obsPlat.forEach(element => {
					element["mesh"].position.copy(element["body"].position);
					element["mesh"].quaternion.copy(element["body"].quaternion);
					element["model"].position.copy(element["body"].position);
					element["model"].quaternion.copy(element["body"].quaternion);
				});

				robots.forEach(element => {
					element["mesh"].position.copy(element["body"].position);
					element["body"].quaternion.copy(element["mesh"].quaternion);
					element["model"].position.copy(element["body"].position);
					element["model"].quaternion.copy(element["body"].quaternion);
				});


				// console.log(camera.position)


			}

			renderer.render( scene, camera );

			requestAnimationFrame(animate);
		};



		//Set elements of archer useful for animations
		function populateArcherStructure(){
			archerStructure["hips"] = archerModel.getObjectByName("Hips_66")
			archerStructure["spine"] = archerModel.getObjectByName("Spine_55")
			archerStructure["spine1"] = archerModel.getObjectByName("Spine1_54")
			archerStructure["spine2"] = archerModel.getObjectByName("Spine2_53")
			archerStructure["neck"] = archerModel.getObjectByName("Neck_4")
			archerStructure["head"] = archerModel.getObjectByName("Head_3")
			archerStructure["rightEye"] = archerModel.getObjectByName("RightEye_0")
			archerStructure["leftEye"] = archerModel.getObjectByName("LeftEye_1")
			archerStructure["headTop_End"] = archerModel.getObjectByName("HeadTop_End_2")
			archerStructure["leftShoulder"] = archerModel.getObjectByName("LeftShoulder_28")
			archerStructure["leftArm"] = archerModel.getObjectByName("LeftArm_27")
			archerStructure["leftForeArm"] = archerModel.getObjectByName("LeftForeArm_26")
			archerStructure["leftHand"] = archerModel.getObjectByName("LeftHand_25")
			archerStructure["leftHandThumb1"] = archerModel.getObjectByName("LeftHandThumb1_8")
			archerStructure["leftHandThumb2"] = archerModel.getObjectByName("LeftHandThumb2_7")
			archerStructure["leftHandThumb3"] = archerModel.getObjectByName("LeftHandThumb3_6")
			archerStructure["leftHandThumb4"] = archerModel.getObjectByName("LeftHandThumb4_5")
			archerStructure["leftHandIndex1"] = archerModel.getObjectByName("LeftHandIndex1_12")
			archerStructure["leftHandIndex2"] = archerModel.getObjectByName("LeftHandIndex2_11")
			archerStructure["leftHandIndex3"] = archerModel.getObjectByName("LeftHandIndex3_10")
			archerStructure["leftHandIndex4"] = archerModel.getObjectByName("LeftHandIndex4_9")
			archerStructure["leftHandMiddle1"] = archerModel.getObjectByName("LeftHandMiddle1_16")
			archerStructure["leftHandMiddle2"] = archerModel.getObjectByName("LeftHandMiddle2_15")
			archerStructure["leftHandMiddle3"] = archerModel.getObjectByName("LeftHandMiddle3_14")
			archerStructure["leftHandMiddle4"] = archerModel.getObjectByName("LeftHandMiddle4_13")
			archerStructure["leftHandRing1"] = archerModel.getObjectByName("LeftHandRing1_20")
			archerStructure["leftHandRing2"] = archerModel.getObjectByName("LeftHandRing2_19")
			archerStructure["leftHandRing3"] = archerModel.getObjectByName("LeftHandRing3_18")
			archerStructure["leftHandRing4"] = archerModel.getObjectByName("LeftHandRing4_17")
			archerStructure["leftHandPinky1"] = archerModel.getObjectByName("LeftHandPinky1_24")
			archerStructure["leftHandPinky2"] = archerModel.getObjectByName("LeftHandPinky2_23")
			archerStructure["leftHandPinky3"] = archerModel.getObjectByName("LeftHandPinky3_22")
			archerStructure["leftHandPinky4"] = archerModel.getObjectByName("LeftHandPinky4_21")
			archerStructure["rightShoulder"] = archerModel.getObjectByName("RightShoulder_52")
			archerStructure["rightArm"] = archerModel.getObjectByName("RightArm_51")
			archerStructure["rightForeArm"] = archerModel.getObjectByName("RightForeArm_50")
			archerStructure["rightHand"] = archerModel.getObjectByName("RightHand_49")
			archerStructure["rightHandPinky1"] = archerModel.getObjectByName("RightHandPinky1_32")
			archerStructure["rightHandPinky2"] = archerModel.getObjectByName("RightHandPinky2_31")
			archerStructure["rightHandPinky3"] = archerModel.getObjectByName("RightHandPinky3_30")
			archerStructure["rightHandPinky4"] = archerModel.getObjectByName("RightHandPinky4_29")
			archerStructure["rightHandRing1"] = archerModel.getObjectByName("RightHandRing1_36")
			archerStructure["rightHandRing2"] = archerModel.getObjectByName("RightHandRing2_35")
			archerStructure["rightHandRing3"] = archerModel.getObjectByName("RightHandRing3_34")
			archerStructure["rightHandRing4"] = archerModel.getObjectByName("RightHandRing4_33")
			archerStructure["rightHandMiddle1"] = archerModel.getObjectByName("RightHandMiddle1_40")
			archerStructure["rightHandMiddle2"] = archerModel.getObjectByName("RightHandMiddle2_39")
			archerStructure["rightHandMiddle3"] = archerModel.getObjectByName("RightHandMiddle3_38")
			archerStructure["rightHandMiddle4"] = archerModel.getObjectByName("RightHandMiddle4_37")
			archerStructure["rightHandIndex1"] = archerModel.getObjectByName("RightHandIndex1_44")
			archerStructure["rightHandIndex2"] = archerModel.getObjectByName("RightHandIndex2_43")
			archerStructure["rightHandIndex3"] = archerModel.getObjectByName("RightHandIndex3_42")
			archerStructure["rightHandIndex4"] = archerModel.getObjectByName("RightHandIndex4_41")
			archerStructure["rightHandThumb1"] = archerModel.getObjectByName("RightHandThumb1_48")
			archerStructure["rightHandThumb2"] = archerModel.getObjectByName("RightHandThumb2_47")
			archerStructure["rightHandThumb3"] = archerModel.getObjectByName("RightHandThumb3_46")
			archerStructure["rightHandThumb4"] = archerModel.getObjectByName("RightHandThumb4_45")
			archerStructure["leftUpLeg"] = archerModel.getObjectByName("LeftUpLeg_60")
			archerStructure["leftLeg"] = archerModel.getObjectByName("LeftLeg_59")
			archerStructure["leftFoot"] = archerModel.getObjectByName("LeftFoot_58")
			archerStructure["leftToeBase"] = archerModel.getObjectByName("LeftToeBase_57")
			archerStructure["leftToe_End"] = archerModel.getObjectByName("LeftToe_End_56")
			archerStructure["rightUpLeg"] = archerModel.getObjectByName("RightUpLeg_65")
			archerStructure["rightLeg"] = archerModel.getObjectByName("RightLeg_64")
			archerStructure["rightFoot"] = archerModel.getObjectByName("RightFoot_63")
			archerStructure["rightToeBase"] = archerModel.getObjectByName("RightToeBase_62")
			archerStructure["rightToe_End"] = archerModel.getObjectByName("RightToe_End_61")
		};

		function populateRobotStructure(genRobotModel){
			var struct = {};
			struct["rootJoint"] = genRobotModel.getObjectByName("GLTF_created_0_rootJoint")
			struct["bone"] = genRobotModel.getObjectByName("Bone_74")
			struct["footL"] = genRobotModel.getObjectByName("FootL_2")
			struct["body"] = genRobotModel.getObjectByName("Body_66")
			struct["upperLegL"] = genRobotModel.getObjectByName("UpperLegL_7")
			struct["lowerLegL"] = genRobotModel.getObjectByName("LowerLegL_5")
			struct["upperLegR"] = genRobotModel.getObjectByName("UpperLegR_12")
			struct["lowerLegR"] = genRobotModel.getObjectByName("LowerLegR_10")
			struct["hips"] = genRobotModel.getObjectByName("Hips_62")
			struct["abdomen"] = genRobotModel.getObjectByName("Abdomen_61")
			struct["torso"] = genRobotModel.getObjectByName("Torso_1_60")
			struct["neck"] = genRobotModel.getObjectByName("Neck_19")
			struct["head"] = genRobotModel.getObjectByName("Head_1_18")
			struct["shoulderR"] = genRobotModel.getObjectByName("ShoulderR_59")
			struct["upperArmR"] = genRobotModel.getObjectByName("UpperArmR_57")
			struct["lowerArmR"] = genRobotModel.getObjectByName("LowerArmR_55")
			struct["thumbR"] = genRobotModel.getObjectByName("ThumbR_46")
			struct["thumb2R"] = genRobotModel.getObjectByName("Thumb2R_45")
			struct["palm2R"] = genRobotModel.getObjectByName("Palm2R_43")
			struct["middle1R"] = genRobotModel.getObjectByName("Middle1R_42")
			struct["middle2R"] = genRobotModel.getObjectByName("Middle2R_41")
			struct["palm1R"] = genRobotModel.getObjectByName("Palm1R_50")
			struct["indexR"] = genRobotModel.getObjectByName("IndexR_49")
			struct["index2R"] = genRobotModel.getObjectByName("Index2R_48")
			struct["palm3R"] = genRobotModel.getObjectByName("Palm3R_54")
			struct["ring1R"] = genRobotModel.getObjectByName("Ring1R_53")
			struct["ring2R"] = genRobotModel.getObjectByName("Ring2R_52")
			struct["shoulderL"] = genRobotModel.getObjectByName("ShoulderL_39")
			struct["upperArmL"] = genRobotModel.getObjectByName("UpperArmL_37")
			struct["lowerArmL"] = genRobotModel.getObjectByName("LowerArmL_35")
			struct["palm2L"] = genRobotModel.getObjectByName("Palm2L_23")
			struct["middle1L"] = genRobotModel.getObjectByName("Middle1L_22")
			struct["middle2L"] = genRobotModel.getObjectByName("Middle2L_21")
			struct["thumbL"] = genRobotModel.getObjectByName("ThumbL_26")
			struct["thumb2L"] = genRobotModel.getObjectByName("Thumb2L_25")
			struct["palm1L"] = genRobotModel.getObjectByName("Palm1L_30")
			struct["indexL"] = genRobotModel.getObjectByName("IndexL_29")
			struct["index2L"] = genRobotModel.getObjectByName("Index2L_28")
			struct["palm3L"] = genRobotModel.getObjectByName("Palm3L_34")
			struct["ring1L"] = genRobotModel.getObjectByName("Ring1L_33")
			struct["ring2L"] = genRobotModel.getObjectByName("Ring2L_32")
			struct["poleTargetL"] = genRobotModel.getObjectByName("PoleTargetL_68")
			struct["footR"] = genRobotModel.getObjectByName("FootR_71")
			struct["poleTargetR"] = genRobotModel.getObjectByName("PoleTargetR_73")
			return struct;
		}		
		//Set the correct player animation
		function changePlayerState(){
			if(lastExecutedAnimation == playerState) return;
			lastExecutedAnimation = playerState;
			idle.stop();
			idleB.stop();
			walkA.stop();
			walkB.stop();
			runA.stop();
			runB.stop();
			jumpA.stop();
			jumpB.stop();
			switch(playerState){
				case "Idle":
					idle.start();
					break;
				case "Walk":
					walkA.start();
					break;
				case "Run":
					runA.start();
					break;
				case "Jump":
					jumpA.start();
					break;
				default:
					idle.start();
					break;
			}
		}

		//Functions that applies the updates to the player through each frame (animation, movement, etc.)
		function playerAnimate(delta){
			console.log(playerState)

			//Degree of desired direction
			
			if(pressed["SPACE"] && playerState!="Jump"){
				playerState = "Jump";
				cubeBody.velocity.y = 15;
			}
			else if(pressed["SHIFT"] && playerState!="Jump")
				playerState = "Run";
			else if(playerState!="Jump")
				playerState = "Walk";
			
			if(pressed["F"] && canShoot){
				canShoot=false;
				shoot();
			}

			var moving = false;

			if(pressed["W"] && pressed["A"]){
				relDir = Math.PI/4;
				moving=true;
			}
			else if(pressed["W"] && pressed["D"]){
				relDir = -Math.PI/4;
				moving=true;
			}
			else if(pressed["S"] && pressed["A"]){
				relDir = 3*Math.PI/4;
				moving=true;
			}
			else if(pressed["S"] && pressed["D"]){
				relDir = -3*Math.PI/4;
				moving=true;
			}
			else if(pressed["W"]){
				relDir = 0;
				moving=true;
			}
			else if(pressed["A"]){
				relDir = Math.PI/2;
				moving=true;
			}
			else if(pressed["S"]){
				relDir = Math.PI;
				moving=true;
			}
			else if(pressed["D"]){
				relDir = -Math.PI/2;
				moving=true;
			}
			else  if(playerState!="Jump") {
				playerState = "Idle";
			}

			//Camera angle with respect to player (obtained through x and z displacements)
			cameraAngle = Math.atan2(
				(camera.position.x - cubeBody.position.x),
				(camera.position.z - cubeBody.position.z));

			//Desired final direction, that has to be reached slowly (using rotateTowards)
			desQuat = (new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(0,1,0), cameraAngle + relDir);
			cubeMesh.quaternion.rotateTowards(desQuat, 0.2);

			if(moving == true){

				//Obtain the world direction of the camera
				var cameraDirection= new THREE.Vector3();
				camera.getWorldDirection(cameraDirection);

				//Vertical direction not useful for movement, player can't fly
				cameraDirection.y = 0;
				cameraDirection.normalize();
				cameraDirection.applyAxisAngle(new THREE.Vector3(0,1,0), relDir);
				var moveX = cameraDirection.x * (playerState == 'Run' ? 15 : 8) * delta;
				var moveZ = cameraDirection.z * (playerState == 'Run' ? 15 : 8) * delta;

				cubeBody.position.x += moveX;
				cubeBody.position.z += moveZ;



				
				
				
			}
			//To make the camera move effectively only if the player moves (not if he encounters obstacles)
			camera.position.x += cubeBody.position.x - oldx;
			camera.position.z += cubeBody.position.z - oldz;

			// update camera target
			cameraTarget.x += cubeBody.position.x -oldx;
			//Update y easing only if "standing on a platform at different height"
			if(playerState!="Jump" && oldy<cubeBody.position.y-0.1 || oldy>cubeBody.position.y+0.1){
				oldy = cubeBody.position.y;
				cameraMoveY();
			}
			cameraTarget.z += cubeBody.position.z - oldz;
			orbit.target = cameraTarget;


			oldx =cubeBody.position.x;
			oldz =cubeBody.position.z;

		if(cubeBody.position.y < -5){
				gameOver();
			}

		changePlayerState();
		};

		function enemiesAnimate(deltaTime){
			var i = 0;
			var str ="";
			robots.forEach(enemy => {
				//Camera angle with respect to player (obtained through x and z displacements)
				
				var enemyPosition = enemy.body.position;
				var archerPos = cubeBody.position;
				var distance = new THREE.Vector3();
				
				distance.subVectors( archerPos, enemyPosition );

				if(distance.dot(distance) <  100){
					
					if(enemy.state != "RUNNING"){
						enemy.tweens.idleA.stop();
						enemy.tweens.idleB.stop();
						enemy.tweens.runA.start();
						enemy.state = "RUNNING";
					}

					var enemyDir = distance.normalize();
					var desAngle = Math.atan2(
						(enemyPosition.x - archerPos.x),
						(enemyPosition.z - archerPos.z));
		
					//Desired final direction, that has to be reached slowly (using rotateTowards)
					enemy.mesh.quaternion.rotateTowards((new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(0,1,0), desAngle), 0.2);
					var enemyVelocity = 4;
					enemy.body.velocity.x = enemyVelocity * enemyDir.x * deltaTime*100;
					enemy.body.velocity.z = enemyVelocity * enemyDir.z * deltaTime*100;
				}
				else{
						enemy.tweens.runA.stop();
						enemy.tweens.runB.stop();
						enemy.tweens.idleA.start();
						enemy.state = "IDLE";
					}
				// str += "Player "+(i++)+ "State: "+ enemy.state+ " | ";

			//Check if the enemy is falling down
			if(enemyPosition.y < -5){
					scene.remove(enemy["model"]);
					setTimeout(function() {
						world.removeBody(enemy["body"]);
					},0);
					scene.remove(enemy["mesh"]);
					robots = robots.filter(function(ele){ 
						return ele != enemy; 
					});
				}
			});
			// console.log(str);
		}
		
		function cameraMoveY(){
			var moveYTween= new TWEEN.Tween({y : cameraTarget.y}).to({y : cubeBody.position.y + 2}, 800).onUpdate((object)=>{cameraTarget.y= object.y;});
			moveYTween.easing(TWEEN.Easing.Quadratic.InOut);
			moveYTween.start();
		}

		//Function to call when the player obtains game over (e.g. he falls down)
		function gameOver(){
			location.reload();
		}

		requestAnimationFrame(animate);

		function dumpObject(obj, lines = [], isLast = true, prefix = '') {
  const localPrefix = isLast ? '└─' : '├─';
  lines.push(`${prefix}${prefix ? localPrefix : ''}${obj.name || '*no-name*'} [${obj.type}]`);
  const newPrefix = prefix + (isLast ? '  ' : '│ ');
  const lastNdx = obj.children.length - 1;
  obj.children.forEach((child, ndx) => {
    const isLast = ndx === lastNdx;
    dumpObject(child, lines, isLast, newPrefix);
  });
  return lines;
}
		</script>
	</body>
</html>